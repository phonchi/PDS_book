<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="phonchi">
<meta name="dcterms.date" content="2023-03-06">

<title>Practical and Innovative Analytics in Data Science - 3&nbsp; Relational Database and data wrangling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_Clean_feature_engineering.html" rel="next">
<link href="./02_Dataset.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_Relational_Database_and_data_wrangling.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Relational Database and data wrangling</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Practical and Innovative Analytics in Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_end_to_end_machine_learning_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">End-to-end Machine Learning project</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Framing the problem and constructing the dataset</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Relational_Database_and_data_wrangling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Relational Database and data wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Clean_feature_engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data cleaning and feature engineering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Feature_selection_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Feature selection and extraction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_XAI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Explainable AI</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Deploy and monitoring</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Numpy - multidimensional data arrays for python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Colab_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kaggle-explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to Kaggle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#queringing-data-with-bigquery" id="toc-queringing-data-with-bigquery" class="nav-link active" data-scroll-target="#queringing-data-with-bigquery"><span class="header-section-number">3.1</span> Queringing data with BigQuery</a>
  <ul class="collapse">
  <li><a href="#preliminaries-for-google-colab-optional" id="toc-preliminaries-for-google-colab-optional" class="nav-link" data-scroll-target="#preliminaries-for-google-colab-optional"><span class="header-section-number">3.1.1</span> Preliminaries for google colab (optional)</a></li>
  <li><a href="#create-the-reference" id="toc-create-the-reference" class="nav-link" data-scroll-target="#create-the-reference"><span class="header-section-number">3.1.2</span> Create the reference</a></li>
  <li><a href="#table-schema" id="toc-table-schema" class="nav-link" data-scroll-target="#table-schema"><span class="header-section-number">3.1.3</span> Table schema</a></li>
  <li><a href="#select-from-where" id="toc-select-from-where" class="nav-link" data-scroll-target="#select-from-where"><span class="header-section-number">3.1.4</span> Select, From &amp; Where</a></li>
  <li><a href="#querying-big-dataset" id="toc-querying-big-dataset" class="nav-link" data-scroll-target="#querying-big-dataset"><span class="header-section-number">3.1.5</span> Querying big dataset</a></li>
  <li><a href="#group-by-having-count" id="toc-group-by-having-count" class="nav-link" data-scroll-target="#group-by-having-count"><span class="header-section-number">3.1.6</span> Group By, Having &amp; Count</a></li>
  <li><a href="#order-by" id="toc-order-by" class="nav-link" data-scroll-target="#order-by"><span class="header-section-number">3.1.7</span> Order By</a></li>
  <li><a href="#as-and-with" id="toc-as-and-with" class="nav-link" data-scroll-target="#as-and-with"><span class="header-section-number">3.1.8</span> As and With</a></li>
  <li><a href="#joining-data" id="toc-joining-data" class="nav-link" data-scroll-target="#joining-data"><span class="header-section-number">3.1.9</span> Joining data</a></li>
  <li><a href="#nested-and-repeated-data" id="toc-nested-and-repeated-data" class="nav-link" data-scroll-target="#nested-and-repeated-data"><span class="header-section-number">3.1.10</span> Nested and Repeated data</a></li>
  <li><a href="#analytic-function-optional" id="toc-analytic-function-optional" class="nav-link" data-scroll-target="#analytic-function-optional"><span class="header-section-number">3.1.11</span> Analytic Function (Optional)</a></li>
  </ul></li>
  <li><a href="#data-wrangling-with-pandas" id="toc-data-wrangling-with-pandas" class="nav-link" data-scroll-target="#data-wrangling-with-pandas"><span class="header-section-number">3.2</span> Data Wrangling with Pandas</a>
  <ul class="collapse">
  <li><a href="#series-objects" id="toc-series-objects" class="nav-link" data-scroll-target="#series-objects"><span class="header-section-number">3.2.1</span> <code>Series</code> objects</a></li>
  <li><a href="#handling-time" id="toc-handling-time" class="nav-link" data-scroll-target="#handling-time"><span class="header-section-number">3.2.2</span> Handling time</a></li>
  <li><a href="#periods" id="toc-periods" class="nav-link" data-scroll-target="#periods"><span class="header-section-number">3.2.3</span> Periods</a></li>
  <li><a href="#dataframe-objects" id="toc-dataframe-objects" class="nav-link" data-scroll-target="#dataframe-objects"><span class="header-section-number">3.2.4</span> <code>DataFrame</code> objects</a></li>
  </ul></li>
  <li><a href="#what-next" id="toc-what-next" class="nav-link" data-scroll-target="#what-next"><span class="header-section-number">3.3</span> What next?</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">3.4</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Relational Database and data wrangling</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>phonchi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<table align="left">
<tbody><tr><td>
<a href="https://colab.research.google.com/github/phonchi/nsysu-math608/blob/master/static_files/presentations/03_Relational_Database_and_data_wrangling.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a>
</td>
<td>
<a target="_blank" href="https://kaggle.com/kernels/welcome?src=https://github.com/phonchi/nsysu-math608/blob/master/static_files/presentations/03_Relational_Database_and_data_wrangling.ipynb"><img src="https://kaggle.com/static/images/open-in-kaggle.svg"></a>
</td>

</tr></tbody></table>
<p><br></p>
<section id="queringing-data-with-bigquery" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="queringing-data-with-bigquery"><span class="header-section-number">3.1</span> Queringing data with BigQuery</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:33:52.948724Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:33:52.948105Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:33:52.976140Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:33:52.975047Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:33:52.948606Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:270,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678073540159,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-trusted="true" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># For SQL</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> google.cloud <span class="im">import</span> bigquery</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Structured Query Language, or SQL, is the programming language used with databases, and it is an important skill for any data scientist. In this example, you’ll build your SQL skills using BigQuery, a web service work as database management system that lets you apply SQL to huge datasets.</p>
<section id="preliminaries-for-google-colab-optional" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="preliminaries-for-google-colab-optional"><span class="header-section-number">3.1.1</span> Preliminaries for google colab (optional)</h3>
<p>We want to start exploring the Google BiqQuery <a href="https://cloud.google.com/bigquery/public-data/">public datasets</a>. Let’s start by walking through the required setup steps, and then we can load and explore some data.</p>
<p>If you are using colab. Follow <a href="https://cloud.google.com/bigquery/docs/quickstarts/quickstart-client-libraries">this quickstart guide</a>, which will explain how to: 1. Create a <a href="https://console.cloud.google.com/cloud-resource-manager">Cloud Platform project</a> if you don’t have one already. 2. <a href="https://support.google.com/cloud/answer/6293499#enable-billing">Enable billing</a> for the project (If you apply the free trial, you already satisfy this condition.) 3. <a href="https://console.cloud.google.com/flows/enableapi?apiid=bigquery">Enable the BigQuery API</a> 4. <a href="https://cloud.google.com/docs/authentication/getting-started">Enabling the Service account</a></p>
<p>Now we need to authenticate to gain access to the BigQuery API. We will create a client, specifying the service account key file (replace ‘lunar-pact-378812-7a28b789bde2.json’ with your key file).</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678073702919,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># @title Setup</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="im">from</span> google.oauth2 <span class="im">import</span> service_account</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># </span><span class="al">TODO</span><span class="co">(developer): Set key_path to the path to the service account key file.</span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>key_path <span class="op">=</span> <span class="st">"lunar-pact-378812-7a28b789bde2.json"</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>credentials <span class="op">=</span> service_account.Credentials.from_service_account_file(</span>
<span id="cb2-9"><a href="#cb2-9"></a>    key_path</span>
<span id="cb2-10"><a href="#cb2-10"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># @title Alternative Setup</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#from google.colab import auth</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#from google.cloud import bigquery</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#from google.colab import data_table</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#project = 'lunar-pact-378812' # Project ID inserted based on the query results selected to explore</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#location = 'US' # Location inserted based on the query results selected to explore</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#client = bigquery.Client(project=project, location=location)</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#data_table.enable_dataframe_formatter()</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#auth.authenticate_user()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we’re authenticated, we need to load the BigQuery package, and the <code>google.colab.data_table</code> package that can be used to display large pandas dataframes as an interactive data. Loading <code>data_table</code> is optional, but it will be useful for working with data in pandas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#%load_ext google.cloud.bigquery</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#%load_ext google.colab.data_table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:259,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678073779380,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>client <span class="op">=</span> bigquery.Client(credentials<span class="op">=</span>credentials, project<span class="op">=</span>credentials.project_id,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-the-reference" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="create-the-reference"><span class="header-section-number">3.1.2</span> Create the reference</h3>
<p>You can also work with Kaggle, which provide bigquery integration that you do not need to setup a google account. <strong>Each Kaggle user can scan 5TB every 30 days for free. Once you hit that limit, you’ll have to wait for it to reset.</strong> See https://www.kaggle.com/product-feedback/48573 for more details.</p>
<p>The first step in the workflow is to create a <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.client.Client"><code>Client</code></a> object. As you’ll soon see, this <code>Client</code> object will play a central role in retrieving information from BigQuery datasets.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:20.953969Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:20.953692Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:20.959198Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:20.958252Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:20.953941Z&quot;}" data-trusted="true">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Uncomment below and create a "Client" object if you are using Kaggle</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># client = bigquery.Client()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll work with a dataset of posts on Hacker News, a website focusing on computer science and cybersecurity news. In BigQuery, each dataset is contained in a corresponding project. In this case, our <code>hacker_news</code> dataset is contained in the <code>bigquery-public-data project</code>.</p>
<p>To access the dataset, We begin by constructing a reference to the dataset with the <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.dataset.Dataset"><code>dataset()</code></a> method. Next, we use the <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.client.Client#google_cloud_bigquery_client_Client_get_dataset"><code>get_dataset()</code></a> method, along with the reference we just constructed, to fetch the dataset.</p>
<p><a href="https://console.cloud.google.com/marketplace/browse?filter=solution-type:dataset">See the full list of public datasets</a> or the <a href="https://www.kaggle.com/datasets?search=bigquery">kaggle bigquery dataset</a> if you want to explore others.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:22.840484Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:22.839652Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:23.269423Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:23.268733Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:22.840431Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:726,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678074093879,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-trusted="true" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Construct a reference to the "hacker_news" dataset</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"hacker_news"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Every dataset is just a collection of tables. You can think of a dataset as a spreadsheet file containing multiple tables, all composed of rows and columns.We use the <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.client.Client#google_cloud_bigquery_client_Client_list_tables"><code>list_tables()</code></a> method to list the tables in the dataset.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:25.195282Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:25.195022Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:25.507541Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:25.506966Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:25.195254Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:267,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678074104544,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6da878fd-6069-4598-b29e-49c6af88f7c0" data-trusted="true" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># List all the tables in the "hacker_news" dataset</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>tables <span class="op">=</span> <span class="bu">list</span>(client.list_tables(dataset))</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Print names of all tables in the dataset (there are four!)</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="cf">for</span> table <span class="kw">in</span> tables:  </span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="bu">print</span>(table.table_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>comments
full
full_201510
stories</code></pre>
</div>
</div>
<p>Similar to how we fetched a dataset, we can fetch a table. In the code cell below, we fetch the <code>full</code> table in the hacker_news dataset</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:26.127256Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:26.126551Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:26.318084Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:26.317267Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:26.127219Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:340,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678074119639,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-trusted="true" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Construct a reference to the "full" table</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"full"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>table <span class="op">=</span> client.get_table(table_ref)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the next section, you’ll explore the contents of this table in more detail. For now, take the time to use the image below to consolidate what you’ve learned so far.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/biYqbUB.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">first_commands</figcaption><p></p>
</figure>
</div>
</section>
<section id="table-schema" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="table-schema"><span class="header-section-number">3.1.3</span> Table schema</h3>
<p>The structure of a table is called its <strong>schema</strong>. <strong>We need to understand a table’s schema to effectively pull out the data we want.</strong></p>
<p>In this example, we’ll investigate the <code>full</code> table that we fetched above.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:27.440936Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:27.440643Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:27.448446Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:27.447878Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:27.440908Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:355,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678074144789,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="04ef9a21-91e7-4fc2-f75a-f31030bd5bd1" data-trusted="true" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Print information on all the columns in the "full" table in the "hacker_news" dataset</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>table.schema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>[SchemaField('title', 'STRING', 'NULLABLE', None, 'Story title', (), None),
 SchemaField('url', 'STRING', 'NULLABLE', None, 'Story url', (), None),
 SchemaField('text', 'STRING', 'NULLABLE', None, 'Story or comment text', (), None),
 SchemaField('dead', 'BOOLEAN', 'NULLABLE', None, 'Is dead?', (), None),
 SchemaField('by', 'STRING', 'NULLABLE', None, "The username of the item's author.", (), None),
 SchemaField('score', 'INTEGER', 'NULLABLE', None, 'Story score', (), None),
 SchemaField('time', 'INTEGER', 'NULLABLE', None, 'Unix time', (), None),
 SchemaField('timestamp', 'TIMESTAMP', 'NULLABLE', None, 'Timestamp for the unix time', (), None),
 SchemaField('type', 'STRING', 'NULLABLE', None, 'Type of details (comment, comment_ranking, poll, story, job, pollopt)', (), None),
 SchemaField('id', 'INTEGER', 'NULLABLE', None, "The item's unique id.", (), None),
 SchemaField('parent', 'INTEGER', 'NULLABLE', None, 'Parent comment ID', (), None),
 SchemaField('descendants', 'INTEGER', 'NULLABLE', None, 'Number of story or poll descendants', (), None),
 SchemaField('ranking', 'INTEGER', 'NULLABLE', None, 'Comment ranking', (), None),
 SchemaField('deleted', 'BOOLEAN', 'NULLABLE', None, 'Is deleted?', (), None)]</code></pre>
</div>
</div>
<p>Each <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.schema.SchemaField"><code>SchemaField</code></a> tells us about a specific column (which we also refer to as a <strong>field</strong>). In order, the information is:</p>
<ul>
<li>The <strong>name</strong> of the column</li>
<li>The <strong>field type</strong> (or datatype) in the column</li>
<li>The <strong>mode</strong> of the column (<code>'NULLABLE'</code> means that a column allows NULL values, and is the default)</li>
<li>A <strong>description</strong> of the data in that column</li>
</ul>
<p>For instance, the field has the SchemaField:</p>
<p><code>SchemaField('by', 'string', 'NULLABLE', "The username of the item's author.",())</code></p>
<p>This tells us: - the field (or column) is called <code>by</code>, - the data in this field is strings, - NULL values are allowed, and - it contains the usernames corresponding to each item’s author.</p>
<p>We can use the <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.client.Client#google_cloud_bigquery_client_Client_list_rows"><code>list_rows()</code></a> method to check just the first five lines of of the <code>full</code> table to make sure this is right. This returns a BigQuery <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.table.RowIterator"><code>RowIterator</code></a> object that can quickly be converted to a pandas DataFrame with the <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.table.RowIterator#google_cloud_bigquery_table_RowIterator_to_dataframe"><code>to_dataframe()</code></a> method.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:28.460370Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:28.459739Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:29.255110Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:29.254606Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:28.460329Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:710,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1678074184673,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e5885572-94f6-4d34-ce52-e36041a5a273" data-trusted="true" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Preview the first five lines of the "full" table</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

  <div id="df-0c40f075-dba3-47af-888a-836f4f75e92f">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">dead</th>
<th data-quarto-table-cell-role="th">by</th>
<th data-quarto-table-cell-role="th">score</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">descendants</th>
<th data-quarto-table-cell-role="th">ranking</th>
<th data-quarto-table-cell-role="th">deleted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>None</td>
<td>None</td>
<td>I would rather just have wired earbuds, period...</td>
<td>&lt;NA&gt;</td>
<td>zeveb</td>
<td>&lt;NA&gt;</td>
<td>1591717736</td>
<td>2020-06-09 15:48:56+00:00</td>
<td>comment</td>
<td>23467666</td>
<td>23456782</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>None</td>
<td>None</td>
<td>DNS?</td>
<td>&lt;NA&gt;</td>
<td>nly</td>
<td>&lt;NA&gt;</td>
<td>1572810465</td>
<td>2019-11-03 19:47:45+00:00</td>
<td>comment</td>
<td>21436112</td>
<td>21435130</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>None</td>
<td>None</td>
<td>These benchmarks seem pretty good. Filterable...</td>
<td>&lt;NA&gt;</td>
<td>mrkeen</td>
<td>&lt;NA&gt;</td>
<td>1591717727</td>
<td>2020-06-09 15:48:47+00:00</td>
<td>comment</td>
<td>23467665</td>
<td>23467426</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>None</td>
<td>None</td>
<td>Oh really?&lt;p&gt;* Excel alone uses 86.1MB of priv...</td>
<td>&lt;NA&gt;</td>
<td>oceanswave</td>
<td>&lt;NA&gt;</td>
<td>1462987532</td>
<td>2016-05-11 17:25:32+00:00</td>
<td>comment</td>
<td>11677248</td>
<td>11676886</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>None</td>
<td>None</td>
<td>These systems are useless. Of the many flaws:...</td>
<td>&lt;NA&gt;</td>
<td>nyxxie</td>
<td>&lt;NA&gt;</td>
<td>1572810473</td>
<td>2019-11-03 19:47:53+00:00</td>
<td>comment</td>
<td>21436113</td>
<td>21435025</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0c40f075-dba3-47af-888a-836f4f75e92f')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0c40f075-dba3-47af-888a-836f4f75e92f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0c40f075-dba3-47af-888a-836f4f75e92f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The <code>list_rows()</code> method will also let us look at just the information in a specific column. If we want to see the first five entries in the <code>by</code> column, for example, we can do that!</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:30.428784Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:30.428333Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:30.823825Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:30.823228Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:30.428728Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:295,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904734510,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a0c18034-a3a0-4229-f190-8824fe070c4c" data-trusted="true">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Preview the first five entries in the "by" column of the "full" table</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>client.list_rows(table, selected_fields<span class="op">=</span>table.schema[<span class="dv">4</span>:<span class="dv">5</span>], max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

  <div id="df-f9ddd70a-f873-4167-a8d2-ff8239b82e02">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">by</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>zeveb</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>nly</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>mrkeen</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>oceanswave</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>nyxxie</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f9ddd70a-f873-4167-a8d2-ff8239b82e02')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f9ddd70a-f873-4167-a8d2-ff8239b82e02 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f9ddd70a-f873-4167-a8d2-ff8239b82e02');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="select-from-where" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="select-from-where"><span class="header-section-number">3.1.4</span> Select, From &amp; Where</h3>
<p>Now that you know how to access and examine a dataset, you’re ready to write your first SQL query! As you’ll soon see, <strong>SQL queries will help you sort through a massive dataset, to retrieve only the information that you need.</strong> We’ll begin by using the keywords <strong>SELECT</strong>, <strong>FROM</strong>, and <strong>WHERE</strong> to get data from specific columns based on conditions you specify.</p>
<p>We’ll use an <a href="https://openaq.org">OpenAQ</a> dataset about air quality. First, we’ll set up everything we need to run queries and take a quick peek at what tables are in our database.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:34.103476Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:34.103065Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:34.569656Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:34.568998Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:34.103437Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:751,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904760800,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="277fe2a4-ba82-47f9-e020-307c5072e1dd" data-trusted="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Construct a reference to the "openaq" dataset</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"openaq"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co"># List all the tables in the "openaq" dataset</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>tables <span class="op">=</span> <span class="bu">list</span>(client.list_tables(dataset))</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># Print names of all tables in the dataset (there's only one!)</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="cf">for</span> table <span class="kw">in</span> tables:  </span>
<span id="cb15-12"><a href="#cb15-12"></a>    <span class="bu">print</span>(table.table_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>global_air_quality</code></pre>
</div>
</div>
<p>The dataset contains only one table, called <code>global_air_quality</code>. We’ll fetch the table and take a peek at the first few rows to see what sort of data it contains.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:36.196746Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:36.196047Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:36.908751Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:36.907911Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:36.196712Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:893,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904763223,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b8d62a1c-2e79-4152-bdd7-953848d61089" data-trusted="true">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Construct a reference to the "global_air_quality" table</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"global_air_quality"</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co"># Preview the first five lines of the "global_air_quality" table</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

  <div id="df-cc02e0ea-9008-43ad-9b94-c0a9e8209669">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">pollutant</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">unit</th>
<th data-quarto-table-cell-role="th">source_name</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">averaged_over_in_hours</th>
<th data-quarto-table-cell-role="th">location_geom</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Borówiec, ul. Drapałka</td>
<td>Borówiec</td>
<td>PL</td>
<td>bc</td>
<td>0.85217</td>
<td>2022-04-28 07:00:00+00:00</td>
<td>µg/m³</td>
<td>GIOS</td>
<td>1.0</td>
<td>52.276794</td>
<td>17.074114</td>
<td>POINT(52.276794 1)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Kraków, ul. Bulwarowa</td>
<td>Kraków</td>
<td>PL</td>
<td>bc</td>
<td>0.91284</td>
<td>2022-04-27 23:00:00+00:00</td>
<td>µg/m³</td>
<td>GIOS</td>
<td>1.0</td>
<td>50.069308</td>
<td>20.053492</td>
<td>POINT(50.069308 1)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Płock, ul. Reja</td>
<td>Płock</td>
<td>PL</td>
<td>bc</td>
<td>1.41000</td>
<td>2022-03-30 04:00:00+00:00</td>
<td>µg/m³</td>
<td>GIOS</td>
<td>1.0</td>
<td>52.550938</td>
<td>19.709791</td>
<td>POINT(52.550938 1)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Elbląg, ul. Bażyńskiego</td>
<td>Elbląg</td>
<td>PL</td>
<td>bc</td>
<td>0.33607</td>
<td>2022-05-03 13:00:00+00:00</td>
<td>µg/m³</td>
<td>GIOS</td>
<td>1.0</td>
<td>54.167847</td>
<td>19.410942</td>
<td>POINT(54.167847 1)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Piastów, ul. Pułaskiego</td>
<td>Piastów</td>
<td>PL</td>
<td>bc</td>
<td>0.51000</td>
<td>2022-05-11 05:00:00+00:00</td>
<td>µg/m³</td>
<td>GIOS</td>
<td>1.0</td>
<td>52.191728</td>
<td>20.837489</td>
<td>POINT(52.191728 1)</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cc02e0ea-9008-43ad-9b94-c0a9e8209669')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cc02e0ea-9008-43ad-9b94-c0a9e8209669 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cc02e0ea-9008-43ad-9b94-c0a9e8209669');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>let’s put together a query. Say we want to select all the values from the <code>city</code> column that are in rows where the <code>country</code> column is <code>'US'</code> (for “United States”).</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:34:37.669919Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:34:37.669408Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:34:37.674122Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:34:37.673374Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:34:37.669880Z&quot;}" data-trusted="true">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Query to select all the items from the "city" column where the "country" column is 'US'</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co"># SQL is almost completely case and indentation insensitive. The capitalization and</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co"># indentation style here is preferred style.</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">        SELECT city</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="st">        FROM `bigquery-public-data.openaq.global_air_quality`</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="st">        WHERE country = 'US'</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="st">        """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice also that SQL statements requires single quotes for its strings inside python string (we use triple quotation mark here). We begin by setting up the query with the <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.client.Client#google_cloud_bigquery_client_Client_query"><code>query()</code></a> method.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:35:55.759311Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:35:55.758822Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:35:59.638985Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:35:59.638236Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:35:55.759280Z&quot;}" data-trusted="true">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Set up the query</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>query_job <span class="op">=</span> client.query(query)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># API request - run the query, and return a pandas DataFrame</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>us_cities <span class="op">=</span> query_job.to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ve got a pandas DataFrame called <code>us_cities</code>, which we can use like any other DataFrame.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:36:03.919522Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:36:03.918735Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:36:03.937814Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:36:03.936847Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:36:03.919480Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:461,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904819538,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d3fdf5bd-ac14-4e0b-9ec9-358088ac0c20" data-trusted="true">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># What five cities have the most measurements?</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>us_cities.city.value_counts().head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Phoenix-Mesa-Scottsdale                     39414
Los Angeles-Long Beach-Santa Ana            27479
Riverside-San Bernardino-Ontario            26887
New York-Northern New Jersey-Long Island    25417
San Francisco-Oakland-Fremont               22710
Name: city, dtype: int64</code></pre>
</div>
</div>
<p>If you want multiple columns, you can select them with a comma between the names:</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:40:51.488176Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:40:51.487848Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:40:51.492074Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:40:51.491286Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:40:51.488143Z&quot;}" data-trusted="true">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="st">        SELECT city, country</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st">        FROM `bigquery-public-data.openaq.global_air_quality`</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="st">        WHERE country = 'US'</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="st">        """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can select all columns with a <code>*</code> like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="st">        SELECT *</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="st">        FROM `bigquery-public-data.openaq.global_air_quality`</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">        WHERE country = 'US'</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="st">        """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="querying-big-dataset" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="querying-big-dataset"><span class="header-section-number">3.1.5</span> Querying big dataset</h3>
<p>You can estimate the size of any query before running it. Here is an example using the Hacker News dataset. To see how much data a query will scan, we create a <a href="https://cloud.google.com/python/docs/reference/bigquery/latest/google.cloud.bigquery.job.QueryJobConfig"><code>QueryJobConfig</code></a> object and set the <code>dry_run</code> parameter to <code>True</code>.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:43:43.637619Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:43:43.636879Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:43:44.083153Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:43:44.082302Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:43:43.637561Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:792,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904896083,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="7c54439f-ddc1-4e53-fe2b-a7a90e2af989" data-trusted="true">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Query to get the score column from every row where the type column has value "job"</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="st">        SELECT score, title</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="st">        FROM `bigquery-public-data.hacker_news.full`</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="st">        WHERE type = "job" </span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="st">        """</span></span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co"># Create a QueryJobConfig object to estimate size of query without running it</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>dry_run_config <span class="op">=</span> bigquery.QueryJobConfig(dry_run<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co"># API request - dry run query to estimate costs</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>dry_run_query_job <span class="op">=</span> client.query(query, job_config<span class="op">=</span>dry_run_config)</span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="bu">print</span>(<span class="st">"This query will process </span><span class="sc">{}</span><span class="st"> bytes."</span>.<span class="bu">format</span>(dry_run_query_job.total_bytes_processed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>This query will process 553320240 bytes.</code></pre>
</div>
</div>
<p>You can also specify a parameter when running the query to limit how much data you are willing to scan. Here’s an example with a low limit.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:44:14.960252Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:44:14.959744Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:44:15.424113Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:44:15.422855Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:44:14.960218Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:1087,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1677904931810,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a234343a-071c-4900-d046-7bb80ae804b1" data-trusted="true">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Only run the query if it's less than 1 MB</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>ONE_MB <span class="op">=</span> <span class="dv">1000</span><span class="op">*</span><span class="dv">1000</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span>ONE_MB)</span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># Set up the query (will only run if it's less than 1 MB)</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>safe_query_job <span class="op">=</span> client.query(query, job_config<span class="op">=</span>safe_config)</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># API request - try to run the query, and return a pandas DataFrame</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>safe_query_job.to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>InternalServerError: ignored</code></pre>
</div>
</div>
<p>In this case, the query was cancelled, because the limit of 1 MB was exceeded. However, we can also increase the limit to run the query successfully!</p>
</section>
<section id="group-by-having-count" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="group-by-having-count"><span class="header-section-number">3.1.6</span> Group By, Having &amp; Count</h3>
<p>Now that you can select raw data, you’re ready to learn how to group your data and count things within those groups.</p>
<p>The Hacker News dataset contains information on stories and comments from the Hacker News social networking site. We’ll work with the <code>comments</code> table and begin by printing the first few rows</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:50:17.465984Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:50:17.465447Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:50:18.444486Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:50:18.443937Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:50:17.465945Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:1071,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904944129,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c3df653f-233f-4318-b8de-bc41cb0be246" data-trusted="true">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Construct a reference to the "hacker_news" dataset</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"hacker_news"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co"># Construct a reference to the "comments" table</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"comments"</span>)</span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb28-12"><a href="#cb28-12"></a></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co"># Preview the first five lines of the "comments" table</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

  <div id="df-53bc3cb9-663f-483e-a32a-76ae1864ac39">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">by</th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">time_ts</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">deleted</th>
<th data-quarto-table-cell-role="th">dead</th>
<th data-quarto-table-cell-role="th">ranking</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9734136</td>
<td>None</td>
<td>None</td>
<td>1434565400</td>
<td>2015-06-17 18:23:20+00:00</td>
<td>None</td>
<td>9733698</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4921158</td>
<td>None</td>
<td>None</td>
<td>1355496966</td>
<td>2012-12-14 14:56:06+00:00</td>
<td>None</td>
<td>4921100</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7500568</td>
<td>None</td>
<td>None</td>
<td>1396261158</td>
<td>2014-03-31 10:19:18+00:00</td>
<td>None</td>
<td>7499385</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>8909635</td>
<td>None</td>
<td>None</td>
<td>1421627275</td>
<td>2015-01-19 00:27:55+00:00</td>
<td>None</td>
<td>8901135</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>9256463</td>
<td>None</td>
<td>None</td>
<td>1427204705</td>
<td>2015-03-24 13:45:05+00:00</td>
<td>None</td>
<td>9256346</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-53bc3cb9-663f-483e-a32a-76ae1864ac39')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-53bc3cb9-663f-483e-a32a-76ae1864ac39 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-53bc3cb9-663f-483e-a32a-76ae1864ac39');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Let’s use the table to see which comments generated the most replies. Since: - the <code>parent</code> column indicates the comment that was replied to, and - the <code>id</code> column has the unique ID used to identify each comment,</p>
<p>we can <strong>GROUP BY</strong> the <code>parent</code> column and <strong>COUNT()</strong> the <code>id</code> column in order to figure out the number of comments that were made as responses to a specific comment.</p>
<p>Furthermore, since we’re only interested in popular comments, we’ll look at comments with more than ten replies. So, we’ll only return groups <strong>HAVING</strong> more than ten ID’s.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:51:01.675922Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:51:01.675659Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:51:01.682999Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:51:01.682129Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:51:01.675896Z&quot;}" data-trusted="true">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Query to select comments that received more than 10 replies</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>query_popular <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">                SELECT parent, COUNT(id)</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="st">                FROM `bigquery-public-data.hacker_news.comments`</span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="st">                GROUP BY parent</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="st">                HAVING COUNT(id) &gt; 10</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="st">                """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:51:25.841060Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:51:25.840649Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:51:32.497782Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:51:32.496981Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:51:25.841031Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:4766,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904952563,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="547de823-1dd6-46cd-cdc0-028f947f0a32" data-trusted="true">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Set up the query (cancel the query if it would use too much of </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co"># your quota, with the limit set to 10 GB)</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">10</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>query_job <span class="op">=</span> client.query(query_popular, job_config<span class="op">=</span>safe_config)</span>
<span id="cb30-5"><a href="#cb30-5"></a></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co"># API request - run the query, and convert the results to a pandas DataFrame</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>popular_comments <span class="op">=</span> query_job.to_dataframe()</span>
<span id="cb30-8"><a href="#cb30-8"></a></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="co"># Print the first five rows of the DataFrame</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>popular_comments.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

  <div id="df-36c5785d-e5cc-4839-a039-b37aa532c175">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">f0_</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2385424</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8441979</td>
<td>57</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7634152</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>9062758</td>
<td>49</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5694173</td>
<td>61</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-36c5785d-e5cc-4839-a039-b37aa532c175')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-36c5785d-e5cc-4839-a039-b37aa532c175 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-36c5785d-e5cc-4839-a039-b37aa532c175');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904952563,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0b576bc4-f1df-4b66-d190-3a9ddd5fe105">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>popular_comments</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

  <div id="df-1ec3b4f4-92b3-4086-aad9-b948f9b4778e">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">f0_</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2385424</td>
<td>55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8441979</td>
<td>57</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7634152</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>9062758</td>
<td>49</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5694173</td>
<td>61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77363</td>
<td>1748827</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77364</td>
<td>3657756</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77365</td>
<td>2873865</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77366</td>
<td>9395540</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77367</td>
<td>1772903</td>
<td>37</td>
</tr>
</tbody>
</table>


<p>77368 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1ec3b4f4-92b3-4086-aad9-b948f9b4778e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1ec3b4f4-92b3-4086-aad9-b948f9b4778e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1ec3b4f4-92b3-4086-aad9-b948f9b4778e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Each row in the <code>popular_comments</code> DataFrame corresponds to a comment that received more than ten replies.</p>
<p>A couple hints to make your queries even better: - The column resulting from <code>COUNT(id)</code> was called <code>f0__</code>. That’s not a very descriptive name. You can change the name by adding <code>AS NumPosts</code> after you specify the aggregation. This is called <strong>aliasing</strong>. - If you are ever unsure what to put inside the <strong>COUNT()</strong> function, you can do <code>COUNT(1)</code> to count the rows in each group. Most people find it especially readable, because we know it’s not focusing on other columns. It also scans less data than if supplied column names (making it faster and using less of your data access quota).</p>
<p>Using these tricks, we can rewrite our query:</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-04-23T03:53:18.501994Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-04-23T03:53:18.501704Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-04-23T03:53:24.596965Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-04-23T03:53:24.596042Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-04-23T03:53:18.501962Z&quot;}" data-executioninfo="{&quot;elapsed&quot;:4829,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904957388,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ed4a6f41-1e06-4c1c-d1dd-8f5d4db42ab2" data-trusted="true">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Improved version of earlier query, now with aliasing &amp; improved readability</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>query_improved <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">                 SELECT parent, COUNT(1) AS NumPosts</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">                 FROM `bigquery-public-data.hacker_news.comments`</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st">                 GROUP BY parent</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">                 HAVING COUNT(1) &gt; 10</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="st">                 """</span></span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">10</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a>query_job <span class="op">=</span> client.query(query_improved, job_config<span class="op">=</span>safe_config)</span>
<span id="cb32-11"><a href="#cb32-11"></a></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="co"># API request - run the query, and convert the results to a pandas DataFrame</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>improved_df <span class="op">=</span> query_job.to_dataframe()</span>
<span id="cb32-14"><a href="#cb32-14"></a></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="co"># Print the first five rows of the DataFrame</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>improved_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

  <div id="df-ad9c1f95-d765-4d33-8e5d-7c3470b0e704">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">NumPosts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2970550</td>
<td>63</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8254532</td>
<td>40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7687784</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4101992</td>
<td>53</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1632878</td>
<td>39</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ad9c1f95-d765-4d33-8e5d-7c3470b0e704')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ad9c1f95-d765-4d33-8e5d-7c3470b0e704 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ad9c1f95-d765-4d33-8e5d-7c3470b0e704');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904957389,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1a455b8b-0efc-4c8f-e13c-bd785d716486">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>improved_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

  <div id="df-e4e931ef-1e18-4e6a-8a11-10141bce2dba">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">NumPosts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2970550</td>
<td>63</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8254532</td>
<td>40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7687784</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4101992</td>
<td>53</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1632878</td>
<td>39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77363</td>
<td>7844298</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77364</td>
<td>7864644</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77365</td>
<td>2866332</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">77366</td>
<td>1885594</td>
<td>37</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77367</td>
<td>2175321</td>
<td>37</td>
</tr>
</tbody>
</table>


<p>77368 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e4e931ef-1e18-4e6a-8a11-10141bce2dba')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e4e931ef-1e18-4e6a-8a11-10141bce2dba button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e4e931ef-1e18-4e6a-8a11-10141bce2dba');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Now you have the data you want, and it has descriptive names.</p>
<section id="note-on-using-group-by" class="level4" data-number="3.1.6.1">
<h4 data-number="3.1.6.1" class="anchored" data-anchor-id="note-on-using-group-by"><span class="header-section-number">3.1.6.1</span> Note on using <strong>GROUP BY</strong></h4>
<p>Note that because it tells SQL how to apply aggregate functions (like <strong>COUNT()</strong>), it doesn’t make sense to use <strong>GROUP BY</strong> without an aggregate function. Similarly, if you have any <strong>GROUP BY</strong> clause, then all variables must be passed to either a 1. <strong>GROUP BY</strong> command, or 2. an aggregation function.</p>
<p>Consider the query below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>query_good <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">             SELECT parent, COUNT(id)</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">             FROM `bigquery-public-data.hacker_news.comments`</span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="st">             GROUP BY parent</span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="st">             """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that there are two variables: <code>parent</code> and <code>id</code>. - <code>parent</code> was passed to a <strong>GROUP BY</strong> command (in <code>GROUP BY parent</code>), and - <code>id</code> was passed to an aggregate function (in <code>COUNT(id)</code>).</p>
<p>And the query below won’t work, because the <code>author</code> column isn’t passed to an aggregate function or a <strong>GROUP BY</strong> clause:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>query_bad <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">            SELECT author, parent, COUNT(id)</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="st">            FROM `bigquery-public-data.hacker_news.comments`</span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="st">            GROUP BY parent</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="st">            """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:442,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1677904957827,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="98030991-b11b-4cab-b355-1c669df47bd9">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">10</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>query_job <span class="op">=</span> client.query(query_bad, job_config<span class="op">=</span>safe_config)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co"># API request - run the query, and convert the results to a pandas DataFrame</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>improved_df <span class="op">=</span> query_job.to_dataframe()</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co"># Print the first five rows of the DataFrame</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>improved_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>BadRequest: ignored</code></pre>
</div>
</div>
</section>
</section>
<section id="order-by" class="level3" data-number="3.1.7">
<h3 data-number="3.1.7" class="anchored" data-anchor-id="order-by"><span class="header-section-number">3.1.7</span> Order By</h3>
<p>Frequently, you’ll want to sort your results. <strong>Let’s use the US Traffic Fatality Records database, which contains information on traffic accidents in the US where at least one person died.</strong></p>
<p>We’ll investigate the <code>accident_2015</code> table. Here is a view of the first few rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Construct a reference to the "nhtsa_traffic_fatalities" dataset</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"nhtsa_traffic_fatalities"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co"># Construct a reference to the "accident_2015" table</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"accident_2015"</span>)</span>
<span id="cb38-9"><a href="#cb38-9"></a></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb38-12"><a href="#cb38-12"></a></span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="co"># Preview the first five lines of the "accident_2015" table</span></span>
<span id="cb38-14"><a href="#cb38-14"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s use the table to determine how the number of accidents varies with the day of the week. Since: - the <code>consecutive_number</code> column contains a unique ID for each accident, and - the <code>timestamp_of_crash</code> column contains the date of the accident in <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions">DATETIME</a> format,</p>
<p>we can: - <strong>EXTRACT</strong> the day of the week (as <code>day_of_week</code> in the query below) from the <code>timestamp_of_crash</code> column, and - <strong>GROUP BY</strong> the day of the week, before we <strong>COUNT</strong> the <code>consecutive_number</code> column to determine the number of accidents for each day of the week.</p>
<p>Then we sort the table with an <strong>ORDER BY</strong> clause, so the days with the most accidents are returned first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Query to find out the number of accidents for each day of the week</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="st">        SELECT COUNT(consecutive_number) AS num_accidents, </span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">               EXTRACT(DAYOFWEEK FROM timestamp_of_crash) AS day_of_week</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="st">        FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`</span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="st">        GROUP BY day_of_week</span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="st">        ORDER BY num_accidents DESC</span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="st">        """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3091,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904962422,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1b7328f6-2197-434c-9901-635057921419">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Set up the query (cancel the query if it would use too much of </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co"># your quota, with the limit set to 1 GB)</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">9</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a>query_job <span class="op">=</span> client.query(query, job_config<span class="op">=</span>safe_config)</span>
<span id="cb40-5"><a href="#cb40-5"></a></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="co"># API request - run the query, and convert the results to a pandas DataFrame</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>accidents_by_day <span class="op">=</span> query_job.to_dataframe()</span>
<span id="cb40-8"><a href="#cb40-8"></a></span>
<span id="cb40-9"><a href="#cb40-9"></a><span class="co"># Print the DataFrame</span></span>
<span id="cb40-10"><a href="#cb40-10"></a>accidents_by_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

  <div id="df-60df7ecf-164e-409f-9659-78da70e9d1d1">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">num_accidents</th>
<th data-quarto-table-cell-role="th">day_of_week</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5659</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5298</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4916</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4460</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4182</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4038</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>3985</td>
<td>3</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-60df7ecf-164e-409f-9659-78da70e9d1d1')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-60df7ecf-164e-409f-9659-78da70e9d1d1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-60df7ecf-164e-409f-9659-78da70e9d1d1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Notice that the data is sorted by the <code>num_accidents</code> column, where the days with more traffic accidents appear first.</p>
<p>To map the numbers returned for the <code>day_of_week</code> column to the actual day, you might consult <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions">the BigQuery documentation</a> on the DAYOFWEEK function. It says that it returns “an integer between 1 (Sunday) and 7 (Saturday), inclusively”. So, in 2015, most fatal motor accidents in the US occured on Sunday and Saturday, while the fewest happened on Tuesday.</p>
</section>
<section id="as-and-with" class="level3" data-number="3.1.8">
<h3 data-number="3.1.8" class="anchored" data-anchor-id="as-and-with"><span class="header-section-number">3.1.8</span> As and With</h3>
<p>On its own, <code>AS</code> is a convenient way to clean up the data returned by your query. <strong>We’re going to use a common table expression (CTE)</strong> to find out <strong>how many Bitcoin transactions were made each day for the entire timespan of a bitcoin transaction dataset.</strong></p>
<p>We’ll investigate the transactions table. Here is a view of the first few rows.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:942,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904964332,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0f810490-f2ee-4744-dbc2-5cb730f71760">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Construct a reference to the "crypto_bitcoin" dataset</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"crypto_bitcoin"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb41-6"><a href="#cb41-6"></a></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="co"># Construct a reference to the "transactions" table</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"transactions"</span>)</span>
<span id="cb41-9"><a href="#cb41-9"></a></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb41-12"><a href="#cb41-12"></a></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="co"># Preview the first five lines of the "transactions" table</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

  <div id="df-6de6cf2c-be5b-4dc5-a97f-820f6f2603a9">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">hash</th>
<th data-quarto-table-cell-role="th">size</th>
<th data-quarto-table-cell-role="th">virtual_size</th>
<th data-quarto-table-cell-role="th">version</th>
<th data-quarto-table-cell-role="th">lock_time</th>
<th data-quarto-table-cell-role="th">block_hash</th>
<th data-quarto-table-cell-role="th">block_number</th>
<th data-quarto-table-cell-role="th">block_timestamp</th>
<th data-quarto-table-cell-role="th">block_timestamp_month</th>
<th data-quarto-table-cell-role="th">input_count</th>
<th data-quarto-table-cell-role="th">output_count</th>
<th data-quarto-table-cell-role="th">input_value</th>
<th data-quarto-table-cell-role="th">output_value</th>
<th data-quarto-table-cell-role="th">is_coinbase</th>
<th data-quarto-table-cell-role="th">fee</th>
<th data-quarto-table-cell-role="th">inputs</th>
<th data-quarto-table-cell-role="th">outputs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a16f3ce4dd5deb92d98ef5cf8afeaf0775ebca408f708b...</td>
<td>275</td>
<td>275</td>
<td>1</td>
<td>0</td>
<td>00000000dc55860c8a29c58d45209318fa9e9dc2c1833a...</td>
<td>181</td>
<td>2009-01-12 06:02:13+00:00</td>
<td>2009-01-01</td>
<td>1</td>
<td>2</td>
<td>4000000000.000000000</td>
<td>4000000000.000000000</td>
<td>False</td>
<td>0E-9</td>
<td>[{'index': 0, 'spent_transaction_hash': 'f4184...</td>
<td>[{'index': 0, 'script_asm': '04b5abd412d4341b4...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>591e91f809d716912ca1d4a9295e70c3e78bab077683f7...</td>
<td>275</td>
<td>275</td>
<td>1</td>
<td>0</td>
<td>0000000054487811fc4ff7a95be738aa5ad9320c394c48...</td>
<td>182</td>
<td>2009-01-12 06:12:16+00:00</td>
<td>2009-01-01</td>
<td>1</td>
<td>2</td>
<td>3000000000.000000000</td>
<td>3000000000.000000000</td>
<td>False</td>
<td>0E-9</td>
<td>[{'index': 0, 'spent_transaction_hash': 'a16f3...</td>
<td>[{'index': 0, 'script_asm': '0401518fa1d1e1e3e...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12b5633bad1f9c167d523ad1aa1947b2732a865bf5414e...</td>
<td>276</td>
<td>276</td>
<td>1</td>
<td>0</td>
<td>00000000f46e513f038baf6f2d9a95b2a28d8a6c985bcf...</td>
<td>183</td>
<td>2009-01-12 06:34:22+00:00</td>
<td>2009-01-01</td>
<td>1</td>
<td>2</td>
<td>2900000000.000000000</td>
<td>2900000000.000000000</td>
<td>False</td>
<td>0E-9</td>
<td>[{'index': 0, 'spent_transaction_hash': '591e9...</td>
<td>[{'index': 0, 'script_asm': '04baa9d3665315562...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>828ef3b079f9c23829c56fe86e85b4a69d9e06e5b54ea5...</td>
<td>276</td>
<td>276</td>
<td>1</td>
<td>0</td>
<td>00000000fb5b44edc7a1aa105075564a179d65506e2bd2...</td>
<td>248</td>
<td>2009-01-12 20:04:20+00:00</td>
<td>2009-01-01</td>
<td>1</td>
<td>2</td>
<td>2800000000.000000000</td>
<td>2800000000.000000000</td>
<td>False</td>
<td>0E-9</td>
<td>[{'index': 0, 'spent_transaction_hash': '12b56...</td>
<td>[{'index': 0, 'script_asm': '04bed827d37474bef...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>35288d269cee1941eaebb2ea85e32b42cdb2b04284a56d...</td>
<td>277</td>
<td>277</td>
<td>1</td>
<td>0</td>
<td>00000000689051c09ff2cd091cc4c22c10b965eb8db3ad...</td>
<td>545</td>
<td>2009-01-15 05:48:32+00:00</td>
<td>2009-01-01</td>
<td>1</td>
<td>2</td>
<td>2500000000.000000000</td>
<td>2500000000.000000000</td>
<td>False</td>
<td>0E-9</td>
<td>[{'index': 0, 'spent_transaction_hash': 'd71fd...</td>
<td>[{'index': 0, 'script_asm': '044a656f065871a35...</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6de6cf2c-be5b-4dc5-a97f-820f6f2603a9')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6de6cf2c-be5b-4dc5-a97f-820f6f2603a9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6de6cf2c-be5b-4dc5-a97f-820f6f2603a9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Since the <code>block_timestamp</code> column contains the date of each transaction in DATETIME format, we’ll convert these into DATE format using the <strong>DATE()</strong> command.</p>
<p>We do that using a CTE, and then the next part of the query counts the number of transactions for each date and sorts the table so that earlier dates appear first.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:12341,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904978087,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="73c6074a-9701-43e2-82f9-d212c1750417">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Query to select the number of transactions per date, sorted by date</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>query_with_CTE <span class="op">=</span> <span class="st">""" </span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="st">                 WITH time AS </span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="st">                 (</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="st">                     SELECT DATE(block_timestamp) AS trans_date</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="st">                     FROM `bigquery-public-data.crypto_bitcoin.transactions`</span></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="st">                 )</span></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="st">                 SELECT COUNT(1) AS transactions,</span></span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="st">                        trans_date</span></span>
<span id="cb42-10"><a href="#cb42-10"></a><span class="st">                 FROM time</span></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="st">                 GROUP BY trans_date</span></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="st">                 ORDER BY trans_date</span></span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="st">                 """</span></span>
<span id="cb42-14"><a href="#cb42-14"></a></span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="co"># Set up the query (cancel the query if it would use too much of </span></span>
<span id="cb42-16"><a href="#cb42-16"></a><span class="co"># your quota, with the limit set to 10 GB)</span></span>
<span id="cb42-17"><a href="#cb42-17"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">10</span>)</span>
<span id="cb42-18"><a href="#cb42-18"></a>query_job <span class="op">=</span> client.query(query_with_CTE, job_config<span class="op">=</span>safe_config)</span>
<span id="cb42-19"><a href="#cb42-19"></a></span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="co"># API request - run the query, and convert the results to a pandas DataFrame</span></span>
<span id="cb42-21"><a href="#cb42-21"></a>transactions_by_date <span class="op">=</span> query_job.to_dataframe()</span>
<span id="cb42-22"><a href="#cb42-22"></a></span>
<span id="cb42-23"><a href="#cb42-23"></a><span class="co"># Print the first five rows</span></span>
<span id="cb42-24"><a href="#cb42-24"></a>transactions_by_date.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

  <div id="df-5045fd7a-3f26-4889-9cac-fd8deff3d18b">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">transactions</th>
<th data-quarto-table-cell-role="th">trans_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2009-01-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>14</td>
<td>2009-01-09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>61</td>
<td>2009-01-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>93</td>
<td>2009-01-11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>101</td>
<td>2009-01-12</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5045fd7a-3f26-4889-9cac-fd8deff3d18b')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5045fd7a-3f26-4889-9cac-fd8deff3d18b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5045fd7a-3f26-4889-9cac-fd8deff3d18b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Since they’re returned sorted, we can easily plot the raw results to show us the number of Bitcoin transactions per day over the whole timespan of this dataset.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:523,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904978603,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2365b1e6-b1b7-442f-ad5e-69af791de67a">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>transactions_by_date.set_index(<span class="st">'trans_date'</span>).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>&lt;AxesSubplot:xlabel='trans_date'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="03_Relational_Database_and_data_wrangling_files/figure-html/cell-37-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As you can see, common table expressions (CTEs) let you shift a lot of your data cleaning into SQL. <strong>That’s an especially good thing in the case of BigQuery, because it is vastly faster than doing the work in Pandas.</strong></p>
</section>
<section id="joining-data" class="level3" data-number="3.1.9">
<h3 data-number="3.1.9" class="anchored" data-anchor-id="joining-data"><span class="header-section-number">3.1.9</span> Joining data</h3>
<p>When our data lives across different tables, how do we analyze it? By JOINing the tables together. A <code>JOIN</code> combines rows in the left table with corresponding rows in the right table, where the meaning of “corresponding” is based on how we specify the join.</p>
<p>GitHub is the most popular place to collaborate on software projects. A GitHub <strong>repository</strong> (or <strong>repo</strong>) is a collection of files associated with a specific project. Most repos on GitHub are shared under a specific legal license, which determines the legal restrictions on how they are used. <strong>For our example, we’re going to look at how many different files have been released under each license.</strong></p>
<p>We’ll work with two tables in the database. The first table is the <code>licenses</code> table, which provides the name of each GitHub repo (in the <code>repo_name</code> column) and its corresponding license. Here’s a view of the first five rows.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1014,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904979614,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0d8e7ac5-7733-4868-c626-ea1b623b3510">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Construct a reference to the "github_repos" dataset</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"github_repos"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb45-6"><a href="#cb45-6"></a></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="co"># Construct a reference to the "licenses" table</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>licenses_ref <span class="op">=</span> dataset_ref.table(<span class="st">"licenses"</span>)</span>
<span id="cb45-9"><a href="#cb45-9"></a></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>licenses_table <span class="op">=</span> client.get_table(licenses_ref)</span>
<span id="cb45-12"><a href="#cb45-12"></a></span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="co"># Preview the first five lines of the "licenses" table</span></span>
<span id="cb45-14"><a href="#cb45-14"></a>client.list_rows(licenses_table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

  <div id="df-6a859134-c8ae-4f4d-9706-e650f540dbdd">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">repo_name</th>
<th data-quarto-table-cell-role="th">license</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>autarch/Dist-Zilla-Plugin-Test-TidyAll</td>
<td>artistic-2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>thundergnat/Prime-Factor</td>
<td>artistic-2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>kusha-b-k/Turabian_Engin_Fan</td>
<td>artistic-2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>onlinepremiumoutlet/onlinepremiumoutlet.github.io</td>
<td>artistic-2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>huangyuanlove/LiaoBa_Service</td>
<td>artistic-2.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6a859134-c8ae-4f4d-9706-e650f540dbdd')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6a859134-c8ae-4f4d-9706-e650f540dbdd button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6a859134-c8ae-4f4d-9706-e650f540dbdd');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The second table is the <code>sample_files</code> table, which provides, among other information, the GitHub repo that each file belongs to (in the <code>repo_name</code> column). The first several rows of this table are printed below.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:473,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904980085,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="44ff3cc0-15f3-41dc-95f0-a02ad50647b1">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># Construct a reference to the "sample_files" table</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>files_ref <span class="op">=</span> dataset_ref.table(<span class="st">"sample_files"</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>files_table <span class="op">=</span> client.get_table(files_ref)</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co"># Preview the first five lines of the "sample_files" table</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>client.list_rows(files_table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

  <div id="df-22f56145-b4ee-44f4-bdd1-fa3f106c3e5b">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">repo_name</th>
<th data-quarto-table-cell-role="th">ref</th>
<th data-quarto-table-cell-role="th">path</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">symlink_target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>EOL/eol</td>
<td>refs/heads/master</td>
<td>generate/vendor/railties</td>
<td>40960</td>
<td>0338c33fb3fda57db9e812ac7de969317cad4959</td>
<td>/usr/share/rails-ruby1.8/railties</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>np/ling</td>
<td>refs/heads/master</td>
<td>tests/success/merger_seq_inferred.t/merger_seq...</td>
<td>40960</td>
<td>dd4bb3d5ecabe5044d3fa5a36e0a9bf7ca878209</td>
<td>../../../fixtures/all/merger_seq_inferred.ll</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>np/ling</td>
<td>refs/heads/master</td>
<td>fixtures/sequence/lettype.ll</td>
<td>40960</td>
<td>8fdf536def2633116d65b92b3b9257bcf06e3e45</td>
<td>../all/lettype.ll</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>np/ling</td>
<td>refs/heads/master</td>
<td>fixtures/failure/wrong_order_seq3.ll</td>
<td>40960</td>
<td>c2509ae1196c4bb79d7e60a3d679488ca4a753e9</td>
<td>../all/wrong_order_seq3.ll</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>np/ling</td>
<td>refs/heads/master</td>
<td>issues/sequence/keep.t</td>
<td>40960</td>
<td>5721de3488fb32745dfc11ec482e5dd0331fecaf</td>
<td>../keep.t</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-22f56145-b4ee-44f4-bdd1-fa3f106c3e5b')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-22f56145-b4ee-44f4-bdd1-fa3f106c3e5b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-22f56145-b4ee-44f4-bdd1-fa3f106c3e5b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Next, we write a query that uses information in both tables to determine how many files are released in each license.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># Query to determine the number of files per license, sorted by number of files</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="st">        SELECT L.license, COUNT(1) AS number_of_files</span></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="st">        FROM `bigquery-public-data.github_repos.sample_files` AS sf</span></span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="st">        INNER JOIN `bigquery-public-data.github_repos.licenses` AS L </span></span>
<span id="cb47-6"><a href="#cb47-6"></a><span class="st">            ON sf.repo_name = L.repo_name</span></span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="st">        GROUP BY L.license</span></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="st">        ORDER BY number_of_files DESC</span></span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="st">        """</span></span>
<span id="cb47-10"><a href="#cb47-10"></a></span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="co"># Set up the query (cancel the query if it would use too much of </span></span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="co"># your quota, with the limit set to 10 GB)</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>safe_config <span class="op">=</span> bigquery.QueryJobConfig(maximum_bytes_billed<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">10</span>)</span>
<span id="cb47-14"><a href="#cb47-14"></a>query_job <span class="op">=</span> client.query(query, job_config<span class="op">=</span>safe_config)</span>
<span id="cb47-15"><a href="#cb47-15"></a></span>
<span id="cb47-16"><a href="#cb47-16"></a><span class="co"># API request - run the query, and convert the results to a pandas DataFrame</span></span>
<span id="cb47-17"><a href="#cb47-17"></a>file_count_by_license <span class="op">=</span> query_job.to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s a big query, and so we’ll investigate each piece separately.</p>
<p><img src="https://i.imgur.com/QeufD01.png" class="img-fluid"></p>
<p>We’ll begin with the <strong>JOIN</strong> (highlighted in blue above). This specifies the sources of data and how to join them. We use <strong>ON</strong> to specify that we combine the tables by matching the values in the <code>repo_name</code> columns in the tables.</p>
<p>Next, we’ll talk about <strong>SELECT</strong> and <strong>GROUP BY</strong> (highlighted in yellow). The <strong>GROUP BY</strong> breaks the data into a different group for each license, before we <strong>COUNT</strong> the number of rows in the <code>sample_files</code> table that corresponds to each license. (Remember that you can count the number of rows with <code>COUNT(1)</code>.)</p>
<p>Finally, the <strong>ORDER BY</strong> (highlighted in purple) sorts the results so that licenses with more files appear first.</p>
<p>It was a big query, but it gave us a nice table summarizing how many files have been committed under each license:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904985447,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="afee0fb3-3f66-4509-9e2e-35b69ceaef07">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># Print the DataFrame</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>file_count_by_license</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">

  <div id="df-5499ecef-d984-449c-852d-651da9cbe573">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">license</th>
<th data-quarto-table-cell-role="th">number_of_files</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>mit</td>
<td>20560894</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>gpl-2.0</td>
<td>16608922</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>apache-2.0</td>
<td>7201141</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>gpl-3.0</td>
<td>5107676</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>bsd-3-clause</td>
<td>3465437</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>agpl-3.0</td>
<td>1372100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>lgpl-2.1</td>
<td>799664</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>bsd-2-clause</td>
<td>692357</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>lgpl-3.0</td>
<td>582277</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>mpl-2.0</td>
<td>457000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>cc0-1.0</td>
<td>449149</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>epl-1.0</td>
<td>322255</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>unlicense</td>
<td>208602</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>artistic-2.0</td>
<td>147391</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>isc</td>
<td>118332</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5499ecef-d984-449c-852d-651da9cbe573')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5499ecef-d984-449c-852d-651da9cbe573 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5499ecef-d984-449c-852d-651da9cbe573');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>There are a few more types of JOIN, along with how to use UNIONs to pull information from multiple tables. We’ll work with the <a href="https://www.kaggle.com/hacker-news/hacker-news">Hacker News</a> dataset. We begin by reviewing the first several rows of the <code>comments</code> table.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:457,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904985901,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6ce34c40-23bf-4ee8-8ae0-024e54d06be6">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># Construct a reference to the "hacker_news" dataset</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"hacker_news"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb49-6"><a href="#cb49-6"></a></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="co"># Construct a reference to the "comments" table</span></span>
<span id="cb49-8"><a href="#cb49-8"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"comments"</span>)</span>
<span id="cb49-9"><a href="#cb49-9"></a></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb49-11"><a href="#cb49-11"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb49-12"><a href="#cb49-12"></a></span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="co"># Preview the first five lines of the table</span></span>
<span id="cb49-14"><a href="#cb49-14"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

  <div id="df-797c191c-3d70-43b0-92ba-ba2076521507">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">by</th>
<th data-quarto-table-cell-role="th">author</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">time_ts</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">parent</th>
<th data-quarto-table-cell-role="th">deleted</th>
<th data-quarto-table-cell-role="th">dead</th>
<th data-quarto-table-cell-role="th">ranking</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9734136</td>
<td>None</td>
<td>None</td>
<td>1434565400</td>
<td>2015-06-17 18:23:20+00:00</td>
<td>None</td>
<td>9733698</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4921158</td>
<td>None</td>
<td>None</td>
<td>1355496966</td>
<td>2012-12-14 14:56:06+00:00</td>
<td>None</td>
<td>4921100</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7500568</td>
<td>None</td>
<td>None</td>
<td>1396261158</td>
<td>2014-03-31 10:19:18+00:00</td>
<td>None</td>
<td>7499385</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>8909635</td>
<td>None</td>
<td>None</td>
<td>1421627275</td>
<td>2015-01-19 00:27:55+00:00</td>
<td>None</td>
<td>8901135</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>9256463</td>
<td>None</td>
<td>None</td>
<td>1427204705</td>
<td>2015-03-24 13:45:05+00:00</td>
<td>None</td>
<td>9256346</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-797c191c-3d70-43b0-92ba-ba2076521507')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-797c191c-3d70-43b0-92ba-ba2076521507 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-797c191c-3d70-43b0-92ba-ba2076521507');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:292,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904986190,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a59e6946-7647-464d-b9e7-db0082100e75">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># Construct a reference to the "stories" table</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"stories"</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a></span>
<span id="cb50-4"><a href="#cb50-4"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb50-6"><a href="#cb50-6"></a></span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="co"># Preview the first five lines of the table</span></span>
<span id="cb50-8"><a href="#cb50-8"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">

  <div id="df-08455135-feb5-4767-a695-83f24a1863f7">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">by</th>
<th data-quarto-table-cell-role="th">score</th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">time_ts</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">deleted</th>
<th data-quarto-table-cell-role="th">dead</th>
<th data-quarto-table-cell-role="th">descendants</th>
<th data-quarto-table-cell-role="th">author</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6988445</td>
<td>cflick</td>
<td>0</td>
<td>1388454902</td>
<td>2013-12-31 01:55:02+00:00</td>
<td>Appshare</td>
<td>http://chadflick.ws/appshare.html</td>
<td>Did facebook or angrybirds pay you? We will!</td>
<td>&lt;NA&gt;</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>cflick</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7047571</td>
<td>Rd2</td>
<td>1</td>
<td>1389562985</td>
<td>2014-01-12 21:43:05+00:00</td>
<td>Java in startups</td>
<td></td>
<td>Hello, hacker news!&lt;p&gt;Have any of you used jav...</td>
<td>&lt;NA&gt;</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>Rd2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>9157712</td>
<td>mo0</td>
<td>1</td>
<td>1425657937</td>
<td>2015-03-06 16:05:37+00:00</td>
<td>Show HN: Discover what songs were used in YouT...</td>
<td>http://www.mooma.sh/</td>
<td>The user can paste a media url(currently only ...</td>
<td>&lt;NA&gt;</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>mo0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>8127403</td>
<td>ad11</td>
<td>1</td>
<td>1407052667</td>
<td>2014-08-03 07:57:47+00:00</td>
<td>My poker project, what do you think?</td>
<td></td>
<td>Hi guys, what do you think about my poker proj...</td>
<td>&lt;NA&gt;</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>ad11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6933158</td>
<td>emyy</td>
<td>1</td>
<td>1387432701</td>
<td>2013-12-19 05:58:21+00:00</td>
<td>Christmas Crafts Ideas - Easy and Simple Famil...</td>
<td>http://www.winxdvd.com/resource/christmas-craf...</td>
<td>There are some free Christmas craft ideas to m...</td>
<td>&lt;NA&gt;</td>
<td>True</td>
<td>&lt;NA&gt;</td>
<td>emyy</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-08455135-feb5-4767-a695-83f24a1863f7')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-08455135-feb5-4767-a695-83f24a1863f7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-08455135-feb5-4767-a695-83f24a1863f7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The query below pulls information from the <code>stories</code> and <code>comments</code> tables to create a table showing all stories posted on January 1, 2012, along with the corresponding number of comments. We use a <strong>LEFT JOIN</strong> so that the results include stories that didn’t receive any comments.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6065,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904992253,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="81460959-194f-48d3-cb84-845cd93db4c0">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Query to select all stories posted on January 1, 2012, with number of comments</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>join_query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="st">             WITH c AS</span></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="st">             (</span></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="st">             SELECT parent, COUNT(*) as num_comments</span></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="st">             FROM `bigquery-public-data.hacker_news.comments` </span></span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="st">             GROUP BY parent</span></span>
<span id="cb51-8"><a href="#cb51-8"></a><span class="st">             )</span></span>
<span id="cb51-9"><a href="#cb51-9"></a><span class="st">             SELECT s.id as story_id, s.by, s.title, c.num_comments</span></span>
<span id="cb51-10"><a href="#cb51-10"></a><span class="st">             FROM `bigquery-public-data.hacker_news.stories` AS s</span></span>
<span id="cb51-11"><a href="#cb51-11"></a><span class="st">             LEFT JOIN c</span></span>
<span id="cb51-12"><a href="#cb51-12"></a><span class="st">             ON s.id = c.parent</span></span>
<span id="cb51-13"><a href="#cb51-13"></a><span class="st">             WHERE EXTRACT(DATE FROM s.time_ts) = '2012-01-01'</span></span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="st">             ORDER BY c.num_comments DESC</span></span>
<span id="cb51-15"><a href="#cb51-15"></a><span class="st">             """</span></span>
<span id="cb51-16"><a href="#cb51-16"></a></span>
<span id="cb51-17"><a href="#cb51-17"></a><span class="co"># Run the query, and return a pandas DataFrame</span></span>
<span id="cb51-18"><a href="#cb51-18"></a>join_result <span class="op">=</span> client.query(join_query).result().to_dataframe()</span>
<span id="cb51-19"><a href="#cb51-19"></a>join_result.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

  <div id="df-ec9d878c-98c4-49da-a91d-1acae017914d">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">story_id</th>
<th data-quarto-table-cell-role="th">by</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">num_comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3412900</td>
<td>whoishiring</td>
<td>Ask HN: Who is Hiring? (January 2012)</td>
<td>154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3412901</td>
<td>whoishiring</td>
<td>Ask HN: Freelancer? Seeking freelancer? (Janua...</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3412643</td>
<td>jemeshsu</td>
<td>Avoid Apress</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3412891</td>
<td>Brajeshwar</td>
<td>There's no shame in code that is simply "good ...</td>
<td>27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3414012</td>
<td>ramanujam</td>
<td>Impress.js - a Prezi like implementation using...</td>
<td>27</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ec9d878c-98c4-49da-a91d-1acae017914d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ec9d878c-98c4-49da-a91d-1acae017914d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ec9d878c-98c4-49da-a91d-1acae017914d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Since the results are ordered by the <code>num_comments</code> column, stories without comments appear at the end of the DataFrame. (Remember that <strong>NaN</strong> stands for “not a number”.)</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904992253,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="99740a56-7760-435d-c710-604d6f64ff3c">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># None of these stories received any comments</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>join_result.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

  <div id="df-949eecda-10bd-4506-8e4d-c3a5df391c1a">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">story_id</th>
<th data-quarto-table-cell-role="th">by</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">num_comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">439</td>
<td>3413342</td>
<td>jonsteiman</td>
<td>The List You Can't Miss: Top 5 Blogs of 2011</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">440</td>
<td>3412327</td>
<td>arroyo</td>
<td>Can your business card be followed?</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">441</td>
<td>3413203</td>
<td>norris_tony44</td>
<td>10 Popular iPhone Games you Must Play</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">442</td>
<td>3412940</td>
<td>julelara</td>
<td>Washington Redskins vs Philadelphia Eagles liv...</td>
<td>&lt;NA&gt;</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">443</td>
<td>3412632</td>
<td>UsedCarFleetCom</td>
<td>Used Car fleet</td>
<td>&lt;NA&gt;</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-949eecda-10bd-4506-8e4d-c3a5df391c1a')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-949eecda-10bd-4506-8e4d-c3a5df391c1a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-949eecda-10bd-4506-8e4d-c3a5df391c1a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>As you’ve seen, JOINs horizontally combine results from different tables. If you instead would like to vertically concatenate columns, you can do so with a <code>UNION</code>.</p>
<p>Next, we write a query to select all usernames corresponding to users who wrote stories or comments on January 1, 2014. We use <strong>UNION DISTINCT</strong> (instead of <strong>UNION ALL</strong>) to ensure that each user appears in the table at most once.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2947,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904995197,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a5e8c04e-f14d-4861-8fb5-fa66ba171313">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Query to select all users who posted stories or comments on January 1, 2014</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>union_query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="st">              SELECT c.by</span></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="st">              FROM `bigquery-public-data.hacker_news.comments` AS c</span></span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="st">              WHERE EXTRACT(DATE FROM c.time_ts) = '2014-01-01'</span></span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="st">              UNION DISTINCT</span></span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="st">              SELECT s.by</span></span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="st">              FROM `bigquery-public-data.hacker_news.stories` AS s</span></span>
<span id="cb53-9"><a href="#cb53-9"></a><span class="st">              WHERE EXTRACT(DATE FROM s.time_ts) = '2014-01-01'</span></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="st">              """</span></span>
<span id="cb53-11"><a href="#cb53-11"></a></span>
<span id="cb53-12"><a href="#cb53-12"></a><span class="co"># Run the query, and return a pandas DataFrame</span></span>
<span id="cb53-13"><a href="#cb53-13"></a>union_result <span class="op">=</span> client.query(union_query).result().to_dataframe()</span>
<span id="cb53-14"><a href="#cb53-14"></a>union_result.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

  <div id="df-bdf3cbf9-68f3-48c4-874b-fd44d872be77">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">by</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>vidarh</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>tlarkworthy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>jbl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>dmgrow</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>maurorm</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bdf3cbf9-68f3-48c4-874b-fd44d872be77')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bdf3cbf9-68f3-48c4-874b-fd44d872be77 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bdf3cbf9-68f3-48c4-874b-fd44d872be77');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>To get the number of users who posted on January 1, 2014, we need only take the length of the DataFrame.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677904995197,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a37e1355-28aa-4e72-bbbc-3c1053690f0f">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># Number of users who posted stories or comments on January 1, 2014</span></span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="bu">len</span>(union_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>2282</code></pre>
</div>
</div>
</section>
<section id="nested-and-repeated-data" class="level3" data-number="3.1.10">
<h3 data-number="3.1.10" class="anchored" data-anchor-id="nested-and-repeated-data"><span class="header-section-number">3.1.10</span> Nested and Repeated data</h3>
<p>So far, you’ve worked with many types of data, including numeric types (integers, floating point values), strings, and the DATETIME type. In this tutorial, you’ll learn how to query nested and repeated data. These are the most complex data types that you can find in BigQuery datasets!</p>
<p>We’ll work with the Google Analytics Sample dataset. It contains information tracking the behavior of visitors to the Google Merchandise store, an e-commerce website that sells Google branded items.</p>
<p>We begin by printing the first few rows of the <code>ga_sessions_20170801</code> table. This table tracks visits to the website on August 1, 2017. The table has many nested fields from table preview:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:809,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905005497,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0ab1773b-e1f4-4238-ee23-a8a9b07745f5">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Construct a reference to the "google_analytics_sample" dataset</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"google_analytics_sample"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co"># Construct a reference to the "ga_sessions_20170801" table</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"ga_sessions_20170801"</span>)</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb56-8"><a href="#cb56-8"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb56-9"><a href="#cb56-9"></a></span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="co"># Preview the first five lines of the table</span></span>
<span id="cb56-11"><a href="#cb56-11"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

  <div id="df-7cc5b604-e790-45dd-ad22-50796c10062e">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">visitorId</th>
<th data-quarto-table-cell-role="th">visitNumber</th>
<th data-quarto-table-cell-role="th">visitId</th>
<th data-quarto-table-cell-role="th">visitStartTime</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">totals</th>
<th data-quarto-table-cell-role="th">trafficSource</th>
<th data-quarto-table-cell-role="th">device</th>
<th data-quarto-table-cell-role="th">geoNetwork</th>
<th data-quarto-table-cell-role="th">customDimensions</th>
<th data-quarto-table-cell-role="th">hits</th>
<th data-quarto-table-cell-role="th">fullVisitorId</th>
<th data-quarto-table-cell-role="th">userId</th>
<th data-quarto-table-cell-role="th">clientId</th>
<th data-quarto-table-cell-role="th">channelGrouping</th>
<th data-quarto-table-cell-role="th">socialEngagementType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>&lt;NA&gt;</td>
<td>1</td>
<td>1501591568</td>
<td>1501591568</td>
<td>20170801</td>
<td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
<td>{'referralPath': None, 'campaign': '(not set)'...</td>
<td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
<td>{'continent': 'Europe', 'subContinent': 'South...</td>
<td>[]</td>
<td>[{'hitNumber': 1, 'time': 0, 'hour': 5, 'minut...</td>
<td>3418334011779872055</td>
<td>None</td>
<td>None</td>
<td>Organic Search</td>
<td>Not Socially Engaged</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>&lt;NA&gt;</td>
<td>2</td>
<td>1501589647</td>
<td>1501589647</td>
<td>20170801</td>
<td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
<td>{'referralPath': '/analytics/web/', 'campaign'...</td>
<td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
<td>{'continent': 'Asia', 'subContinent': 'Souther...</td>
<td>[{'index': 4, 'value': 'APAC'}]</td>
<td>[{'hitNumber': 1, 'time': 0, 'hour': 5, 'minut...</td>
<td>2474397855041322408</td>
<td>None</td>
<td>None</td>
<td>Referral</td>
<td>Not Socially Engaged</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>&lt;NA&gt;</td>
<td>1</td>
<td>1501616621</td>
<td>1501616621</td>
<td>20170801</td>
<td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
<td>{'referralPath': '/analytics/web/', 'campaign'...</td>
<td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
<td>{'continent': 'Europe', 'subContinent': 'North...</td>
<td>[{'index': 4, 'value': 'EMEA'}]</td>
<td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
<td>5870462820713110108</td>
<td>None</td>
<td>None</td>
<td>Referral</td>
<td>Not Socially Engaged</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>&lt;NA&gt;</td>
<td>1</td>
<td>1501601200</td>
<td>1501601200</td>
<td>20170801</td>
<td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
<td>{'referralPath': '/analytics/web/', 'campaign'...</td>
<td>{'browser': 'Firefox', 'browserVersion': 'not ...</td>
<td>{'continent': 'Americas', 'subContinent': 'Nor...</td>
<td>[{'index': 4, 'value': 'North America'}]</td>
<td>[{'hitNumber': 1, 'time': 0, 'hour': 8, 'minut...</td>
<td>9397809171349480379</td>
<td>None</td>
<td>None</td>
<td>Referral</td>
<td>Not Socially Engaged</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>&lt;NA&gt;</td>
<td>1</td>
<td>1501615525</td>
<td>1501615525</td>
<td>20170801</td>
<td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
<td>{'referralPath': '/analytics/web/', 'campaign'...</td>
<td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
<td>{'continent': 'Americas', 'subContinent': 'Nor...</td>
<td>[{'index': 4, 'value': 'North America'}]</td>
<td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
<td>6089902943184578335</td>
<td>None</td>
<td>None</td>
<td>Referral</td>
<td>Not Socially Engaged</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7cc5b604-e790-45dd-ad22-50796c10062e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7cc5b604-e790-45dd-ad22-50796c10062e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7cc5b604-e790-45dd-ad22-50796c10062e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Now we’ll work with the <code>hits</code> column as an example of data that is both nested and repeated. Since:</p>
<ul>
<li><code>hits</code> is a STRUCT (contains nested data) and is repeated,</li>
<li><code>hitNumber</code>, <code>page</code>, and <code>type</code> are all nested inside the <code>hits</code> column, and</li>
<li><code>pagePath</code> is nested inside the <code>page</code> field,</li>
</ul>
<p>we can query these fields with the following syntax:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2924,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905010813,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4589e6aa-fd97-44f8-9c5b-e53c9be75907">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># Query to determine most popular landing point on the website</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="st">        SELECT hits.page.pagePath as path,</span></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="st">            COUNT(hits.page.pagePath) as counts</span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="st">        FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`, </span></span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="st">            UNNEST(hits) as hits</span></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="st">        WHERE hits.type="PAGE" and hits.hitNumber=1</span></span>
<span id="cb57-8"><a href="#cb57-8"></a><span class="st">        GROUP BY path</span></span>
<span id="cb57-9"><a href="#cb57-9"></a><span class="st">        ORDER BY counts DESC</span></span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="st">        """</span></span>
<span id="cb57-11"><a href="#cb57-11"></a></span>
<span id="cb57-12"><a href="#cb57-12"></a><span class="co"># Run the query, and return a pandas DataFrame</span></span>
<span id="cb57-13"><a href="#cb57-13"></a>result <span class="op">=</span> client.query(query).result().to_dataframe()</span>
<span id="cb57-14"><a href="#cb57-14"></a>result.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

  <div id="df-52dd7cae-3376-415e-96c6-dbf91a37fbb8">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">path</th>
<th data-quarto-table-cell-role="th">counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>/home</td>
<td>1257</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>/google+redesign/shop+by+brand/youtube</td>
<td>587</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>/google+redesign/apparel/mens/mens+t+shirts</td>
<td>117</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>/signin.html</td>
<td>78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>/basket.html</td>
<td>35</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-52dd7cae-3376-415e-96c6-dbf91a37fbb8')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-52dd7cae-3376-415e-96c6-dbf91a37fbb8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-52dd7cae-3376-415e-96c6-dbf91a37fbb8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="analytic-function-optional" class="level3" data-number="3.1.11">
<h3 data-number="3.1.11" class="anchored" data-anchor-id="analytic-function-optional"><span class="header-section-number">3.1.11</span> Analytic Function (Optional)</h3>
<p>You can also define analytic functions, which also operate on a set of rows like aggregation function. However, unlike aggregate functions, analytic functions return a (potentially different) value for each row in the original table. Analytic functions allow us to perform complex calculations with relatively straightforward syntax. For instance, we can quickly calculate moving averages and running totals, among other quantities.</p>
<p>We’ll work with the <a href="https://www.kaggle.com/datasf/san-francisco">San Francisco Open Data</a> dataset.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:769,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905142622,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0ab883e6-7f19-4626-e63e-e9d161737f10">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># Construct a reference to the "san_francisco" dataset</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>dataset_ref <span class="op">=</span> client.dataset(<span class="st">"san_francisco"</span>, project<span class="op">=</span><span class="st">"bigquery-public-data"</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="co"># API request - fetch the dataset</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>dataset <span class="op">=</span> client.get_dataset(dataset_ref)</span>
<span id="cb58-6"><a href="#cb58-6"></a></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="co"># Construct a reference to the "bikeshare_trips" table</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>table_ref <span class="op">=</span> dataset_ref.table(<span class="st">"bikeshare_trips"</span>)</span>
<span id="cb58-9"><a href="#cb58-9"></a></span>
<span id="cb58-10"><a href="#cb58-10"></a><span class="co"># API request - fetch the table</span></span>
<span id="cb58-11"><a href="#cb58-11"></a>table <span class="op">=</span> client.get_table(table_ref)</span>
<span id="cb58-12"><a href="#cb58-12"></a></span>
<span id="cb58-13"><a href="#cb58-13"></a><span class="co"># Preview the first five lines of the table</span></span>
<span id="cb58-14"><a href="#cb58-14"></a>client.list_rows(table, max_results<span class="op">=</span><span class="dv">5</span>).to_dataframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">

  <div id="df-48ccaf1a-0d12-4b18-b35c-e730180c2be8">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">trip_id</th>
<th data-quarto-table-cell-role="th">duration_sec</th>
<th data-quarto-table-cell-role="th">start_date</th>
<th data-quarto-table-cell-role="th">start_station_name</th>
<th data-quarto-table-cell-role="th">start_station_id</th>
<th data-quarto-table-cell-role="th">end_date</th>
<th data-quarto-table-cell-role="th">end_station_name</th>
<th data-quarto-table-cell-role="th">end_station_id</th>
<th data-quarto-table-cell-role="th">bike_number</th>
<th data-quarto-table-cell-role="th">zip_code</th>
<th data-quarto-table-cell-role="th">subscriber_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1235850</td>
<td>1540</td>
<td>2016-06-11 08:19:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>2016-06-11 08:45:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>124</td>
<td>15206</td>
<td>Customer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1219337</td>
<td>6324</td>
<td>2016-05-29 12:49:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>2016-05-29 14:34:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>174</td>
<td>55416</td>
<td>Customer</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>793762</td>
<td>115572</td>
<td>2015-06-04 09:22:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>2015-06-05 17:28:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>190</td>
<td>95391</td>
<td>Customer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>453845</td>
<td>54120</td>
<td>2014-09-15 16:53:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>2014-09-16 07:55:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>127</td>
<td>81</td>
<td>Customer</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1245113</td>
<td>5018</td>
<td>2016-06-17 20:08:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>2016-06-17 21:32:00+00:00</td>
<td>San Jose Diridon Caltrain Station</td>
<td>2</td>
<td>153</td>
<td>95070</td>
<td>Customer</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-48ccaf1a-0d12-4b18-b35c-e730180c2be8')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-48ccaf1a-0d12-4b18-b35c-e730180c2be8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-48ccaf1a-0d12-4b18-b35c-e730180c2be8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Each row of the table corresponds to a different bike trip, and we can use an analytic function to <strong>calculate the cumulative number of trips for each date in 2015.</strong></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4330,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905148241,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="854c92df-a3cf-4770-c5f4-2a710159ae73">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Query to count the (cumulative) number of trips per day</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>num_trips_query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="st">                  WITH trips_by_day AS</span></span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="st">                  (</span></span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="st">                  SELECT DATE(start_date) AS trip_date,</span></span>
<span id="cb59-6"><a href="#cb59-6"></a><span class="st">                      COUNT(*) as num_trips</span></span>
<span id="cb59-7"><a href="#cb59-7"></a><span class="st">                  FROM `bigquery-public-data.san_francisco.bikeshare_trips`</span></span>
<span id="cb59-8"><a href="#cb59-8"></a><span class="st">                  WHERE EXTRACT(YEAR FROM start_date) = 2015</span></span>
<span id="cb59-9"><a href="#cb59-9"></a><span class="st">                  GROUP BY trip_date</span></span>
<span id="cb59-10"><a href="#cb59-10"></a><span class="st">                  )</span></span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="st">                  SELECT *,</span></span>
<span id="cb59-12"><a href="#cb59-12"></a><span class="st">                      SUM(num_trips) </span></span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="st">                          OVER (</span></span>
<span id="cb59-14"><a href="#cb59-14"></a><span class="st">                               ORDER BY trip_date</span></span>
<span id="cb59-15"><a href="#cb59-15"></a><span class="st">                               ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</span></span>
<span id="cb59-16"><a href="#cb59-16"></a><span class="st">                               ) AS cumulative_trips</span></span>
<span id="cb59-17"><a href="#cb59-17"></a><span class="st">                  FROM trips_by_day</span></span>
<span id="cb59-18"><a href="#cb59-18"></a><span class="st">                  """</span></span>
<span id="cb59-19"><a href="#cb59-19"></a></span>
<span id="cb59-20"><a href="#cb59-20"></a><span class="co"># Run the query, and return a pandas DataFrame</span></span>
<span id="cb59-21"><a href="#cb59-21"></a>num_trips_result <span class="op">=</span> client.query(num_trips_query).result().to_dataframe()</span>
<span id="cb59-22"><a href="#cb59-22"></a>num_trips_result.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

  <div id="df-01822dfe-c121-4eb1-9ad2-4f81718d7a67">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">trip_date</th>
<th data-quarto-table-cell-role="th">num_trips</th>
<th data-quarto-table-cell-role="th">cumulative_trips</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2015-01-13</td>
<td>1368</td>
<td>10709</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2015-04-06</td>
<td>1281</td>
<td>91635</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2015-04-25</td>
<td>405</td>
<td>111722</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2015-06-18</td>
<td>1352</td>
<td>166602</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2015-07-14</td>
<td>1358</td>
<td>192161</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-01822dfe-c121-4eb1-9ad2-4f81718d7a67')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-01822dfe-c121-4eb1-9ad2-4f81718d7a67 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-01822dfe-c121-4eb1-9ad2-4f81718d7a67');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The query uses a <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#with_clause">common table expression (CTE)</a> to first calculate the daily number of trips. Then, we use <strong>SUM()</strong> as an aggregate function. - Since there is no <strong>PARTITION BY</strong> clause, the entire table is treated as a single partition. - The <strong>ORDER BY</strong> clause orders the rows by date, where earlier dates appear first. - By setting the <strong>window frame</strong> clause to <code>ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>, we ensure that all rows up to and including the current date are used to calculate the (cumulative) sum. See https://cloud.google.com/bigquery/docs/reference/standard-sql/analytic-function-concepts#def_window_frame for more details.</p>
<p>The next query <strong>tracks the stations where each bike began (in <code>start_station_id</code>) and ended (in <code>end_station_id</code>) the day on October 25, 2015.</strong></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4186,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905155783,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="7eb8b339-b399-4a8e-8ec6-725301140127">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Query to track beginning and ending stations on October 25, 2015, for each bike</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>start_end_query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="st">                  SELECT bike_number,</span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="st">                      TIME(start_date) AS trip_time,</span></span>
<span id="cb60-5"><a href="#cb60-5"></a><span class="st">                      FIRST_VALUE(start_station_id)</span></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="st">                          OVER (</span></span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="st">                               PARTITION BY bike_number</span></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="st">                               ORDER BY start_date</span></span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="st">                               ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</span></span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="st">                               ) AS first_station_id,</span></span>
<span id="cb60-11"><a href="#cb60-11"></a><span class="st">                      LAST_VALUE(end_station_id)</span></span>
<span id="cb60-12"><a href="#cb60-12"></a><span class="st">                          OVER (</span></span>
<span id="cb60-13"><a href="#cb60-13"></a><span class="st">                               PARTITION BY bike_number</span></span>
<span id="cb60-14"><a href="#cb60-14"></a><span class="st">                               ORDER BY start_date</span></span>
<span id="cb60-15"><a href="#cb60-15"></a><span class="st">                               ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</span></span>
<span id="cb60-16"><a href="#cb60-16"></a><span class="st">                               ) AS last_station_id,</span></span>
<span id="cb60-17"><a href="#cb60-17"></a><span class="st">                      start_station_id,</span></span>
<span id="cb60-18"><a href="#cb60-18"></a><span class="st">                      end_station_id</span></span>
<span id="cb60-19"><a href="#cb60-19"></a><span class="st">                  FROM `bigquery-public-data.san_francisco.bikeshare_trips`</span></span>
<span id="cb60-20"><a href="#cb60-20"></a><span class="st">                  WHERE DATE(start_date) = '2015-10-25' </span></span>
<span id="cb60-21"><a href="#cb60-21"></a><span class="st">                  """</span></span>
<span id="cb60-22"><a href="#cb60-22"></a></span>
<span id="cb60-23"><a href="#cb60-23"></a><span class="co"># Run the query, and return a pandas DataFrame</span></span>
<span id="cb60-24"><a href="#cb60-24"></a>start_end_result <span class="op">=</span> client.query(start_end_query).result().to_dataframe()</span>
<span id="cb60-25"><a href="#cb60-25"></a>start_end_result.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

  <div id="df-c205929d-c797-4058-86b5-e87437f7d90d">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">bike_number</th>
<th data-quarto-table-cell-role="th">trip_time</th>
<th data-quarto-table-cell-role="th">first_station_id</th>
<th data-quarto-table-cell-role="th">last_station_id</th>
<th data-quarto-table-cell-role="th">start_station_id</th>
<th data-quarto-table-cell-role="th">end_station_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>230</td>
<td>22:41:00</td>
<td>22</td>
<td>22</td>
<td>22</td>
<td>22</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>601</td>
<td>15:50:00</td>
<td>68</td>
<td>67</td>
<td>68</td>
<td>50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>601</td>
<td>23:27:00</td>
<td>68</td>
<td>67</td>
<td>50</td>
<td>67</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>604</td>
<td>08:56:00</td>
<td>70</td>
<td>66</td>
<td>70</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>604</td>
<td>12:34:00</td>
<td>70</td>
<td>66</td>
<td>39</td>
<td>67</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c205929d-c797-4058-86b5-e87437f7d90d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c205929d-c797-4058-86b5-e87437f7d90d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c205929d-c797-4058-86b5-e87437f7d90d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The query uses both <strong>FIRST_VALUE()</strong> and <strong>LAST_VALUE()</strong> as analytic functions. - The <strong>PARTITION BY</strong> clause breaks the data into partitions based on the <code>bike_number</code> column. Since this column holds unique identifiers for the bikes, this ensures the calculations are performed separately for each bike. - The <strong>ORDER BY</strong> clause puts the rows within each partition in chronological order. - Since the <strong>window frame</strong> clause is <code>ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING</code>, for each row, its entire partition is used to perform the calculation. (<em>This ensures the calculated values for rows in the same partition are identical.</em>)</p>
<p>You can check https://cloud.google.com/bigquery/docs/reference/standard-sql/introduction and https://googleapis.dev/python/bigquery/latest/index.html for more details.</p>
</section>
</section>
<section id="data-wrangling-with-pandas" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="data-wrangling-with-pandas"><span class="header-section-number">3.2</span> Data Wrangling with Pandas</h2>
<section id="series-objects" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="series-objects"><span class="header-section-number">3.2.1</span> <code>Series</code> objects</h3>
<p>The <code>Pandas</code> library contains these useful data structures: * <code>Series</code> objects, that we will discuss now. A <code>Series</code> object is 1D array, similar to a column in a spreadsheet (with a column name and row labels). * <code>DataFrame</code> objects. This is a 2D table, similar to a spreadsheet (with column names and row labels).</p>
<section id="creating-a-series" class="level4" data-number="3.2.1.1">
<h4 data-number="3.2.1.1" class="anchored" data-anchor-id="creating-a-series"><span class="header-section-number">3.2.1.1</span> Creating a <code>Series</code></h4>
<p>Let’s start by creating our first <code>Series</code> object!</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:313,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905179704,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="066f5c2f-7b91-4805-bdd3-4efbd3a8712c">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb61-2"><a href="#cb61-2"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>0    2
1   -1
2    3
3    5
dtype: int64</code></pre>
</div>
</div>
<p>Arithmetic operations on <code>Series</code> are also possible, and they apply <em>elementwise</em>, just like for <code>ndarray</code>s in NumPy:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:301,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905183363,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="24a64a15-58d9-47d2-a4aa-58a6cbd625a7">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>s <span class="op">+</span> [<span class="dv">1000</span>,<span class="dv">2000</span>,<span class="dv">3000</span>,<span class="dv">4000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0    1002
1    1999
2    3003
3    4005
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:295,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380049273,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9fc0dc18-d336-4e04-9664-902864c5c456">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>s <span class="op">+</span> <span class="dv">1000</span> <span class="co"># Broadcasting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>0    1002
1     999
2    1003
3    1005
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="index-labels" class="level4" data-number="3.2.1.2">
<h4 data-number="3.2.1.2" class="anchored" data-anchor-id="index-labels"><span class="header-section-number">3.2.1.2</span> Index labels</h4>
<p>Each item in a <code>Series</code> object has a unique identifier called the <em>index label</em>. By default, it is simply the rank of the item in the <code>Series</code> (starting at <code>0</code>) but you can also set the index labels manually:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:269,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905203549,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8e5a154a-5a2c-4956-a670-4b204f92da32">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>s2 <span class="op">=</span> pd.Series([<span class="dv">68</span>, <span class="dv">83</span>, <span class="dv">112</span>, <span class="dv">68</span>], index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>, <span class="st">"darwin"</span>])</span>
<span id="cb67-2"><a href="#cb67-2"></a>s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>alice       68
bob         83
charles    112
darwin      68
dtype: int64</code></pre>
</div>
</div>
<p>You can then use the <code>Series</code> just like a <code>dict</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:281,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905210229,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3adf8fa3-028b-402a-aa9f-6c55e56c1120">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>s2[<span class="st">"bob"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>83</code></pre>
</div>
</div>
<p>You can still access the items by integer location, like in a regular array:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905214184,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2637cebc-e32b-4621-c6f8-92e101599205">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>s2[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>83</code></pre>
</div>
</div>
<p>To make it clear when you are accessing, <strong>it is recommended to always use the <code>loc</code> attribute when accessing by label, and the <code>iloc</code> attribute when accessing by integer location</strong>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:304,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905219801,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="cf8ec0dc-c6fd-4156-8a68-cf32a17c3a5c">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>s2.loc[<span class="st">"bob"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>83</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905220221,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="09be2422-436b-4815-a22a-2fbd212f6718">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>s2.iloc[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>83</code></pre>
</div>
</div>
<p>Slicing a <code>Series</code> also slices the index labels:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:306,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905222079,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="74106f73-afe9-48da-fdae-fe414020a090">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>s2.iloc[<span class="dv">1</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>bob         83
charles    112
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="initialize-from-dict" class="level4" data-number="3.2.1.3">
<h4 data-number="3.2.1.3" class="anchored" data-anchor-id="initialize-from-dict"><span class="header-section-number">3.2.1.3</span> Initialize from <code>dict</code></h4>
<p>You can create a <code>Series</code> object from a <code>dict</code>. The keys will be used as index labels:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:417,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905239401,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0ec86122-fb72-4d28-a5fe-91224cf2286b">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>weights <span class="op">=</span> {<span class="st">"alice"</span>: <span class="dv">68</span>, <span class="st">"bob"</span>: <span class="dv">83</span>, <span class="st">"colin"</span>: <span class="dv">86</span>, <span class="st">"darwin"</span>: <span class="dv">68</span>}</span>
<span id="cb79-2"><a href="#cb79-2"></a>s3 <span class="op">=</span> pd.Series(weights)</span>
<span id="cb79-3"><a href="#cb79-3"></a>s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>alice     68
bob       83
colin     86
darwin    68
dtype: int64</code></pre>
</div>
</div>
<p>When an operation involves multiple <code>Series</code> objects, <code>pandas</code> automatically aligns items by matching index labels.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677905239848,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b2f0de77-465e-4227-a66e-db29a96c99a3">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a><span class="bu">print</span>(s2.keys())</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="bu">print</span>(s3.keys())</span>
<span id="cb81-3"><a href="#cb81-3"></a></span>
<span id="cb81-4"><a href="#cb81-4"></a>s2 <span class="op">+</span> s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['alice', 'bob', 'charles', 'darwin'], dtype='object')
Index(['alice', 'bob', 'colin', 'darwin'], dtype='object')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>alice      136.0
bob        166.0
charles      NaN
colin        NaN
darwin     136.0
dtype: float64</code></pre>
</div>
</div>
<p>The resulting <code>Series</code> contains the union of index labels from <code>s2</code> and <code>s3</code>. Since <code>"colin"</code> is missing from <code>s2</code> and <code>"charles"</code> is missing from <code>s3</code>, these items have a <code>NaN</code> result value. (ie. Not-a-Number means <em>missing</em>).</p>
<p>Automatic alignment is very handy when working with data that may come from various sources with varying structure and missing items</p>
</section>
<section id="initialize-with-a-scalar" class="level4" data-number="3.2.1.4">
<h4 data-number="3.2.1.4" class="anchored" data-anchor-id="initialize-with-a-scalar"><span class="header-section-number">3.2.1.4</span> Initialize with a scalar</h4>
<p>You can also initialize a <code>Series</code> object using a scalar and a list of index labels: all items will be set to the scalar.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:281,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380232112,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="70b47999-f01f-42a2-c5ac-cc6ba0eb688d">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>meaning <span class="op">=</span> pd.Series(<span class="dv">42</span>, [<span class="st">"life"</span>, <span class="st">"universe"</span>, <span class="st">"everything"</span>])</span>
<span id="cb84-2"><a href="#cb84-2"></a>meaning</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>life          42
universe      42
everything    42
dtype: int64</code></pre>
</div>
</div>
<p>Pandas makes it easy to plot <code>Series</code> data using matplotlib:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:905,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380275026,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ec870a9a-7edd-4269-f7b6-e9b82da56ad8" data-scrolled="true">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>temperatures <span class="op">=</span> [<span class="fl">4.4</span>,<span class="fl">5.1</span>,<span class="fl">6.1</span>,<span class="fl">6.2</span>,<span class="fl">6.1</span>,<span class="fl">6.1</span>,<span class="fl">5.7</span>,<span class="fl">5.2</span>,<span class="fl">4.7</span>,<span class="fl">4.1</span>,<span class="fl">3.9</span>,<span class="fl">3.5</span>]</span>
<span id="cb86-2"><a href="#cb86-2"></a>s4 <span class="op">=</span> pd.Series(temperatures, name<span class="op">=</span><span class="st">"Temperature"</span>)</span>
<span id="cb86-3"><a href="#cb86-3"></a>s4.plot()</span>
<span id="cb86-4"><a href="#cb86-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="03_Relational_Database_and_data_wrangling_files/figure-html/cell-65-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>You can easily convert it to NumPy array by dicarding the index.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:282,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380287463,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8977fff5-2546-4a2c-c6b9-68c3cb951801">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1"></a>s4.to_numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([4.4, 5.1, 6.1, 6.2, 6.1, 6.1, 5.7, 5.2, 4.7, 4.1, 3.9, 3.5])</code></pre>
</div>
</div>
<p>There are <em>many</em> options for plotting your data. It is not necessary to list them all here: if you need a particular type of plot (histograms, pie charts, etc.), just look for it in the excellent <a href="http://pandas.pydata.org/pandas-docs/stable/visualization.html">Visualization</a> section of pandas’ documentation, and look at the example code.</p>
</section>
</section>
<section id="handling-time" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="handling-time"><span class="header-section-number">3.2.2</span> Handling time</h3>
<p>Many datasets have timestamps, and pandas is awesome at manipulating such data: * it can represent periods (such as 2016Q3) and frequencies (such as “monthly”) * it can convert periods to actual timestamps, and <em>vice versa</em> * it can resample data and aggregate values any way you like * it can handle timezones.</p>
<section id="time-range" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="time-range"><span class="header-section-number">3.2.2.1</span> Time range</h4>
<p>Let’s start by creating a time series using <code>pd.date_range()</code>. This returns a <code>DatetimeIndex</code> containing one datetime per hour for 12 hours starting on March 6th 2023 at 5:30pm.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:287,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380416195,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a991f954-d881-4056-9d55-3dff47422939">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a>dates <span class="op">=</span> pd.date_range(<span class="st">'2023/03/06 5:30pm'</span>, periods<span class="op">=</span><span class="dv">12</span>, freq<span class="op">=</span><span class="st">'H'</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a>dates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>DatetimeIndex(['2023-03-06 17:30:00', '2023-03-06 18:30:00',
               '2023-03-06 19:30:00', '2023-03-06 20:30:00',
               '2023-03-06 21:30:00', '2023-03-06 22:30:00',
               '2023-03-06 23:30:00', '2023-03-07 00:30:00',
               '2023-03-07 01:30:00', '2023-03-07 02:30:00',
               '2023-03-07 03:30:00', '2023-03-07 04:30:00'],
              dtype='datetime64[ns]', freq='H')</code></pre>
</div>
</div>
<p>This <code>DatetimeIndex</code> may be used as an index in a <code>Series</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:294,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380446948,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c2cf0b79-4b42-4d0a-8140-7e49264f902f">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a>temp_series <span class="op">=</span> pd.Series(temperatures, dates)</span>
<span id="cb91-2"><a href="#cb91-2"></a>temp_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>2023-03-06 17:30:00    4.4
2023-03-06 18:30:00    5.1
2023-03-06 19:30:00    6.1
2023-03-06 20:30:00    6.2
2023-03-06 21:30:00    6.1
2023-03-06 22:30:00    6.1
2023-03-06 23:30:00    5.7
2023-03-07 00:30:00    5.2
2023-03-07 01:30:00    4.7
2023-03-07 02:30:00    4.1
2023-03-07 03:30:00    3.9
2023-03-07 04:30:00    3.5
Freq: H, dtype: float64</code></pre>
</div>
</div>
<p>Let’s plot this series:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:693,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380458904,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="dd35e6d4-ffe9-487e-e57d-f30cf04f8174">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a>temp_series.plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a></span>
<span id="cb93-3"><a href="#cb93-3"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb93-4"><a href="#cb93-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="03_Relational_Database_and_data_wrangling_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="periods" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="periods"><span class="header-section-number">3.2.3</span> Periods</h3>
<p>The <code>pd.period_range()</code> function returns a <code>PeriodIndex</code> instead of a <code>DatetimeIndex</code>. For example, let’s get all quarters in 2022 and 2023:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:287,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380508261,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b45030fe-3a47-41a3-ec73-48e98bf1712c">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>quarters <span class="op">=</span> pd.period_range(<span class="st">'2022Q1'</span>, periods<span class="op">=</span><span class="dv">8</span>, freq<span class="op">=</span><span class="st">'Q'</span>)</span>
<span id="cb94-2"><a href="#cb94-2"></a>quarters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>PeriodIndex(['2022Q1', '2022Q2', '2022Q3', '2022Q4', '2023Q1', '2023Q2',
             '2023Q3', '2023Q4'],
            dtype='period[Q-DEC]')</code></pre>
</div>
</div>
<p>Adding a number <code>N</code> to a <code>PeriodIndex</code> shifts the periods by <code>N</code> times the <code>PeriodIndex</code>’s frequency:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:335,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380518451,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e4eee169-865c-425f-839b-5d3c40ffa88b">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>quarters <span class="op">+</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>PeriodIndex(['2022Q4', '2023Q1', '2023Q2', '2023Q3', '2023Q4', '2024Q1',
             '2024Q2', '2024Q3'],
            dtype='period[Q-DEC]')</code></pre>
</div>
</div>
<p>Pandas also provides many other time-related functions that we recommend you check out in the <a href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html">documentation</a></p>
</section>
<section id="dataframe-objects" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="dataframe-objects"><span class="header-section-number">3.2.4</span> <code>DataFrame</code> objects</h3>
<p>A DataFrame object represents a spreadsheet, with cell values, column names and row index labels. You can define expressions to compute columns based on other columns, create pivot-tables, group rows, draw graphs, etc. You can see <code>DataFrame</code> as dictionaries of <code>Series</code>.</p>
<section id="creating-a-dataframe" class="level4" data-number="3.2.4.1">
<h4 data-number="3.2.4.1" class="anchored" data-anchor-id="creating-a-dataframe"><span class="header-section-number">3.2.4.1</span> Creating a <code>DataFrame</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a><span class="co">#%unload_ext google.colab.data_table #cloab only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a><span class="co">#from google.colab import data_table</span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="co">#data_table.disable_dataframe_formatter()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can create a DataFrame by passing a dictionary of <code>Series</code> objects:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:433,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380862380,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d5f07370-0b19-4c86-d705-6d47f452d9a8">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>people_dict <span class="op">=</span> {</span>
<span id="cb100-2"><a href="#cb100-2"></a>    <span class="st">"weight"</span>: pd.Series([<span class="dv">68</span>, <span class="dv">83</span>, <span class="dv">112</span>], index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>]),</span>
<span id="cb100-3"><a href="#cb100-3"></a>    <span class="st">"birthyear"</span>: pd.Series([<span class="dv">1984</span>, <span class="dv">1985</span>, <span class="dv">1992</span>], index<span class="op">=</span>[<span class="st">"bob"</span>, <span class="st">"alice"</span>, <span class="st">"charles"</span>], name<span class="op">=</span><span class="st">"year"</span>),</span>
<span id="cb100-4"><a href="#cb100-4"></a>    <span class="st">"children"</span>: pd.Series([<span class="dv">0</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="st">"charles"</span>, <span class="st">"bob"</span>]),</span>
<span id="cb100-5"><a href="#cb100-5"></a>    <span class="st">"hobby"</span>: pd.Series([<span class="st">"Biking"</span>, <span class="st">"Dancing"</span>], index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>]),</span>
<span id="cb100-6"><a href="#cb100-6"></a>}</span>
<span id="cb100-7"><a href="#cb100-7"></a>people <span class="op">=</span> pd.DataFrame(people_dict)</span>
<span id="cb100-8"><a href="#cb100-8"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

  <div id="df-0ede3346-56bc-4e16-87e7-1a89795feb12">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>1985</td>
<td>NaN</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>1984</td>
<td>3.0</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>1992</td>
<td>0.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0ede3346-56bc-4e16-87e7-1a89795feb12')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0ede3346-56bc-4e16-87e7-1a89795feb12 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0ede3346-56bc-4e16-87e7-1a89795feb12');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>A few things to note: * the <code>Series</code> were automatically aligned based on their index, * missing values are represented as <code>NaN</code>, * <code>Series</code> names are ignored (the name <code>"year"</code> was dropped), * <code>DataFrame</code>s are displayed nicely in Jupyter notebooks!</p>
</section>
<section id="subsets---accessing-columns" class="level4" data-number="3.2.4.2">
<h4 data-number="3.2.4.2" class="anchored" data-anchor-id="subsets---accessing-columns"><span class="header-section-number">3.2.4.2</span> Subsets - Accessing columns</h4>
<p>You can access columns by using the column name or fancy indexing. They are returned as <code>Series</code> objects:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:276,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380865928,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="cd95a181-decb-4ce5-c103-44b08034f516">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a>people[<span class="st">"birthyear"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>alice      1985
bob        1984
charles    1992
Name: birthyear, dtype: int64</code></pre>
</div>
</div>
<p>You can also get multiple columns at once:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380867112,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ca1253ba-782b-4f26-ecf3-67cb1e805efa">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a>people[[<span class="st">"birthyear"</span>, <span class="st">"hobby"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

  <div id="df-4a35d01e-6795-4769-b22e-d49dd8767e67">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>1985</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>1984</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>1992</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4a35d01e-6795-4769-b22e-d49dd8767e67')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4a35d01e-6795-4769-b22e-d49dd8767e67 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4a35d01e-6795-4769-b22e-d49dd8767e67');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Another convenient way to create a <code>DataFrame</code> is to pass all the values to the constructor as an <code>ndarray</code>, or a list of lists, and specify the column names and row index labels separately:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677380869657,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="327a1395-6ca5-40e7-e354-7a5e6cebedf1">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a>values <span class="op">=</span> [</span>
<span id="cb104-2"><a href="#cb104-2"></a>            [<span class="dv">1985</span>, np.nan, <span class="st">"Biking"</span>,   <span class="dv">68</span>],</span>
<span id="cb104-3"><a href="#cb104-3"></a>            [<span class="dv">1984</span>, <span class="dv">3</span>,      <span class="st">"Dancing"</span>,  <span class="dv">83</span>],</span>
<span id="cb104-4"><a href="#cb104-4"></a>            [<span class="dv">1992</span>, <span class="dv">0</span>,      np.nan,    <span class="dv">112</span>]</span>
<span id="cb104-5"><a href="#cb104-5"></a>         ]</span>
<span id="cb104-6"><a href="#cb104-6"></a>d3 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb104-7"><a href="#cb104-7"></a>        values,</span>
<span id="cb104-8"><a href="#cb104-8"></a>        columns<span class="op">=</span>[<span class="st">"birthyear"</span>, <span class="st">"children"</span>, <span class="st">"hobby"</span>, <span class="st">"weight"</span>],</span>
<span id="cb104-9"><a href="#cb104-9"></a>        index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>, <span class="st">"charles"</span>]</span>
<span id="cb104-10"><a href="#cb104-10"></a>     )</span>
<span id="cb104-11"><a href="#cb104-11"></a>d3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

  <div id="df-9bf3aad4-8870-47b5-9fc7-85f328bb19ec">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>1985</td>
<td>NaN</td>
<td>Biking</td>
<td>68</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>1984</td>
<td>3.0</td>
<td>Dancing</td>
<td>83</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>1992</td>
<td>0.0</td>
<td>NaN</td>
<td>112</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9bf3aad4-8870-47b5-9fc7-85f328bb19ec')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9bf3aad4-8870-47b5-9fc7-85f328bb19ec button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9bf3aad4-8870-47b5-9fc7-85f328bb19ec');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="multi-index-optional" class="level4" data-number="3.2.4.3">
<h4 data-number="3.2.4.3" class="anchored" data-anchor-id="multi-index-optional"><span class="header-section-number">3.2.4.3</span> Multi-index (optional)</h4>
<p>You can also create multi-index datafram as follows:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:278,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381098004,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d35413b2-9598-4a53-8811-1a782a338ad0">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb105-2"><a href="#cb105-2"></a>    {</span>
<span id="cb105-3"><a href="#cb105-3"></a>        <span class="st">"a"</span> : [<span class="dv">4</span> ,<span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb105-4"><a href="#cb105-4"></a>        <span class="st">"b"</span> : [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>],</span>
<span id="cb105-5"><a href="#cb105-5"></a>        <span class="st">"c"</span> : [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]</span>
<span id="cb105-6"><a href="#cb105-6"></a>     },</span>
<span id="cb105-7"><a href="#cb105-7"></a>    index <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb105-8"><a href="#cb105-8"></a>        [(<span class="st">'d'</span>,<span class="dv">1</span>),(<span class="st">'d'</span>,<span class="dv">2</span>),(<span class="st">'e'</span>,<span class="dv">2</span>)], names<span class="op">=</span>[<span class="st">'n'</span>,<span class="st">'v'</span>]</span>
<span id="cb105-9"><a href="#cb105-9"></a>    )</span>
<span id="cb105-10"><a href="#cb105-10"></a>)</span>
<span id="cb105-11"><a href="#cb105-11"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

  <div id="df-1af6cfdb-4adf-429e-a48a-f4a9bc1ece05">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">v</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">d</td>
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>7</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>5</td>
<td>8</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e</td>
<td data-quarto-table-cell-role="th">2</td>
<td>6</td>
<td>9</td>
<td>12</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1af6cfdb-4adf-429e-a48a-f4a9bc1ece05')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1af6cfdb-4adf-429e-a48a-f4a9bc1ece05 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1af6cfdb-4adf-429e-a48a-f4a9bc1ece05');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>If all columns are tuples of the same size, then they are understood as a multi-index. The same goes for row index labels. For example:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:282,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381157579,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a2dc4c3c-6df0-43df-ca4b-eb019ce66207">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a>d5 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb106-2"><a href="#cb106-2"></a>  {</span>
<span id="cb106-3"><a href="#cb106-3"></a>    (<span class="st">"public"</span>, <span class="st">"birthyear"</span>):</span>
<span id="cb106-4"><a href="#cb106-4"></a>        {(<span class="st">"Paris"</span>,<span class="st">"alice"</span>):<span class="dv">1985</span>, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="dv">1984</span>, (<span class="st">"London"</span>,<span class="st">"charles"</span>): <span class="dv">1992</span>},</span>
<span id="cb106-5"><a href="#cb106-5"></a>    (<span class="st">"public"</span>, <span class="st">"hobby"</span>):</span>
<span id="cb106-6"><a href="#cb106-6"></a>        {(<span class="st">"Paris"</span>,<span class="st">"alice"</span>):<span class="st">"Biking"</span>, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="st">"Dancing"</span>},</span>
<span id="cb106-7"><a href="#cb106-7"></a>    (<span class="st">"private"</span>, <span class="st">"weight"</span>):</span>
<span id="cb106-8"><a href="#cb106-8"></a>        {(<span class="st">"Paris"</span>,<span class="st">"alice"</span>):<span class="dv">68</span>, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="dv">83</span>, (<span class="st">"London"</span>,<span class="st">"charles"</span>): <span class="dv">112</span>},</span>
<span id="cb106-9"><a href="#cb106-9"></a>    (<span class="st">"private"</span>, <span class="st">"children"</span>):</span>
<span id="cb106-10"><a href="#cb106-10"></a>        {(<span class="st">"Paris"</span>, <span class="st">"alice"</span>):np.nan, (<span class="st">"Paris"</span>,<span class="st">"bob"</span>): <span class="dv">3</span>, (<span class="st">"London"</span>,<span class="st">"charles"</span>): <span class="dv">0</span>}</span>
<span id="cb106-11"><a href="#cb106-11"></a>  }</span>
<span id="cb106-12"><a href="#cb106-12"></a>)</span>
<span id="cb106-13"><a href="#cb106-13"></a>d5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

  <div id="df-a3331ede-d7af-433b-8997-b448c3e485ca">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">public</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">private</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">children</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Paris</td>
<td data-quarto-table-cell-role="th">alice</td>
<td>1985</td>
<td>Biking</td>
<td>68</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>1984</td>
<td>Dancing</td>
<td>83</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">London</td>
<td data-quarto-table-cell-role="th">charles</td>
<td>1992</td>
<td>NaN</td>
<td>112</td>
<td>0.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a3331ede-d7af-433b-8997-b448c3e485ca')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a3331ede-d7af-433b-8997-b448c3e485ca button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a3331ede-d7af-433b-8997-b448c3e485ca');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>You can now get a DataFrame containing all the “public” columns very simply:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:294,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381161247,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="aba5f802-02b7-4518-a3d7-ddba6208c7f6">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a>d5[<span class="st">"public"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">

  <div id="df-74c60beb-0732-4325-be08-ec011c593260">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Paris</td>
<td data-quarto-table-cell-role="th">alice</td>
<td>1985</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>1984</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">London</td>
<td data-quarto-table-cell-role="th">charles</td>
<td>1992</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-74c60beb-0732-4325-be08-ec011c593260')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-74c60beb-0732-4325-be08-ec011c593260 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-74c60beb-0732-4325-be08-ec011c593260');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>It is noted that most methods return modified copies in pandas.</p>
</section>
<section id="subsets---accessing-rows" class="level4" data-number="3.2.4.4">
<h4 data-number="3.2.4.4" class="anchored" data-anchor-id="subsets---accessing-rows"><span class="header-section-number">3.2.4.4</span> Subsets - Accessing rows</h4>
<p>Let’s go back to the <code>people</code> <code>DataFrame</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381192460,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="52dc74fd-6cc3-4463-c7bc-d1cdf992da13">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

  <div id="df-6f00d101-fe5d-4d6e-bd4b-73a50953bdcf">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>1985</td>
<td>NaN</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>1984</td>
<td>3.0</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>1992</td>
<td>0.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6f00d101-fe5d-4d6e-bd4b-73a50953bdcf')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6f00d101-fe5d-4d6e-bd4b-73a50953bdcf button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6f00d101-fe5d-4d6e-bd4b-73a50953bdcf');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p><strong>The <code>loc</code> attribute lets you access rows instead of columns.</strong> The result is a <code>Series</code> object in which the <code>DataFrame</code>’s column names are mapped to row index labels:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:288,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381221528,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1e40a94e-28cc-4c8c-8b07-96a4ceea4f48">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>people.loc[<span class="st">"charles"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>weight        112
birthyear    1992
children      0.0
hobby         NaN
Name: charles, dtype: object</code></pre>
</div>
</div>
<p>You can also access rows by integer location using the <code>iloc</code> attribute:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:295,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381257598,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f77cc170-822b-487c-f34b-6c90626dd225">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>people.iloc[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>weight        112
birthyear    1992
children      0.0
hobby         NaN
Name: charles, dtype: object</code></pre>
</div>
</div>
<p>You can also get a slice of rows, and this returns a <code>DataFrame</code> object:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:391,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381262085,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e3774828-3f39-4dcc-bcd9-50f514a43ca6">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a>people.iloc[<span class="dv">1</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

  <div id="df-657a53d5-6e38-444e-8ad2-e73453feae18">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>1984</td>
<td>3.0</td>
<td>Dancing</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>1992</td>
<td>0.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-657a53d5-6e38-444e-8ad2-e73453feae18')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-657a53d5-6e38-444e-8ad2-e73453feae18 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-657a53d5-6e38-444e-8ad2-e73453feae18');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Finally, you can pass a boolean array to get the matching rows. This is most useful when combined with boolean expressions:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381277973,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="88b02931-3345-4809-b4f1-7660d73e0e54">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>people[people[<span class="st">"birthyear"</span>] <span class="op">&lt;</span> <span class="dv">1990</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

  <div id="df-b502c8b0-a828-4f7e-ae93-e1fd4614a936">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>1985</td>
<td>NaN</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>1984</td>
<td>3.0</td>
<td>Dancing</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b502c8b0-a828-4f7e-ae93-e1fd4614a936')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b502c8b0-a828-4f7e-ae93-e1fd4614a936 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b502c8b0-a828-4f7e-ae93-e1fd4614a936');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>You can also accessing columns by specifiying the second axis:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:284,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381286779,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3f279f3a-36c2-4697-c1c9-54a942d8af22">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1"></a>people.iloc[:,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>alice      NaN
bob        3.0
charles    0.0
Name: children, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="adding-and-removing-columns" class="level4" data-number="3.2.4.5">
<h4 data-number="3.2.4.5" class="anchored" data-anchor-id="adding-and-removing-columns"><span class="header-section-number">3.2.4.5</span> Adding and removing columns</h4>
<p>You can generally treat <code>DataFrame</code> objects like dictionaries of <code>Series</code>, so the following work fine:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:470,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381329559,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="23297b51-5253-43f1-de45-ad4f538d8002">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

  <div id="df-d0c11ce8-ab58-4c7b-9749-6dfba08b94d5">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>1985</td>
<td>NaN</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>1984</td>
<td>3.0</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>1992</td>
<td>0.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d0c11ce8-ab58-4c7b-9749-6dfba08b94d5')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d0c11ce8-ab58-4c7b-9749-6dfba08b94d5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d0c11ce8-ab58-4c7b-9749-6dfba08b94d5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:314,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381366681,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="31064531-093c-4d69-963c-52ef688e2b86">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>people[<span class="st">"age"</span>] <span class="op">=</span> <span class="dv">2023</span> <span class="op">-</span> people[<span class="st">"birthyear"</span>]  <span class="co"># adds a new column "age"</span></span>
<span id="cb118-2"><a href="#cb118-2"></a>people[<span class="st">"over 30"</span>] <span class="op">=</span> people[<span class="st">"age"</span>] <span class="op">&gt;</span> <span class="dv">30</span>      <span class="co"># adds another column "over 30"</span></span>
<span id="cb118-3"><a href="#cb118-3"></a>birthyears <span class="op">=</span> people.pop(<span class="st">"birthyear"</span>)</span>
<span id="cb118-4"><a href="#cb118-4"></a>people.drop(columns<span class="op">=</span>[<span class="st">'children'</span>], inplace<span class="op">=</span><span class="va">True</span>) <span class="co"># drop a column inplace</span></span>
<span id="cb118-5"><a href="#cb118-5"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">

  <div id="df-375686f2-f35c-4e33-80a1-8d69e4782276">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>Biking</td>
<td>38</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>NaN</td>
<td>31</td>
<td>True</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-375686f2-f35c-4e33-80a1-8d69e4782276')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-375686f2-f35c-4e33-80a1-8d69e4782276 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-375686f2-f35c-4e33-80a1-8d69e4782276');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:286,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381370590,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="91be6303-25cd-40b4-91ee-87b7ba45bcf1">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1"></a>birthyears</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>alice      1985
bob        1984
charles    1992
Name: birthyear, dtype: int64</code></pre>
</div>
</div>
<p>When you add a new column, it must have the same number of rows. Missing rows are filled with NaN, and extra rows are ignored:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:303,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381397671,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2de94b28-711b-447f-d280-079d400fa4ea">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1"></a>people[<span class="st">"pets"</span>] <span class="op">=</span> pd.Series({<span class="st">"bob"</span>: <span class="dv">0</span>, <span class="st">"charles"</span>: <span class="dv">5</span>, <span class="st">"eugene"</span>:<span class="dv">1</span>})  <span class="co"># alice is missing, eugene is ignored</span></span>
<span id="cb121-2"><a href="#cb121-2"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">

  <div id="df-c432952b-d204-4b10-af51-8b993275392a">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>Biking</td>
<td>38</td>
<td>True</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>NaN</td>
<td>31</td>
<td>True</td>
<td>5.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c432952b-d204-4b10-af51-8b993275392a')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c432952b-d204-4b10-af51-8b993275392a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c432952b-d204-4b10-af51-8b993275392a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>When adding a new column, it is added at the end (on the right) by default. You can also insert a column anywhere else using the <code>insert()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:301,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381421921,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6b311f7f-30da-4f56-d324-3c1397d0963a">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>people.insert(<span class="dv">1</span>, <span class="st">"height"</span>, [<span class="dv">172</span>, <span class="dv">181</span>, <span class="dv">185</span>])</span>
<span id="cb122-2"><a href="#cb122-2"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

  <div id="df-d6ad43f6-9828-4a95-9665-0dff47035d7b">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>172</td>
<td>Biking</td>
<td>38</td>
<td>True</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>181</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>185</td>
<td>NaN</td>
<td>31</td>
<td>True</td>
<td>5.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d6ad43f6-9828-4a95-9665-0dff47035d7b')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d6ad43f6-9828-4a95-9665-0dff47035d7b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d6ad43f6-9828-4a95-9665-0dff47035d7b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>You can also create new columns by calling the <code>assign()</code> method. Note that this returns a new <code>DataFrame</code> object, the original is not modified</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:281,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381440325,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="90d51ffb-c8f3-4e35-a578-61df54faa2e3">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1"></a>p2 <span class="op">=</span> people.assign(</span>
<span id="cb123-2"><a href="#cb123-2"></a>    bmi <span class="op">=</span> people[<span class="st">"weight"</span>] <span class="op">/</span> (people[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span>,</span>
<span id="cb123-3"><a href="#cb123-3"></a>    has_pets <span class="op">=</span> people[<span class="st">"pets"</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb123-4"><a href="#cb123-4"></a>)</span>
<span id="cb123-5"><a href="#cb123-5"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

  <div id="df-75ed80f8-b0b0-4351-910e-96b66a3ad0f0">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
<th data-quarto-table-cell-role="th">bmi</th>
<th data-quarto-table-cell-role="th">has_pets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>172</td>
<td>Biking</td>
<td>38</td>
<td>True</td>
<td>NaN</td>
<td>22.985398</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>181</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
<td>0.0</td>
<td>25.335002</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>185</td>
<td>NaN</td>
<td>31</td>
<td>True</td>
<td>5.0</td>
<td>32.724617</td>
<td>True</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-75ed80f8-b0b0-4351-910e-96b66a3ad0f0')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-75ed80f8-b0b0-4351-910e-96b66a3ad0f0 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-75ed80f8-b0b0-4351-910e-96b66a3ad0f0');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>You can also rename the column name:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:282,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381600160,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2b6ab753-2db1-4f74-f11f-df0d16c67287">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>p2.rename(columns<span class="op">=</span>{<span class="st">'bmi'</span>:<span class="st">'body_mass_index'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

  <div id="df-131c72c3-7b1a-4b63-8b5b-708cf3d34181">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
<th data-quarto-table-cell-role="th">body_mass_index</th>
<th data-quarto-table-cell-role="th">has_pets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>172</td>
<td>Biking</td>
<td>38</td>
<td>True</td>
<td>NaN</td>
<td>22.985398</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>181</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
<td>0.0</td>
<td>25.335002</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>185</td>
<td>NaN</td>
<td>31</td>
<td>True</td>
<td>5.0</td>
<td>32.724617</td>
<td>True</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-131c72c3-7b1a-4b63-8b5b-708cf3d34181')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-131c72c3-7b1a-4b63-8b5b-708cf3d34181 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-131c72c3-7b1a-4b63-8b5b-708cf3d34181');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="querying-a-dataframe" class="level4" data-number="3.2.4.6">
<h4 data-number="3.2.4.6" class="anchored" data-anchor-id="querying-a-dataframe"><span class="header-section-number">3.2.4.6</span> Querying a <code>DataFrame</code></h4>
<p>The <code>query()</code> method lets you <strong>filter a <code>DataFrame</code> based on a query expression</strong>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381694665,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4aac7b55-80ef-49b5-fe89-9528172c4512">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1"></a>people.query(<span class="st">"age &gt; 30 and pets == 0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">

  <div id="df-596bd9bb-76e1-4313-bb7e-aecfd0d87198">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>181</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
<td>0.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-596bd9bb-76e1-4313-bb7e-aecfd0d87198')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-596bd9bb-76e1-4313-bb7e-aecfd0d87198 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-596bd9bb-76e1-4313-bb7e-aecfd0d87198');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="sorting-a-dataframe" class="level4" data-number="3.2.4.7">
<h4 data-number="3.2.4.7" class="anchored" data-anchor-id="sorting-a-dataframe"><span class="header-section-number">3.2.4.7</span> Sorting a <code>DataFrame</code></h4>
<p>You can sort a <code>DataFrame</code> by calling its <code>sort_index</code> method. By default it sorts the rows by their index label, in ascending order, but let’s reverse the order:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:268,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381730615,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="29c99c7c-2f5b-419a-c2cc-22fd7a017733">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a>people.sort_index(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">

  <div id="df-74443914-b3cc-4257-aafc-2894a5a272bb">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>112</td>
<td>185</td>
<td>NaN</td>
<td>31</td>
<td>True</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>83</td>
<td>181</td>
<td>Dancing</td>
<td>39</td>
<td>True</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>68</td>
<td>172</td>
<td>Biking</td>
<td>38</td>
<td>True</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-74443914-b3cc-4257-aafc-2894a5a272bb')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-74443914-b3cc-4257-aafc-2894a5a272bb button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-74443914-b3cc-4257-aafc-2894a5a272bb');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Note that <code>sort_index</code> returned a sorted <em>copy</em> of the <code>DataFrame</code>. To modify <code>people</code> directly, we can set the <code>inplace</code> argument to <code>True</code>. Also, we can sort the columns instead of the rows by setting <code>axis=1</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:276,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381784353,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="09e939e3-1822-49e4-c562-bdc97ffcdf2c">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1"></a>people.sort_index(axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb127-2"><a href="#cb127-2"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">

  <div id="df-9c8c4afc-a85d-4f72-8173-c2e12e94ec47">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>38</td>
<td>172</td>
<td>Biking</td>
<td>True</td>
<td>NaN</td>
<td>68</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>39</td>
<td>181</td>
<td>Dancing</td>
<td>True</td>
<td>0.0</td>
<td>83</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>31</td>
<td>185</td>
<td>NaN</td>
<td>True</td>
<td>5.0</td>
<td>112</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9c8c4afc-a85d-4f72-8173-c2e12e94ec47')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9c8c4afc-a85d-4f72-8173-c2e12e94ec47 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9c8c4afc-a85d-4f72-8173-c2e12e94ec47');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>To sort the <code>DataFrame</code> by the values instead of the labels, we can use <code>sort_values</code> and specify the column to sort by:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:271,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381814703,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d8a9f582-1583-4615-afb8-64d649b8e830">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a>people.sort_values(by<span class="op">=</span><span class="st">"age"</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb128-2"><a href="#cb128-2"></a>people</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">

  <div id="df-224a50f1-0cdd-417f-852a-9038eafce25f">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">height</th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">over 30</th>
<th data-quarto-table-cell-role="th">pets</th>
<th data-quarto-table-cell-role="th">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>31</td>
<td>185</td>
<td>NaN</td>
<td>True</td>
<td>5.0</td>
<td>112</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">alice</td>
<td>38</td>
<td>172</td>
<td>Biking</td>
<td>True</td>
<td>NaN</td>
<td>68</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">bob</td>
<td>39</td>
<td>181</td>
<td>Dancing</td>
<td>True</td>
<td>0.0</td>
<td>83</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-224a50f1-0cdd-417f-852a-9038eafce25f')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-224a50f1-0cdd-417f-852a-9038eafce25f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-224a50f1-0cdd-417f-852a-9038eafce25f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="plotting-a-dataframe" class="level4" data-number="3.2.4.8">
<h4 data-number="3.2.4.8" class="anchored" data-anchor-id="plotting-a-dataframe"><span class="header-section-number">3.2.4.8</span> Plotting a <code>DataFrame</code></h4>
<p>Just like for <code>Series</code>, pandas makes it easy to draw nice graphs based on a <code>DataFrame</code>.</p>
<p>For example, it is trivial to create a line plot from a <code>DataFrame</code>’s data by calling its <code>plot</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:526,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381902591,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="94403ce1-0060-4661-e2fa-0db5b9499788">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1"></a>people <span class="op">=</span> people.assign(</span>
<span id="cb129-2"><a href="#cb129-2"></a>    body_mass_index <span class="op">=</span> people[<span class="st">"weight"</span>] <span class="op">/</span> (people[<span class="st">"height"</span>] <span class="op">/</span> <span class="dv">100</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb129-3"><a href="#cb129-3"></a>)</span>
<span id="cb129-4"><a href="#cb129-4"></a>people.plot(kind <span class="op">=</span> <span class="st">"line"</span>, x <span class="op">=</span> <span class="st">"body_mass_index"</span>, y <span class="op">=</span> [<span class="st">"height"</span>, <span class="st">"weight"</span>])</span>
<span id="cb129-5"><a href="#cb129-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="03_Relational_Database_and_data_wrangling_files/figure-html/cell-98-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Again, there are way too many options to list here: the best option is to scroll through the <a href="http://pandas.pydata.org/pandas-docs/stable/visualization.html">Visualization</a> page in pandas’ documentation, find the plot you are interested in and look at the example code.</p>
</section>
<section id="operations-on-dataframes" class="level4" data-number="3.2.4.9">
<h4 data-number="3.2.4.9" class="anchored" data-anchor-id="operations-on-dataframes"><span class="header-section-number">3.2.4.9</span> Operations on <code>DataFrame</code>s</h4>
<p>Although <code>DataFrame</code>s do not try to mimick NumPy arrays, there are a few similarities. Let’s create a <code>DataFrame</code> to demonstrate this:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:293,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381954030,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d128e487-675f-428b-9219-0dd4bd9e6ada">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a>grades_array <span class="op">=</span> np.array([[<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">9</span>],[<span class="dv">10</span>,<span class="dv">9</span>,<span class="dv">9</span>],[<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>], [<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">10</span>]])</span>
<span id="cb130-2"><a href="#cb130-2"></a>grades <span class="op">=</span> pd.DataFrame(grades_array, columns<span class="op">=</span>[<span class="st">"sep"</span>, <span class="st">"oct"</span>, <span class="st">"nov"</span>], index<span class="op">=</span>[<span class="st">"alice"</span>,<span class="st">"bob"</span>,<span class="st">"charles"</span>,<span class="st">"darwin"</span>])</span>
<span id="cb130-3"><a href="#cb130-3"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">

  <div id="df-da40268f-0757-44d9-a922-53c8529a909c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sep</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">nov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>8</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>10</td>
<td>9</td>
<td>9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>4</td>
<td>8</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">darwin</td>
<td>9</td>
<td>10</td>
<td>10</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-da40268f-0757-44d9-a922-53c8529a909c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-da40268f-0757-44d9-a922-53c8529a909c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-da40268f-0757-44d9-a922-53c8529a909c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>You can apply NumPy mathematical functions on a <code>DataFrame</code>: the function is applied to all values:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:344,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381959214,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="49080743-aa75-4381-c144-9f2b138375da">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1"></a>np.sqrt(grades)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">

  <div id="df-012eb8b5-dfd0-4cba-96d7-76c4aa21dc7e">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sep</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">nov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>2.828427</td>
<td>2.828427</td>
<td>3.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>3.162278</td>
<td>3.000000</td>
<td>3.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>2.000000</td>
<td>2.828427</td>
<td>1.414214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">darwin</td>
<td>3.000000</td>
<td>3.162278</td>
<td>3.162278</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-012eb8b5-dfd0-4cba-96d7-76c4aa21dc7e')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-012eb8b5-dfd0-4cba-96d7-76c4aa21dc7e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-012eb8b5-dfd0-4cba-96d7-76c4aa21dc7e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:399,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381962665,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6d583c1d-c917-4f56-fa92-441d477d7875">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1"></a>grades <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">

  <div id="df-da7ccc63-96da-405f-b220-2826678f6cbe">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sep</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">nov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>9</td>
<td>9</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>11</td>
<td>10</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>5</td>
<td>9</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">darwin</td>
<td>10</td>
<td>11</td>
<td>11</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-da7ccc63-96da-405f-b220-2826678f6cbe')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-da7ccc63-96da-405f-b220-2826678f6cbe button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-da7ccc63-96da-405f-b220-2826678f6cbe');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Aggregation operations, such as computing the <code>max()</code>, the <code>sum()</code> or the <code>mean()</code> of a <code>DataFrame</code>, apply to each column, and you get back a <code>Series</code> object:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:306,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677381984289,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0966a0da-e1d4-40fc-eadd-56caf13d30bc">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1"></a>grades.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>sep    7.75
oct    8.75
nov    7.50
dtype: float64</code></pre>
</div>
</div>
<p>Most of these functions take an optional <code>axis</code> parameter which lets you specify along which axis of the <code>DataFrame</code> you want the operation executed. The default is <code>axis=0</code>, meaning that the operation is executed vertically (on each column). You can set <code>axis=1</code> to execute the operation horizontally (on each row). For example, let’s find out which students had all grades greater than <code>5</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382028176,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="31f5ef5a-0e36-4706-9314-b6da0cd0ff9f">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1"></a>(grades <span class="op">&gt;</span> <span class="dv">5</span>).<span class="bu">all</span>(axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>alice       True
bob         True
charles    False
darwin      True
dtype: bool</code></pre>
</div>
</div>
<p>If you add a <code>Series</code> object to a <code>DataFrame</code> (or execute any other binary operation), Pandas attempts to broadcast the operation to all <em>rows</em> in the <code>DataFrame</code>. This only works if the <code>Series</code> has the same size as the <code>DataFrame</code>s rows. For example, let’s subtract the <code>mean</code> of the <code>DataFrame</code> (a <code>Series</code> object) from the <code>DataFrame</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:297,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382078296,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e211169f-e50c-447a-a887-66c606d29b0e">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1"></a>grades <span class="op">-</span> grades.mean()  <span class="co"># equivalent to: grades - [7.75, 8.75, 7.50]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">

  <div id="df-a9ae8eb8-8a16-4174-b8af-2431db464326">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sep</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">nov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>0.25</td>
<td>-0.75</td>
<td>1.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>2.25</td>
<td>0.25</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>-3.75</td>
<td>-0.75</td>
<td>-5.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">darwin</td>
<td>1.25</td>
<td>1.25</td>
<td>2.5</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a9ae8eb8-8a16-4174-b8af-2431db464326')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a9ae8eb8-8a16-4174-b8af-2431db464326 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a9ae8eb8-8a16-4174-b8af-2431db464326');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>If you want to subtract the global mean from every grade, here is one way to do it:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:480,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382334450,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3625954b-5ee0-4f16-ee50-9b96b697b827" data-scrolled="true">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1"></a>grades <span class="op">-</span> grades.values.mean() <span class="co"># subtracts the global mean (8.00) from all grades</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">

  <div id="df-18fb2034-257a-4bbf-b4ba-f9bdf3d7e9ef">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sep</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">nov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>2.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>-4.0</td>
<td>0.0</td>
<td>-6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">darwin</td>
<td>1.0</td>
<td>2.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-18fb2034-257a-4bbf-b4ba-f9bdf3d7e9ef')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-18fb2034-257a-4bbf-b4ba-f9bdf3d7e9ef button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-18fb2034-257a-4bbf-b4ba-f9bdf3d7e9ef');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The following shows the behavior of <code>nan</code></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:278,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382387692,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8d49f6a9-0305-4f99-cadc-75b562cd3143">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1"></a>bonus_array <span class="op">=</span> np.array([[<span class="dv">0</span>,np.nan,<span class="dv">2</span>],[np.nan,<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">0</span>]])</span>
<span id="cb139-2"><a href="#cb139-2"></a>bonus_points <span class="op">=</span> pd.DataFrame(bonus_array, columns<span class="op">=</span>[<span class="st">"oct"</span>, <span class="st">"nov"</span>, <span class="st">"dec"</span>], index<span class="op">=</span>[<span class="st">"bob"</span>,<span class="st">"colin"</span>, <span class="st">"darwin"</span>, <span class="st">"charles"</span>])</span>
<span id="cb139-3"><a href="#cb139-3"></a>bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">

  <div id="df-e39e8c3d-06d3-4925-898d-bcd128b3e3f6">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">dec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bob</td>
<td>0.0</td>
<td>NaN</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">colin</td>
<td>NaN</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">charles</td>
<td>3.0</td>
<td>3.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e39e8c3d-06d3-4925-898d-bcd128b3e3f6')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e39e8c3d-06d3-4925-898d-bcd128b3e3f6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e39e8c3d-06d3-4925-898d-bcd128b3e3f6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:295,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382395137,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="73574006-1cd8-4e35-ba41-39496a27bcb1" data-scrolled="true">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1"></a>grades <span class="op">+</span> bonus_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">

  <div id="df-8966be32-712d-4e5a-a33d-6856c8501dfa">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dec</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">sep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>NaN</td>
<td>NaN</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>NaN</td>
<td>5.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">colin</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>NaN</td>
<td>11.0</td>
<td>10.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8966be32-712d-4e5a-a33d-6856c8501dfa')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8966be32-712d-4e5a-a33d-6856c8501dfa button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8966be32-712d-4e5a-a33d-6856c8501dfa');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="handling-missing-data" class="level4" data-number="3.2.4.10">
<h4 data-number="3.2.4.10" class="anchored" data-anchor-id="handling-missing-data"><span class="header-section-number">3.2.4.10</span> Handling missing data</h4>
<p>Dealing with missing data is a frequent task when working with real life data. Pandas offers a few tools to handle missing data.</p>
<p>Let’s try to fix the problem above. For example, we can decide that missing data should result in a zero, instead of <code>NaN</code>. We can replace all <code>NaN</code> values by a any value using the <code>fillna()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:301,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382419485,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="11285425-cd80-440b-8fea-a18adb29c9c9" data-scrolled="true">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1"></a>(grades <span class="op">+</span> bonus_points).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">

  <div id="df-d6bd5a43-e5d6-423e-a2ee-547f55a15311">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dec</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">sep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>0.0</td>
<td>0.0</td>
<td>9.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>0.0</td>
<td>5.0</td>
<td>11.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">colin</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>0.0</td>
<td>11.0</td>
<td>10.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d6bd5a43-e5d6-423e-a2ee-547f55a15311')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d6bd5a43-e5d6-423e-a2ee-547f55a15311 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d6bd5a43-e5d6-423e-a2ee-547f55a15311');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382430246,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="da581bd7-db3e-4c6b-cbfe-cf5df23ba27e" data-scrolled="true">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1"></a>final_grades <span class="op">=</span> grades <span class="op">+</span> bonus_points</span>
<span id="cb142-2"><a href="#cb142-2"></a>final_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">

  <div id="df-d8ba295d-d22c-438b-82a9-bbd4227ab97f">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dec</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">sep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>NaN</td>
<td>NaN</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>NaN</td>
<td>5.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">colin</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>NaN</td>
<td>11.0</td>
<td>10.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d8ba295d-d22c-438b-82a9-bbd4227ab97f')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d8ba295d-d22c-438b-82a9-bbd4227ab97f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d8ba295d-d22c-438b-82a9-bbd4227ab97f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>We can call the <code>dropna()</code> method to get rid of rows that are full of <code>NaN</code>s:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:270,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382443500,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0f45c062-967c-4b4d-9561-4c320c6bc63b">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1"></a>final_grades_clean <span class="op">=</span> final_grades.dropna(how<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb143-2"><a href="#cb143-2"></a>final_grades_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">

  <div id="df-fe4b09cc-af50-4a65-bbba-0f887c85dbc8">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dec</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">sep</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bob</td>
<td>NaN</td>
<td>NaN</td>
<td>9.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">charles</td>
<td>NaN</td>
<td>5.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>NaN</td>
<td>11.0</td>
<td>10.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fe4b09cc-af50-4a65-bbba-0f887c85dbc8')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fe4b09cc-af50-4a65-bbba-0f887c85dbc8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fe4b09cc-af50-4a65-bbba-0f887c85dbc8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Now let’s remove columns that are full of <code>NaN</code>s by setting the <code>axis</code> argument to <code>1</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:370,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382454351,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="98bd6066-caad-4d2b-8d8d-584d851ccfd9">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1"></a>final_grades_clean <span class="op">=</span> final_grades_clean.dropna(axis<span class="op">=</span><span class="dv">1</span>, how<span class="op">=</span><span class="st">"all"</span>)</span>
<span id="cb144-2"><a href="#cb144-2"></a>final_grades_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">

  <div id="df-bc17d255-74ed-4a9b-ace1-1f04302934e3">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">bob</td>
<td>NaN</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">charles</td>
<td>5.0</td>
<td>11.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>11.0</td>
<td>10.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bc17d255-74ed-4a9b-ace1-1f04302934e3')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bc17d255-74ed-4a9b-ace1-1f04302934e3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bc17d255-74ed-4a9b-ace1-1f04302934e3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="aggregating-with-groupby" class="level4" data-number="3.2.4.11">
<h4 data-number="3.2.4.11" class="anchored" data-anchor-id="aggregating-with-groupby"><span class="header-section-number">3.2.4.11</span> Aggregating with <code>groupby</code></h4>
<p>Similar to the SQL language, pandas allows grouping your data into groups to run calculations over each group.</p>
<p>First, let’s add some extra data about each person so we can group them, and let’s go back to the <code>final_grades</code> <code>DataFrame</code> so we can see how <code>NaN</code> values are handled:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:324,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382475284,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e62d921c-6450-4bbc-8ae5-c79fa26620e7" data-scrolled="true">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1"></a>final_grades[<span class="st">"hobby"</span>] <span class="op">=</span> [<span class="st">"Biking"</span>, <span class="st">"Dancing"</span>, np.nan, <span class="st">"Dancing"</span>, <span class="st">"Biking"</span>]</span>
<span id="cb145-2"><a href="#cb145-2"></a>final_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">

  <div id="df-328c6c04-6e46-4156-afc7-731498176260">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dec</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">sep</th>
<th data-quarto-table-cell-role="th">hobby</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Biking</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>NaN</td>
<td>NaN</td>
<td>9.0</td>
<td>NaN</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">charles</td>
<td>NaN</td>
<td>5.0</td>
<td>11.0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">colin</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Dancing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">darwin</td>
<td>NaN</td>
<td>11.0</td>
<td>10.0</td>
<td>NaN</td>
<td>Biking</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-328c6c04-6e46-4156-afc7-731498176260')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-328c6c04-6e46-4156-afc7-731498176260 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-328c6c04-6e46-4156-afc7-731498176260');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Now let’s group data in this <code>DataFrame</code> by hobby:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1"></a>grouped_grades <span class="op">=</span> final_grades.groupby(<span class="st">"hobby"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are ready to compute the average grade per hobby:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:281,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382516264,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="afdbea76-8c33-4696-8b76-a3430bb1c697">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1"></a>grouped_grades.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">

  <div id="df-53cbe11d-62cb-4427-9013-043a0863ff09">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dec</th>
<th data-quarto-table-cell-role="th">nov</th>
<th data-quarto-table-cell-role="th">oct</th>
<th data-quarto-table-cell-role="th">sep</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Biking</td>
<td>NaN</td>
<td>11.0</td>
<td>10.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Dancing</td>
<td>NaN</td>
<td>NaN</td>
<td>9.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-53cbe11d-62cb-4427-9013-043a0863ff09')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-53cbe11d-62cb-4427-9013-043a0863ff09 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-53cbe11d-62cb-4427-9013-043a0863ff09');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>That was easy! Note that the <code>NaN</code> values have simply been skipped when computing the means.</p>
</section>
<section id="pivot-tables-optional" class="level4" data-number="3.2.4.12">
<h4 data-number="3.2.4.12" class="anchored" data-anchor-id="pivot-tables-optional"><span class="header-section-number">3.2.4.12</span> Pivot tables (Optional)</h4>
<p>Pandas supports spreadsheet-like <a href="https://en.wikipedia.org/wiki/Pivot_table">pivot tables</a> that allow quick data summarization.</p>
</section>
<section id="overview-functions" class="level4" data-number="3.2.4.13">
<h4 data-number="3.2.4.13" class="anchored" data-anchor-id="overview-functions"><span class="header-section-number">3.2.4.13</span> Overview functions</h4>
<p>When dealing with large <code>DataFrames</code>, it is useful to get a quick overview of its content. Pandas offers a few functions for this. First, let’s create a large <code>DataFrame</code> with a mix of numeric values, missing values and text values. Notice how Jupyter displays only the corners of the <code>DataFrame</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:332,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382861029,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="16c58852-9247-4c3a-b529-e12fc3763807">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1"></a>much_data <span class="op">=</span> np.fromfunction(<span class="kw">lambda</span> x,y: (x<span class="op">+</span>y<span class="op">*</span>y)<span class="op">%</span><span class="dv">17</span><span class="op">*</span><span class="dv">11</span>, (<span class="dv">10000</span>, <span class="dv">26</span>))</span>
<span id="cb148-2"><a href="#cb148-2"></a>large_df <span class="op">=</span> pd.DataFrame(much_data, columns<span class="op">=</span><span class="bu">list</span>(<span class="st">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>))</span>
<span id="cb148-3"><a href="#cb148-3"></a>large_df[large_df <span class="op">%</span> <span class="dv">16</span> <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> np.nan</span>
<span id="cb148-4"><a href="#cb148-4"></a>large_df.insert(<span class="dv">3</span>,<span class="st">"some_text"</span>, <span class="st">"Blabla"</span>)</span>
<span id="cb148-5"><a href="#cb148-5"></a>large_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">

  <div id="df-67305636-1b16-4653-9603-8e2078264f5f">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">some_text</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">E</th>
<th data-quarto-table-cell-role="th">F</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">I</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Q</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">U</th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">W</th>
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>11.0</td>
<td>44.0</td>
<td>Blabla</td>
<td>99.0</td>
<td>NaN</td>
<td>88.0</td>
<td>22.0</td>
<td>165.0</td>
<td>143.0</td>
<td>...</td>
<td>11.0</td>
<td>NaN</td>
<td>11.0</td>
<td>44.0</td>
<td>99.0</td>
<td>NaN</td>
<td>88.0</td>
<td>22.0</td>
<td>165.0</td>
<td>143.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11.0</td>
<td>22.0</td>
<td>55.0</td>
<td>Blabla</td>
<td>110.0</td>
<td>NaN</td>
<td>99.0</td>
<td>33.0</td>
<td>NaN</td>
<td>154.0</td>
<td>...</td>
<td>22.0</td>
<td>11.0</td>
<td>22.0</td>
<td>55.0</td>
<td>110.0</td>
<td>NaN</td>
<td>99.0</td>
<td>33.0</td>
<td>NaN</td>
<td>154.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>Blabla</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
<td>...</td>
<td>33.0</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>Blabla</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
<td>...</td>
<td>44.0</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.0</td>
<td>55.0</td>
<td>88.0</td>
<td>Blabla</td>
<td>143.0</td>
<td>33.0</td>
<td>132.0</td>
<td>66.0</td>
<td>22.0</td>
<td>NaN</td>
<td>...</td>
<td>55.0</td>
<td>44.0</td>
<td>55.0</td>
<td>88.0</td>
<td>143.0</td>
<td>33.0</td>
<td>132.0</td>
<td>66.0</td>
<td>22.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9995</td>
<td>NaN</td>
<td>NaN</td>
<td>33.0</td>
<td>Blabla</td>
<td>88.0</td>
<td>165.0</td>
<td>77.0</td>
<td>11.0</td>
<td>154.0</td>
<td>132.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>33.0</td>
<td>88.0</td>
<td>165.0</td>
<td>77.0</td>
<td>11.0</td>
<td>154.0</td>
<td>132.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9996</td>
<td>NaN</td>
<td>11.0</td>
<td>44.0</td>
<td>Blabla</td>
<td>99.0</td>
<td>NaN</td>
<td>88.0</td>
<td>22.0</td>
<td>165.0</td>
<td>143.0</td>
<td>...</td>
<td>11.0</td>
<td>NaN</td>
<td>11.0</td>
<td>44.0</td>
<td>99.0</td>
<td>NaN</td>
<td>88.0</td>
<td>22.0</td>
<td>165.0</td>
<td>143.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9997</td>
<td>11.0</td>
<td>22.0</td>
<td>55.0</td>
<td>Blabla</td>
<td>110.0</td>
<td>NaN</td>
<td>99.0</td>
<td>33.0</td>
<td>NaN</td>
<td>154.0</td>
<td>...</td>
<td>22.0</td>
<td>11.0</td>
<td>22.0</td>
<td>55.0</td>
<td>110.0</td>
<td>NaN</td>
<td>99.0</td>
<td>33.0</td>
<td>NaN</td>
<td>154.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9998</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>Blabla</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
<td>...</td>
<td>33.0</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9999</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>Blabla</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
<td>...</td>
<td>44.0</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


<p>10000 rows × 27 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-67305636-1b16-4653-9603-8e2078264f5f')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-67305636-1b16-4653-9603-8e2078264f5f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-67305636-1b16-4653-9603-8e2078264f5f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The <code>head()</code> method returns the top 5 rows:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:286,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382874499,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="48732cb7-dca8-47a0-cc33-26344b123d76">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1"></a>large_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">

  <div id="df-e00eef93-023f-4640-a1ab-9bd1febc90fa">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">some_text</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">E</th>
<th data-quarto-table-cell-role="th">F</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">I</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Q</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">U</th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">W</th>
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>11.0</td>
<td>44.0</td>
<td>Blabla</td>
<td>99.0</td>
<td>NaN</td>
<td>88.0</td>
<td>22.0</td>
<td>165.0</td>
<td>143.0</td>
<td>...</td>
<td>11.0</td>
<td>NaN</td>
<td>11.0</td>
<td>44.0</td>
<td>99.0</td>
<td>NaN</td>
<td>88.0</td>
<td>22.0</td>
<td>165.0</td>
<td>143.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11.0</td>
<td>22.0</td>
<td>55.0</td>
<td>Blabla</td>
<td>110.0</td>
<td>NaN</td>
<td>99.0</td>
<td>33.0</td>
<td>NaN</td>
<td>154.0</td>
<td>...</td>
<td>22.0</td>
<td>11.0</td>
<td>22.0</td>
<td>55.0</td>
<td>110.0</td>
<td>NaN</td>
<td>99.0</td>
<td>33.0</td>
<td>NaN</td>
<td>154.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>Blabla</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
<td>...</td>
<td>33.0</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>Blabla</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
<td>...</td>
<td>44.0</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>44.0</td>
<td>55.0</td>
<td>88.0</td>
<td>Blabla</td>
<td>143.0</td>
<td>33.0</td>
<td>132.0</td>
<td>66.0</td>
<td>22.0</td>
<td>NaN</td>
<td>...</td>
<td>55.0</td>
<td>44.0</td>
<td>55.0</td>
<td>88.0</td>
<td>143.0</td>
<td>33.0</td>
<td>132.0</td>
<td>66.0</td>
<td>22.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


<p>5 rows × 27 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e00eef93-023f-4640-a1ab-9bd1febc90fa')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e00eef93-023f-4640-a1ab-9bd1febc90fa button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e00eef93-023f-4640-a1ab-9bd1febc90fa');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Of course there’s also a <code>tail()</code> function to view the bottom 5 rows. You can pass the number of rows you want:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:280,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382876960,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="088b2801-1ee4-489f-e001-646b93867f16">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1"></a>large_df.tail(n<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">

  <div id="df-bbd6b26f-712d-43b4-9968-c51bf02bfd24">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">some_text</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">E</th>
<th data-quarto-table-cell-role="th">F</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">I</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Q</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">U</th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">W</th>
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9998</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>Blabla</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
<td>...</td>
<td>33.0</td>
<td>22.0</td>
<td>33.0</td>
<td>66.0</td>
<td>121.0</td>
<td>11.0</td>
<td>110.0</td>
<td>44.0</td>
<td>NaN</td>
<td>165.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9999</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>Blabla</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
<td>...</td>
<td>44.0</td>
<td>33.0</td>
<td>44.0</td>
<td>77.0</td>
<td>132.0</td>
<td>22.0</td>
<td>121.0</td>
<td>55.0</td>
<td>11.0</td>
<td>NaN</td>
</tr>
</tbody>
</table>


<p>2 rows × 27 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bbd6b26f-712d-43b4-9968-c51bf02bfd24')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bbd6b26f-712d-43b4-9968-c51bf02bfd24 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bbd6b26f-712d-43b4-9968-c51bf02bfd24');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The <code>info()</code> method prints out a summary of each columns contents:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382879205,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5f5c35f6-ead9-4cbd-a561-35071e44bc5b">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1"></a>large_df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10000 entries, 0 to 9999
Data columns (total 27 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   A          8823 non-null   float64
 1   B          8824 non-null   float64
 2   C          8824 non-null   float64
 3   some_text  10000 non-null  object 
 4   D          8824 non-null   float64
 5   E          8822 non-null   float64
 6   F          8824 non-null   float64
 7   G          8824 non-null   float64
 8   H          8822 non-null   float64
 9   I          8823 non-null   float64
 10  J          8823 non-null   float64
 11  K          8822 non-null   float64
 12  L          8824 non-null   float64
 13  M          8824 non-null   float64
 14  N          8822 non-null   float64
 15  O          8824 non-null   float64
 16  P          8824 non-null   float64
 17  Q          8824 non-null   float64
 18  R          8823 non-null   float64
 19  S          8824 non-null   float64
 20  T          8824 non-null   float64
 21  U          8824 non-null   float64
 22  V          8822 non-null   float64
 23  W          8824 non-null   float64
 24  X          8824 non-null   float64
 25  Y          8822 non-null   float64
 26  Z          8823 non-null   float64
dtypes: float64(26), object(1)
memory usage: 2.1+ MB</code></pre>
</div>
</div>
<p>Finally, the <code>describe()</code> method gives a nice overview of the main aggregated values over each column: * <code>count</code>: number of non-null (not NaN) values * <code>mean</code>: mean of non-null values * <code>std</code>: <a href="https://en.wikipedia.org/wiki/Standard_deviation">standard deviation</a> of non-null values * <code>min</code>: minimum of non-null values * <code>25%</code>, <code>50%</code>, <code>75%</code>: 25th, 50th and 75th <a href="https://en.wikipedia.org/wiki/Percentile">percentile</a> of non-null values * <code>max</code>: maximum of non-null values</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:305,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382886145,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3ded5901-5761-40a2-969d-b0a2ea22e7f0">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1"></a>large_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">

  <div id="df-cf8c2dcf-f3c2-4227-8724-b671cd462c54">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">E</th>
<th data-quarto-table-cell-role="th">F</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">I</th>
<th data-quarto-table-cell-role="th">J</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Q</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">U</th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">W</th>
<th data-quarto-table-cell-role="th">X</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>8823.000000</td>
<td>8824.000000</td>
<td>8824.000000</td>
<td>8824.000000</td>
<td>8822.000000</td>
<td>8824.000000</td>
<td>8824.000000</td>
<td>8822.000000</td>
<td>8823.000000</td>
<td>8823.000000</td>
<td>...</td>
<td>8824.000000</td>
<td>8823.000000</td>
<td>8824.000000</td>
<td>8824.000000</td>
<td>8824.000000</td>
<td>8822.000000</td>
<td>8824.000000</td>
<td>8824.000000</td>
<td>8822.000000</td>
<td>8823.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>87.977559</td>
<td>87.972575</td>
<td>87.987534</td>
<td>88.012466</td>
<td>87.983791</td>
<td>88.007480</td>
<td>87.977561</td>
<td>88.000000</td>
<td>88.022441</td>
<td>88.022441</td>
<td>...</td>
<td>87.972575</td>
<td>87.977559</td>
<td>87.972575</td>
<td>87.987534</td>
<td>88.012466</td>
<td>87.983791</td>
<td>88.007480</td>
<td>87.977561</td>
<td>88.000000</td>
<td>88.022441</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>47.535911</td>
<td>47.535523</td>
<td>47.521679</td>
<td>47.521679</td>
<td>47.535001</td>
<td>47.519371</td>
<td>47.529755</td>
<td>47.536879</td>
<td>47.535911</td>
<td>47.535911</td>
<td>...</td>
<td>47.535523</td>
<td>47.535911</td>
<td>47.535523</td>
<td>47.521679</td>
<td>47.521679</td>
<td>47.535001</td>
<td>47.519371</td>
<td>47.529755</td>
<td>47.536879</td>
<td>47.535911</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>...</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
<td>11.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>...</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
<td>44.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>...</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
<td>88.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>...</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
<td>132.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>...</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
<td>165.000000</td>
</tr>
</tbody>
</table>


<p>8 rows × 26 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cf8c2dcf-f3c2-4227-8724-b671cd462c54')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cf8c2dcf-f3c2-4227-8724-b671cd462c54 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cf8c2dcf-f3c2-4227-8724-b671cd462c54');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="saving-loading" class="level4" data-number="3.2.4.14">
<h4 data-number="3.2.4.14" class="anchored" data-anchor-id="saving-loading"><span class="header-section-number">3.2.4.14</span> Saving &amp; loading</h4>
<p>Pandas can save <code>DataFrame</code>s to various backends, including file formats such as CSV, Excel, JSON, HTML and HDF5, or to a SQL database. Let’s create a <code>DataFrame</code> to demonstrate this:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382934763,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3fce1520-f215-40ec-be1c-978ec3ad0766">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1"></a>my_df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb154-2"><a href="#cb154-2"></a>    [[<span class="st">"Biking"</span>, <span class="fl">68.5</span>, <span class="dv">1985</span>, np.nan], [<span class="st">"Dancing"</span>, <span class="fl">83.1</span>, <span class="dv">1984</span>, <span class="dv">3</span>]], </span>
<span id="cb154-3"><a href="#cb154-3"></a>    columns<span class="op">=</span>[<span class="st">"hobby"</span>,<span class="st">"weight"</span>,<span class="st">"birthyear"</span>,<span class="st">"children"</span>],</span>
<span id="cb154-4"><a href="#cb154-4"></a>    index<span class="op">=</span>[<span class="st">"alice"</span>, <span class="st">"bob"</span>]</span>
<span id="cb154-5"><a href="#cb154-5"></a>)</span>
<span id="cb154-6"><a href="#cb154-6"></a>my_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">

  <div id="df-eb2ce3af-4bb5-4c5f-9194-1dc5b6e5b09c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>Biking</td>
<td>68.5</td>
<td>1985</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>Dancing</td>
<td>83.1</td>
<td>1984</td>
<td>3.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-eb2ce3af-4bb5-4c5f-9194-1dc5b6e5b09c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-eb2ce3af-4bb5-4c5f-9194-1dc5b6e5b09c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-eb2ce3af-4bb5-4c5f-9194-1dc5b6e5b09c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Let’s save it to CSV, HTML and JSON:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1"></a>my_df.to_csv(<span class="st">"my_df.csv"</span>)</span>
<span id="cb155-2"><a href="#cb155-2"></a>my_df.to_html(<span class="st">"my_df.html"</span>)</span>
<span id="cb155-3"><a href="#cb155-3"></a>my_df.to_json(<span class="st">"my_df.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Done! Let’s take a peek at what was saved:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:398,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382939395,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="86d80515-7d04-4b61-d938-2453b1814a9f">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1"></a><span class="cf">for</span> filename <span class="kw">in</span> (<span class="st">"my_df.csv"</span>, <span class="st">"my_df.html"</span>, <span class="st">"my_df.json"</span>):</span>
<span id="cb156-2"><a href="#cb156-2"></a>    <span class="bu">print</span>(<span class="st">"#"</span>, filename)</span>
<span id="cb156-3"><a href="#cb156-3"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">"rt"</span>) <span class="im">as</span> f:</span>
<span id="cb156-4"><a href="#cb156-4"></a>        <span class="bu">print</span>(f.read())</span>
<span id="cb156-5"><a href="#cb156-5"></a>        <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># my_df.csv
,hobby,weight,birthyear,children
alice,Biking,68.5,1985,
bob,Dancing,83.1,1984,3.0


# my_df.html
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;hobby&lt;/th&gt;
      &lt;th&gt;weight&lt;/th&gt;
      &lt;th&gt;birthyear&lt;/th&gt;
      &lt;th&gt;children&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;alice&lt;/th&gt;
      &lt;td&gt;Biking&lt;/td&gt;
      &lt;td&gt;68.5&lt;/td&gt;
      &lt;td&gt;1985&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;bob&lt;/th&gt;
      &lt;td&gt;Dancing&lt;/td&gt;
      &lt;td&gt;83.1&lt;/td&gt;
      &lt;td&gt;1984&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

# my_df.json
{"hobby":{"alice":"Biking","bob":"Dancing"},"weight":{"alice":68.5,"bob":83.1},"birthyear":{"alice":1985,"bob":1984},"children":{"alice":null,"bob":3.0}}
</code></pre>
</div>
</div>
<p>Note that the index is saved as the first column (with no name) in a CSV file, as <code>&lt;th&gt;</code> tags in HTML and as keys in JSON.</p>
<p>Saving to other formats works very similarly, but some formats require extra libraries to be installed. For example, saving to Excel requires the <code>openpyxl</code> library:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1"></a><span class="cf">try</span>:</span>
<span id="cb158-2"><a href="#cb158-2"></a>    my_df.to_excel(<span class="st">"my_df.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">'People'</span>)</span>
<span id="cb158-3"><a href="#cb158-3"></a><span class="cf">except</span> <span class="pp">ImportError</span> <span class="im">as</span> e:</span>
<span id="cb158-4"><a href="#cb158-4"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s load our CSV file back into a <code>DataFrame</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:302,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382970385,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="45d399ad-124e-4199-9b11-e933b6476a34">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1"></a>my_df_loaded <span class="op">=</span> pd.read_csv(<span class="st">"my_df.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb159-2"><a href="#cb159-2"></a>my_df_loaded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">

  <div id="df-98c45a30-312a-47f0-8ae7-faa275539320">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">hobby</th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">birthyear</th>
<th data-quarto-table-cell-role="th">children</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">alice</td>
<td>Biking</td>
<td>68.5</td>
<td>1985</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bob</td>
<td>Dancing</td>
<td>83.1</td>
<td>1984</td>
<td>3.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-98c45a30-312a-47f0-8ae7-faa275539320')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-98c45a30-312a-47f0-8ae7-faa275539320 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-98c45a30-312a-47f0-8ae7-faa275539320');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>As you might guess, there are similar <code>read_json</code>, <code>read_html</code>, <code>read_excel</code> functions as well. We can also read data straight from the Internet. For example, let’s load the top 1,000 U.S. cities from github:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:755,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677382979218,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3848616a-c16a-4dd2-c693-51e26258076c">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1"></a>us_cities <span class="op">=</span> <span class="va">None</span></span>
<span id="cb160-2"><a href="#cb160-2"></a><span class="cf">try</span>:</span>
<span id="cb160-3"><a href="#cb160-3"></a>    csv_url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/plotly/datasets/master/us-cities-top-1k.csv"</span></span>
<span id="cb160-4"><a href="#cb160-4"></a>    us_cities <span class="op">=</span> pd.read_csv(csv_url, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb160-5"><a href="#cb160-5"></a>    us_cities <span class="op">=</span> us_cities.head()</span>
<span id="cb160-6"><a href="#cb160-6"></a><span class="cf">except</span> <span class="pp">IOError</span> <span class="im">as</span> e:</span>
<span id="cb160-7"><a href="#cb160-7"></a>    <span class="bu">print</span>(e)</span>
<span id="cb160-8"><a href="#cb160-8"></a>us_cities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">

  <div id="df-7598272c-d041-493d-85c4-bd4cb1f0ee35">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Marysville</td>
<td>Washington</td>
<td>63269</td>
<td>48.051764</td>
<td>-122.177082</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Perris</td>
<td>California</td>
<td>72326</td>
<td>33.782519</td>
<td>-117.228648</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Cleveland</td>
<td>Ohio</td>
<td>390113</td>
<td>41.499320</td>
<td>-81.694361</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Worcester</td>
<td>Massachusetts</td>
<td>182544</td>
<td>42.262593</td>
<td>-71.802293</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Columbia</td>
<td>South Carolina</td>
<td>133358</td>
<td>34.000710</td>
<td>-81.034814</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7598272c-d041-493d-85c4-bd4cb1f0ee35')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7598272c-d041-493d-85c4-bd4cb1f0ee35 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7598272c-d041-493d-85c4-bd4cb1f0ee35');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>There are more options available, in particular regarding datetime format. Check out the <a href="http://pandas.pydata.org/pandas-docs/stable/io.html">documentation</a> for more details.</p>
</section>
<section id="combining-dataframes" class="level4" data-number="3.2.4.15">
<h4 data-number="3.2.4.15" class="anchored" data-anchor-id="combining-dataframes"><span class="header-section-number">3.2.4.15</span> Combining <code>DataFrame</code>s</h4>
<p>One powerful feature of Pandas is it’s ability to perform SQL-like joins on <code>DataFrame</code>s. Various types of joins are supported: inner joins, left/right outer joins and full joins. To illustrate this, let’s start by creating a couple simple <code>DataFrame</code>s:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:302,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383013230,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3df2fe64-e3bd-4dd9-b2f0-03933be13d0a">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1"></a>city_loc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb161-2"><a href="#cb161-2"></a>    [</span>
<span id="cb161-3"><a href="#cb161-3"></a>        [<span class="st">"CA"</span>, <span class="st">"San Francisco"</span>, <span class="fl">37.781334</span>, <span class="op">-</span><span class="fl">122.416728</span>],</span>
<span id="cb161-4"><a href="#cb161-4"></a>        [<span class="st">"NY"</span>, <span class="st">"New York"</span>, <span class="fl">40.705649</span>, <span class="op">-</span><span class="fl">74.008344</span>],</span>
<span id="cb161-5"><a href="#cb161-5"></a>        [<span class="st">"FL"</span>, <span class="st">"Miami"</span>, <span class="fl">25.791100</span>, <span class="op">-</span><span class="fl">80.320733</span>],</span>
<span id="cb161-6"><a href="#cb161-6"></a>        [<span class="st">"OH"</span>, <span class="st">"Cleveland"</span>, <span class="fl">41.473508</span>, <span class="op">-</span><span class="fl">81.739791</span>],</span>
<span id="cb161-7"><a href="#cb161-7"></a>        [<span class="st">"UT"</span>, <span class="st">"Salt Lake City"</span>, <span class="fl">40.755851</span>, <span class="op">-</span><span class="fl">111.896657</span>]</span>
<span id="cb161-8"><a href="#cb161-8"></a>    ], columns<span class="op">=</span>[<span class="st">"state"</span>, <span class="st">"city"</span>, <span class="st">"lat"</span>, <span class="st">"lng"</span>])</span>
<span id="cb161-9"><a href="#cb161-9"></a>city_loc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">

  <div id="df-7355be02-5dbe-4743-9bc8-563acb6b65d6">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
<td>37.781334</td>
<td>-122.416728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
<td>40.705649</td>
<td>-74.008344</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
<td>25.791100</td>
<td>-80.320733</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>OH</td>
<td>Cleveland</td>
<td>41.473508</td>
<td>-81.739791</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UT</td>
<td>Salt Lake City</td>
<td>40.755851</td>
<td>-111.896657</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7355be02-5dbe-4743-9bc8-563acb6b65d6')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7355be02-5dbe-4743-9bc8-563acb6b65d6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7355be02-5dbe-4743-9bc8-563acb6b65d6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:315,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383016740,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ff9b53cd-0dfc-43cd-cfbd-a7de3cdef383">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1"></a>city_pop <span class="op">=</span> pd.DataFrame(</span>
<span id="cb162-2"><a href="#cb162-2"></a>    [</span>
<span id="cb162-3"><a href="#cb162-3"></a>        [<span class="dv">808976</span>, <span class="st">"San Francisco"</span>, <span class="st">"California"</span>],</span>
<span id="cb162-4"><a href="#cb162-4"></a>        [<span class="dv">8363710</span>, <span class="st">"New York"</span>, <span class="st">"New-York"</span>],</span>
<span id="cb162-5"><a href="#cb162-5"></a>        [<span class="dv">413201</span>, <span class="st">"Miami"</span>, <span class="st">"Florida"</span>],</span>
<span id="cb162-6"><a href="#cb162-6"></a>        [<span class="dv">2242193</span>, <span class="st">"Houston"</span>, <span class="st">"Texas"</span>]</span>
<span id="cb162-7"><a href="#cb162-7"></a>    ], index<span class="op">=</span>[<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>], columns<span class="op">=</span>[<span class="st">"population"</span>, <span class="st">"city"</span>, <span class="st">"state"</span>])</span>
<span id="cb162-8"><a href="#cb162-8"></a>city_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">

  <div id="df-35d16286-038b-41e3-b132-db09593cd448">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">state</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>808976</td>
<td>San Francisco</td>
<td>California</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>8363710</td>
<td>New York</td>
<td>New-York</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>413201</td>
<td>Miami</td>
<td>Florida</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2242193</td>
<td>Houston</td>
<td>Texas</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-35d16286-038b-41e3-b132-db09593cd448')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-35d16286-038b-41e3-b132-db09593cd448 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-35d16286-038b-41e3-b132-db09593cd448');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Now let’s join these <code>DataFrame</code>s using the <code>merge()</code> function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383023871,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c5572a49-71fd-478e-a202-977abd830be3">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1"></a>pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop, on<span class="op">=</span><span class="st">"city"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">

  <div id="df-8c3c1144-c096-4f5b-8299-81bd2764ae8c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state_x</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">state_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
<td>37.781334</td>
<td>-122.416728</td>
<td>808976</td>
<td>California</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
<td>40.705649</td>
<td>-74.008344</td>
<td>8363710</td>
<td>New-York</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
<td>25.791100</td>
<td>-80.320733</td>
<td>413201</td>
<td>Florida</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8c3c1144-c096-4f5b-8299-81bd2764ae8c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8c3c1144-c096-4f5b-8299-81bd2764ae8c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8c3c1144-c096-4f5b-8299-81bd2764ae8c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Note that both <code>DataFrame</code>s have a column named <code>state</code>, so in the result they got renamed to <code>state_x</code> and <code>state_y</code>.</p>
<p>Also, note that Cleveland, Salt Lake City and Houston were dropped because they don’t exist in <em>both</em> <code>DataFrame</code>s. This is the equivalent of a SQL <code>INNER JOIN</code>. If you want a <code>FULL OUTER JOIN</code>, where no city gets dropped and <code>NaN</code> values are added, you must specify <code>how="outer"</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:303,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383043836,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9e1e705c-d8c2-4229-8b37-00ab1de368c3">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1"></a>all_cities <span class="op">=</span> pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop, on<span class="op">=</span><span class="st">"city"</span>, how<span class="op">=</span><span class="st">"outer"</span>)</span>
<span id="cb164-2"><a href="#cb164-2"></a>all_cities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">

  <div id="df-3bcbae49-47a2-4e86-91b0-a7ca9a9ddb4c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state_x</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">state_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
<td>37.781334</td>
<td>-122.416728</td>
<td>808976.0</td>
<td>California</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
<td>40.705649</td>
<td>-74.008344</td>
<td>8363710.0</td>
<td>New-York</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
<td>25.791100</td>
<td>-80.320733</td>
<td>413201.0</td>
<td>Florida</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>OH</td>
<td>Cleveland</td>
<td>41.473508</td>
<td>-81.739791</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UT</td>
<td>Salt Lake City</td>
<td>40.755851</td>
<td>-111.896657</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>Houston</td>
<td>NaN</td>
<td>NaN</td>
<td>2242193.0</td>
<td>Texas</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3bcbae49-47a2-4e86-91b0-a7ca9a9ddb4c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3bcbae49-47a2-4e86-91b0-a7ca9a9ddb4c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3bcbae49-47a2-4e86-91b0-a7ca9a9ddb4c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Of course <code>LEFT OUTER JOIN</code> is also available by setting <code>how="left"</code>: only the cities present in the left <code>DataFrame</code> end up in the result. Similarly, with <code>how="right"</code> only cities in the right <code>DataFrame</code> appear in the result. For example:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383048336,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c08f5172-e69b-44f6-fde0-57859a10a3b8">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1"></a>pd.merge(left<span class="op">=</span>city_loc, right<span class="op">=</span>city_pop, on<span class="op">=</span><span class="st">"city"</span>, how<span class="op">=</span><span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">

  <div id="df-635076ac-41c2-4b66-8a66-b6b354fab8fe">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state_x</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">state_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
<td>37.781334</td>
<td>-122.416728</td>
<td>808976</td>
<td>California</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
<td>40.705649</td>
<td>-74.008344</td>
<td>8363710</td>
<td>New-York</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
<td>25.791100</td>
<td>-80.320733</td>
<td>413201</td>
<td>Florida</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>Houston</td>
<td>NaN</td>
<td>NaN</td>
<td>2242193</td>
<td>Texas</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-635076ac-41c2-4b66-8a66-b6b354fab8fe')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-635076ac-41c2-4b66-8a66-b6b354fab8fe button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-635076ac-41c2-4b66-8a66-b6b354fab8fe');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="concatenation" class="level4" data-number="3.2.4.16">
<h4 data-number="3.2.4.16" class="anchored" data-anchor-id="concatenation"><span class="header-section-number">3.2.4.16</span> Concatenation</h4>
<p>Rather than joining <code>DataFrame</code>s, we may just want to concatenate them. That’s what <code>concat()</code> is for:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383154129,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f85874d3-f6a1-4cbe-87b6-48ef41a3877e">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1"></a>result_concat <span class="op">=</span> pd.concat([city_loc, city_pop])</span>
<span id="cb166-2"><a href="#cb166-2"></a>result_concat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">

  <div id="df-370ececf-23eb-48b9-8aae-02cebb9fbce7">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
<td>37.781334</td>
<td>-122.416728</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
<td>40.705649</td>
<td>-74.008344</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
<td>25.791100</td>
<td>-80.320733</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>OH</td>
<td>Cleveland</td>
<td>41.473508</td>
<td>-81.739791</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UT</td>
<td>Salt Lake City</td>
<td>40.755851</td>
<td>-111.896657</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>California</td>
<td>San Francisco</td>
<td>NaN</td>
<td>NaN</td>
<td>808976.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>New-York</td>
<td>New York</td>
<td>NaN</td>
<td>NaN</td>
<td>8363710.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Florida</td>
<td>Miami</td>
<td>NaN</td>
<td>NaN</td>
<td>413201.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Texas</td>
<td>Houston</td>
<td>NaN</td>
<td>NaN</td>
<td>2242193.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-370ececf-23eb-48b9-8aae-02cebb9fbce7')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-370ececf-23eb-48b9-8aae-02cebb9fbce7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-370ececf-23eb-48b9-8aae-02cebb9fbce7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Note that this operation aligned the data horizontally (by columns) but not vertically (by rows). In this example, we end up with multiple rows having the same index (eg. 3). Pandas handles this rather gracefully:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:271,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383173016,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="eaec25d9-8cba-4f9d-bfda-6517986ccb52">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1"></a>result_concat.loc[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">

  <div id="df-403a5690-7d3e-4abe-9206-36f6bd74e89d">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>OH</td>
<td>Cleveland</td>
<td>41.473508</td>
<td>-81.739791</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>California</td>
<td>San Francisco</td>
<td>NaN</td>
<td>NaN</td>
<td>808976.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-403a5690-7d3e-4abe-9206-36f6bd74e89d')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-403a5690-7d3e-4abe-9206-36f6bd74e89d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-403a5690-7d3e-4abe-9206-36f6bd74e89d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Or you can tell Pandas to just ignore the index:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:297,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383179318,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ac861bbd-ba09-4166-ab57-5da983a1cdce">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1"></a>pd.concat([city_loc, city_pop], ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">

  <div id="df-05e0d9eb-9ba4-446b-a9f5-d91ea7c00b8c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lng</th>
<th data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
<td>37.781334</td>
<td>-122.416728</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
<td>40.705649</td>
<td>-74.008344</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
<td>25.791100</td>
<td>-80.320733</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>OH</td>
<td>Cleveland</td>
<td>41.473508</td>
<td>-81.739791</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UT</td>
<td>Salt Lake City</td>
<td>40.755851</td>
<td>-111.896657</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>California</td>
<td>San Francisco</td>
<td>NaN</td>
<td>NaN</td>
<td>808976.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>New-York</td>
<td>New York</td>
<td>NaN</td>
<td>NaN</td>
<td>8363710.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Florida</td>
<td>Miami</td>
<td>NaN</td>
<td>NaN</td>
<td>413201.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Texas</td>
<td>Houston</td>
<td>NaN</td>
<td>NaN</td>
<td>2242193.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-05e0d9eb-9ba4-446b-a9f5-d91ea7c00b8c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-05e0d9eb-9ba4-446b-a9f5-d91ea7c00b8c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-05e0d9eb-9ba4-446b-a9f5-d91ea7c00b8c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Notice that when a column does not exist in a <code>DataFrame</code>, it acts as if it was filled with <code>NaN</code> values. If we set <code>join="inner"</code>, then only columns that exist in <em>both</em> <code>DataFrame</code>s are returned:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:618,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383204915,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="50224329-b873-490d-dd92-0e86e9021e35">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1"></a>pd.concat([city_loc, city_pop], join<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">

  <div id="df-cdf6cc26-c99b-4343-8491-4369c5d22c1c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">city</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CA</td>
<td>San Francisco</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NY</td>
<td>New York</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>FL</td>
<td>Miami</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>OH</td>
<td>Cleveland</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UT</td>
<td>Salt Lake City</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>California</td>
<td>San Francisco</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>New-York</td>
<td>New York</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Florida</td>
<td>Miami</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Texas</td>
<td>Houston</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cdf6cc26-c99b-4343-8491-4369c5d22c1c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cdf6cc26-c99b-4343-8491-4369c5d22c1c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cdf6cc26-c99b-4343-8491-4369c5d22c1c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="categories" class="level4" data-number="3.2.4.17">
<h4 data-number="3.2.4.17" class="anchored" data-anchor-id="categories"><span class="header-section-number">3.2.4.17</span> Categories</h4>
<p>It is quite frequent to have values that represent categories, for example <code>1</code> for female and <code>2</code> for male, or <code>"A"</code> for Good, <code>"B"</code> for Average, <code>"C"</code> for Bad. These categorical values can be hard to read and cumbersome to handle, but fortunately pandas makes it easy. To illustrate this, let’s take the <code>city_pop</code> <code>DataFrame</code> we created earlier, and add a column that represents a category:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:293,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383244068,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="fd370439-3bf6-4ea2-84c9-e24a17a0de97">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1"></a>city_eco <span class="op">=</span> city_pop.copy()</span>
<span id="cb170-2"><a href="#cb170-2"></a>city_eco[<span class="st">"eco_code"</span>] <span class="op">=</span> [<span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">34</span>, <span class="dv">20</span>]</span>
<span id="cb170-3"><a href="#cb170-3"></a>city_eco</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">

  <div id="df-04f602fe-bfaa-4d77-95ab-de19fd7fa3a3">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">eco_code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>808976</td>
<td>San Francisco</td>
<td>California</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>8363710</td>
<td>New York</td>
<td>New-York</td>
<td>17</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>413201</td>
<td>Miami</td>
<td>Florida</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2242193</td>
<td>Houston</td>
<td>Texas</td>
<td>20</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-04f602fe-bfaa-4d77-95ab-de19fd7fa3a3')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-04f602fe-bfaa-4d77-95ab-de19fd7fa3a3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-04f602fe-bfaa-4d77-95ab-de19fd7fa3a3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Right now the <code>eco_code</code> column is full of apparently meaningless codes. Let’s fix that. First, we will create a new categorical column based on the <code>eco_code</code>s:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:306,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383256322,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5e4367cf-6c02-4737-9fea-cad3d1fcbb64">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1"></a>city_eco[<span class="st">"economy"</span>] <span class="op">=</span> city_eco[<span class="st">"eco_code"</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb171-2"><a href="#cb171-2"></a>city_eco[<span class="st">"economy"</span>].cat.categories</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>Int64Index([17, 20, 34], dtype='int64')</code></pre>
</div>
</div>
<p>Now we can give each category a meaningful name:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:287,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383263597,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="56a34d42-d658-4af2-9737-0295479159eb">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1"></a>city_eco[<span class="st">"economy"</span>].cat.categories <span class="op">=</span> [<span class="st">"Finance"</span>, <span class="st">"Energy"</span>, <span class="st">"Tourism"</span>]</span>
<span id="cb173-2"><a href="#cb173-2"></a>city_eco</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">

  <div id="df-61c22a35-4817-462b-afff-5fa29ab1cd49">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">eco_code</th>
<th data-quarto-table-cell-role="th">economy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>808976</td>
<td>San Francisco</td>
<td>California</td>
<td>17</td>
<td>Finance</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>8363710</td>
<td>New York</td>
<td>New-York</td>
<td>17</td>
<td>Finance</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>413201</td>
<td>Miami</td>
<td>Florida</td>
<td>34</td>
<td>Tourism</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2242193</td>
<td>Houston</td>
<td>Texas</td>
<td>20</td>
<td>Energy</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-61c22a35-4817-462b-afff-5fa29ab1cd49')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-61c22a35-4817-462b-afff-5fa29ab1cd49 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-61c22a35-4817-462b-afff-5fa29ab1cd49');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Note that categorical values are sorted according to their categorical order, <em>not</em> their alphabetical order:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:304,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1677383270015,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="022c94d7-1b8a-44a5-a59d-9b78f291aa46">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1"></a>city_eco.sort_values(by<span class="op">=</span><span class="st">"economy"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">

  <div id="df-b6eec08b-ae09-45d0-b122-c8cea0fa648b">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">eco_code</th>
<th data-quarto-table-cell-role="th">economy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>413201</td>
<td>Miami</td>
<td>Florida</td>
<td>34</td>
<td>Tourism</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>2242193</td>
<td>Houston</td>
<td>Texas</td>
<td>20</td>
<td>Energy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>808976</td>
<td>San Francisco</td>
<td>California</td>
<td>17</td>
<td>Finance</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>8363710</td>
<td>New York</td>
<td>New-York</td>
<td>17</td>
<td>Finance</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b6eec08b-ae09-45d0-b122-c8cea0fa648b')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b6eec08b-ae09-45d0-b122-c8cea0fa648b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b6eec08b-ae09-45d0-b122-c8cea0fa648b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
</section>
</section>
<section id="what-next" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="what-next"><span class="header-section-number">3.3</span> What next?</h2>
<p>As you probably noticed by now, pandas is quite a large library with <em>many</em> features. Although we went through the most important features, there is still a lot to discover. Probably the best way to learn more is to get your hands dirty with some real-life data. It is also a good idea to go through pandas’ excellent <a href="http://pandas.pydata.org/pandas-docs/stable/index.html">documentation</a>, in particular the <a href="http://pandas.pydata.org/pandas-docs/stable/cookbook.html">Cookbook</a>.</p>
<p>You can also work with BigQuery in Pandas. Check out <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_gbq.html">https://pandas.pydata.org/docs/reference/api/pandas.read_gbq.html</a> and <a href="https://pandas-gbq.readthedocs.io/en/latest/">https://pandas-gbq.readthedocs.io/en/latest/</a> for more details.</p>
</section>
<section id="references" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="references"><span class="header-section-number">3.4</span> References</h2>
<ol type="1">
<li><a href="https://www.kaggle.com/learn/">https://www.kaggle.com/learn/</a></li>
<li><a href="https://github.com/ageron/handson-ml3">https://github.com/ageron/handson-ml3</a></li>
<li><a href="https://github.com/ageron/handson-ml3">https://github.com/ageron/handson-ml3</a></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02_Dataset.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Framing the problem and constructing the dataset</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_Clean_feature_engineering.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data cleaning and feature engineering</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>