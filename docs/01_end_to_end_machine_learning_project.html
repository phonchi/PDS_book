<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="phonchi">
<meta name="dcterms.date" content="2023-02-13">

<title>Practical and Innovative Analytics in Data Science - 2&nbsp; End-to-end Machine Learning project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02_Dataset.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_end_to_end_machine_learning_project.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">End-to-end Machine Learning project</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Practical and Innovative Analytics in Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_end_to_end_machine_learning_project.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">End-to-end Machine Learning project</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Framing the problem and constructing the dataset</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Relational_Database_and_data_wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Relational Database and data wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Clean_feature_engineering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data cleaning and feature engineering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Feature_selection_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Feature selection and extraction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_XAI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Explainable AI</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Deploy and monitoring</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Numpy - multidimensional data arrays for python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Colab_tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Introduction to Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kaggle-explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Introduction to Kaggle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup"><span class="header-section-number">2.1</span> Setup</a></li>
  <li><a href="#get-the-data" id="toc-get-the-data" class="nav-link" data-scroll-target="#get-the-data"><span class="header-section-number">2.2</span> Get the Data</a>
  <ul class="collapse">
  <li><a href="#download-the-data" id="toc-download-the-data" class="nav-link" data-scroll-target="#download-the-data"><span class="header-section-number">2.2.1</span> Download the Data</a></li>
  <li><a href="#take-a-quick-look-at-the-data-structure" id="toc-take-a-quick-look-at-the-data-structure" class="nav-link" data-scroll-target="#take-a-quick-look-at-the-data-structure"><span class="header-section-number">2.2.2</span> Take a Quick Look at the Data Structure</a></li>
  <li><a href="#create-a-test-set" id="toc-create-a-test-set" class="nav-link" data-scroll-target="#create-a-test-set"><span class="header-section-number">2.2.3</span> Create a Test Set</a></li>
  </ul></li>
  <li><a href="#discover-and-visualize-the-data-to-gain-insights" id="toc-discover-and-visualize-the-data-to-gain-insights" class="nav-link" data-scroll-target="#discover-and-visualize-the-data-to-gain-insights"><span class="header-section-number">2.3</span> Discover and Visualize the Data to Gain Insights</a>
  <ul class="collapse">
  <li><a href="#visualizing-geographical-data" id="toc-visualizing-geographical-data" class="nav-link" data-scroll-target="#visualizing-geographical-data"><span class="header-section-number">2.3.1</span> Visualizing Geographical Data</a></li>
  <li><a href="#looking-for-correlations" id="toc-looking-for-correlations" class="nav-link" data-scroll-target="#looking-for-correlations"><span class="header-section-number">2.3.2</span> Looking for Correlations</a></li>
  <li><a href="#experimenting-with-attribute-combinations" id="toc-experimenting-with-attribute-combinations" class="nav-link" data-scroll-target="#experimenting-with-attribute-combinations"><span class="header-section-number">2.3.3</span> Experimenting with Attribute Combinations</a></li>
  </ul></li>
  <li><a href="#prepare-the-data-for-machine-learning-algorithms" id="toc-prepare-the-data-for-machine-learning-algorithms" class="nav-link" data-scroll-target="#prepare-the-data-for-machine-learning-algorithms"><span class="header-section-number">2.4</span> Prepare the Data for Machine Learning Algorithms</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">2.4.1</span> Data Cleaning</a></li>
  <li><a href="#dealing-with-outlier-optional" id="toc-dealing-with-outlier-optional" class="nav-link" data-scroll-target="#dealing-with-outlier-optional"><span class="header-section-number">2.4.2</span> Dealing with outlier (Optional)</a></li>
  <li><a href="#handling-text-and-categorical-attributes" id="toc-handling-text-and-categorical-attributes" class="nav-link" data-scroll-target="#handling-text-and-categorical-attributes"><span class="header-section-number">2.4.3</span> Handling Text and Categorical Attributes</a></li>
  <li><a href="#feature-scaling-and-transformation" id="toc-feature-scaling-and-transformation" class="nav-link" data-scroll-target="#feature-scaling-and-transformation"><span class="header-section-number">2.4.4</span> Feature Scaling and Transformation</a></li>
  <li><a href="#custom-transformers" id="toc-custom-transformers" class="nav-link" data-scroll-target="#custom-transformers"><span class="header-section-number">2.4.5</span> Custom Transformers</a></li>
  <li><a href="#transformation-pipelines" id="toc-transformation-pipelines" class="nav-link" data-scroll-target="#transformation-pipelines"><span class="header-section-number">2.4.6</span> Transformation Pipelines</a></li>
  </ul></li>
  <li><a href="#select-and-train-a-model" id="toc-select-and-train-a-model" class="nav-link" data-scroll-target="#select-and-train-a-model"><span class="header-section-number">2.5</span> Select and Train a Model</a>
  <ul class="collapse">
  <li><a href="#training-and-evaluating-on-the-training-set" id="toc-training-and-evaluating-on-the-training-set" class="nav-link" data-scroll-target="#training-and-evaluating-on-the-training-set"><span class="header-section-number">2.5.1</span> Training and Evaluating on the Training Set</a></li>
  <li><a href="#better-evaluation-using-cross-validation" id="toc-better-evaluation-using-cross-validation" class="nav-link" data-scroll-target="#better-evaluation-using-cross-validation"><span class="header-section-number">2.5.2</span> Better Evaluation Using Cross-Validation</a></li>
  </ul></li>
  <li><a href="#fine-tune-your-model" id="toc-fine-tune-your-model" class="nav-link" data-scroll-target="#fine-tune-your-model"><span class="header-section-number">2.6</span> Fine-Tune Your Model</a>
  <ul class="collapse">
  <li><a href="#grid-search" id="toc-grid-search" class="nav-link" data-scroll-target="#grid-search"><span class="header-section-number">2.6.1</span> Grid Search</a></li>
  <li><a href="#randomized-search" id="toc-randomized-search" class="nav-link" data-scroll-target="#randomized-search"><span class="header-section-number">2.6.2</span> Randomized Search</a></li>
  <li><a href="#analyze-the-best-models-and-their-errors" id="toc-analyze-the-best-models-and-their-errors" class="nav-link" data-scroll-target="#analyze-the-best-models-and-their-errors"><span class="header-section-number">2.6.3</span> Analyze the Best Models and Their Errors</a></li>
  <li><a href="#evaluate-your-system-on-the-test-set" id="toc-evaluate-your-system-on-the-test-set" class="nav-link" data-scroll-target="#evaluate-your-system-on-the-test-set"><span class="header-section-number">2.6.4</span> Evaluate Your System on the Test Set</a></li>
  </ul></li>
  <li><a href="#launch-monitor-and-maintain-your-system" id="toc-launch-monitor-and-maintain-your-system" class="nav-link" data-scroll-target="#launch-monitor-and-maintain-your-system"><span class="header-section-number">2.7</span> Launch, Monitor, and Maintain Your System</a>
  <ul class="collapse">
  <li><a href="#deployment" id="toc-deployment" class="nav-link" data-scroll-target="#deployment"><span class="header-section-number">2.7.1</span> Deployment</a></li>
  </ul></li>
  <li><a href="#low-code-ml-using-pycaret" id="toc-low-code-ml-using-pycaret" class="nav-link" data-scroll-target="#low-code-ml-using-pycaret"><span class="header-section-number">2.8</span> Low-code ML using <code>PyCaret</code></a>
  <ul class="collapse">
  <li><a href="#get-the-data-1" id="toc-get-the-data-1" class="nav-link" data-scroll-target="#get-the-data-1"><span class="header-section-number">2.8.1</span> Get the data</a></li>
  <li><a href="#explore-the-data" id="toc-explore-the-data" class="nav-link" data-scroll-target="#explore-the-data"><span class="header-section-number">2.8.2</span> Explore the data</a></li>
  <li><a href="#prepare-the-data" id="toc-prepare-the-data" class="nav-link" data-scroll-target="#prepare-the-data"><span class="header-section-number">2.8.3</span> Prepare the data</a></li>
  <li><a href="#select-and-train-a-model-1" id="toc-select-and-train-a-model-1" class="nav-link" data-scroll-target="#select-and-train-a-model-1"><span class="header-section-number">2.8.4</span> Select and train a model</a></li>
  <li><a href="#fine-tune-your-model-1" id="toc-fine-tune-your-model-1" class="nav-link" data-scroll-target="#fine-tune-your-model-1"><span class="header-section-number">2.8.5</span> Fine-Tune your model</a></li>
  <li><a href="#analyze-the-model" id="toc-analyze-the-model" class="nav-link" data-scroll-target="#analyze-the-model"><span class="header-section-number">2.8.6</span> Analyze the model</a></li>
  <li><a href="#predict-on-test-set" id="toc-predict-on-test-set" class="nav-link" data-scroll-target="#predict-on-test-set"><span class="header-section-number">2.8.7</span> Predict on test set</a></li>
  <li><a href="#finalize-model" id="toc-finalize-model" class="nav-link" data-scroll-target="#finalize-model"><span class="header-section-number">2.8.8</span> Finalize model</a></li>
  <li><a href="#save-and-load-the-model" id="toc-save-and-load-the-model" class="nav-link" data-scroll-target="#save-and-load-the-model"><span class="header-section-number">2.8.9</span> Save and load the model</a></li>
  <li><a href="#deplpy" id="toc-deplpy" class="nav-link" data-scroll-target="#deplpy"><span class="header-section-number">2.8.10</span> Deplpy</a></li>
  </ul></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><span class="header-section-number">2.9</span> Reference</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">End-to-end Machine Learning project</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>phonchi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<table align="left">
<tbody><tr><td>
<a href="https://colab.research.google.com/github/phonchi/nsysu-math608/blob/master/static_files/presentations/01_end_to_end_machine_learning_project.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a>
</td>
<td>
<a target="_blank" href="https://kaggle.com/kernels/welcome?src=https://github.com/phonchi/nsysu-math608/blob/master/static_files/presentations/01_end_to_end_machine_learning_project.ipynb"><img src="https://kaggle.com/static/images/open-in-kaggle.svg"></a>
</td>

</tr></tbody></table>
<p><br></p>
<section id="setup" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="setup"><span class="header-section-number">2.1</span> Setup</h2>
<p>First, let’s import a few common modules, ensure MatplotLib plots figures inline and prepare a function to save the figures. We also check that Python 3.5 or later is installed (although Python 2.x may work, it is deprecated so we strongly recommend you use Python 3 instead), as well as Scikit-Learn ≥0.20.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:12380,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258267086,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="fa6d3dc0-3e6a-455f-f361-30e9d8f39290">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">!</span>pip install scikit<span class="op">-</span>learn <span class="op">-</span>U <span class="op">-</span>qq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 0.0/9.8 MB ? eta -:--:--     ━━━━━━━╸━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/9.8 MB 64.2 MB/s eta 0:00:01     ━━━━━━━━━━━━━━━━━━━━╸━━━━━━━━━━━━━━━━━━━ 5.1/9.8 MB 75.9 MB/s eta 0:00:01     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸━━━━━ 8.4/9.8 MB 80.8 MB/s eta 0:00:01     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ 9.8/9.8 MB 81.0 MB/s eta 0:00:01     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ 9.8/9.8 MB 81.0 MB/s eta 0:00:01     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 9.8/9.8 MB 50.8 MB/s eta 0:00:00</code></pre>
</div>
</div>
<p>Remember to restart the notebook to update the modules</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Python ≥3.7 is required</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> sys</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="cf">assert</span> sys.version_info <span class="op">&gt;=</span> (<span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># Scikit-Learn ≥1.2 is recommend</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="im">from</span> packaging <span class="im">import</span> version</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="im">import</span> sklearn</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="cf">assert</span> version.parse(sklearn.__version__) <span class="op">&gt;=</span> version.parse(<span class="st">"1.0.1"</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># Common imports</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="im">import</span> os</span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="im">import</span> tarfile</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="im">import</span> urllib.request</span>
<span id="cb3-17"><a href="#cb3-17"></a></span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co"># To plot pretty figures # This tells Jupyter to set up Matplotlib so it uses Jupyter’s own backend.</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co"># https://github.com/pycaret/pycaret/issues/319</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="op">%</span>config InlineBackend.figure_format <span class="op">=</span> <span class="st">'svg'</span>    </span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-25"><a href="#cb3-25"></a>mpl.rc(<span class="st">'axes'</span>, labelsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb3-26"><a href="#cb3-26"></a>mpl.rc(<span class="st">'xtick'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-27"><a href="#cb3-27"></a>mpl.rc(<span class="st">'ytick'</span>, labelsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-29"><a href="#cb3-29"></a>sns.set_context(<span class="st">"notebook"</span>)</span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co"># Where to save the figures</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>IMAGES_PATH <span class="op">=</span> Path() <span class="op">/</span> <span class="st">"images"</span> <span class="op">/</span> <span class="st">"end_to_end_project"</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>IMAGES_PATH.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-34"><a href="#cb3-34"></a></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="kw">def</span> save_fig(fig_id, tight_layout<span class="op">=</span><span class="va">True</span>, fig_extension<span class="op">=</span><span class="st">"png"</span>, resolution<span class="op">=</span><span class="dv">300</span>):</span>
<span id="cb3-36"><a href="#cb3-36"></a>    path <span class="op">=</span> IMAGES_PATH <span class="op">/</span> <span class="ss">f"</span><span class="sc">{</span>fig_id<span class="sc">}</span><span class="ss">.</span><span class="sc">{</span>fig_extension<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb3-37"><a href="#cb3-37"></a>    <span class="cf">if</span> tight_layout:</span>
<span id="cb3-38"><a href="#cb3-38"></a>        plt.tight_layout()</span>
<span id="cb3-39"><a href="#cb3-39"></a>    plt.savefig(path, <span class="bu">format</span><span class="op">=</span>fig_extension, dpi<span class="op">=</span>resolution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:36880,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258488483,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8ec07881-6ce2-40ac-ca00-2559965e7610">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb4-2"><a href="#cb4-2"></a>drive.mount(<span class="st">'/content/drive'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mounted at /content/drive</code></pre>
</div>
</div>
</section>
<section id="get-the-data" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="get-the-data"><span class="header-section-number">2.2</span> Get the Data</h2>
<section id="download-the-data" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="download-the-data"><span class="header-section-number">2.2.1</span> Download the Data</h3>
<p>It is preferable to create a small function to do that. It is useful in particular</p>
<ol type="1">
<li>If data changes regularly, as it allows you to write a small script that you can run whenever you need to fetch the latest data (or you can set up a scheduled job to do that automatically at regular intervals).</li>
<li>Automating the process of fetching the data is also useful if you need to install the dataset on multiple machines.</li>
</ol>
<p>Here is the function to fetch and load the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">def</span> load_housing_data():</span>
<span id="cb6-2"><a href="#cb6-2"></a>    <span class="co">"""When load_housing_data() is called, it looks for the datasets/housing.tgz file. If it</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">    does not find it, it creates the datasets directory inside the current directory</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">    downloads the housing.tgz file from the ageron/data GitHub repository, </span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">    and extracts its content into the datasets directory</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">    """</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>    tarball_path <span class="op">=</span> Path(<span class="st">"datasets/housing.tgz"</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="cf">if</span> <span class="kw">not</span> tarball_path.is_file():</span>
<span id="cb6-9"><a href="#cb6-9"></a>        Path(<span class="st">"datasets"</span>).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>        url <span class="op">=</span> <span class="st">"https://github.com/ageron/data/raw/main/housing.tgz"</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>        urllib.request.urlretrieve(url, tarball_path)</span>
<span id="cb6-12"><a href="#cb6-12"></a>        <span class="cf">with</span> tarfile.<span class="bu">open</span>(tarball_path) <span class="im">as</span> housing_tarball:</span>
<span id="cb6-13"><a href="#cb6-13"></a>            housing_tarball.extractall(path<span class="op">=</span><span class="st">"datasets"</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a>    <span class="cf">return</span> pd.read_csv(Path(<span class="st">"datasets/housing/housing.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="take-a-quick-look-at-the-data-structure" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="take-a-quick-look-at-the-data-structure"><span class="header-section-number">2.2.2</span> Take a Quick Look at the Data Structure</h3>
<p>Now let’s load the data using <code>Pandas</code>. Once again you should write a small function to load the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>housing <span class="op">=</span> load_housing_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>https://www.kaggle.com/camnugent/california-housing-prices</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:287,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258605221,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1fc4c39e-bdaa-42bb-d806-643023998cb1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">#Let’s take a look at the top five rows.</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>housing.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

  <div id="df-488e3e55-1271-45d4-b24a-bdba13894f0f">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-122.23</td>
<td>37.88</td>
<td>41.0</td>
<td>880.0</td>
<td>129.0</td>
<td>322.0</td>
<td>126.0</td>
<td>8.3252</td>
<td>452600.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-122.22</td>
<td>37.86</td>
<td>21.0</td>
<td>7099.0</td>
<td>1106.0</td>
<td>2401.0</td>
<td>1138.0</td>
<td>8.3014</td>
<td>358500.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-122.24</td>
<td>37.85</td>
<td>52.0</td>
<td>1467.0</td>
<td>190.0</td>
<td>496.0</td>
<td>177.0</td>
<td>7.2574</td>
<td>352100.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-122.25</td>
<td>37.85</td>
<td>52.0</td>
<td>1274.0</td>
<td>235.0</td>
<td>558.0</td>
<td>219.0</td>
<td>5.6431</td>
<td>341300.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-122.25</td>
<td>37.85</td>
<td>52.0</td>
<td>1627.0</td>
<td>280.0</td>
<td>565.0</td>
<td>259.0</td>
<td>3.8462</td>
<td>342200.0</td>
<td>NEAR BAY</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-488e3e55-1271-45d4-b24a-bdba13894f0f')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-488e3e55-1271-45d4-b24a-bdba13894f0f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-488e3e55-1271-45d4-b24a-bdba13894f0f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Each row represents one district. There are 10 attributes</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:633,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258717557,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="16e1d489-769c-476e-9e6c-95c69b299e72">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># The info() method is useful to get a quick description of the data, in particular the total number of rows, and each attribute’s type and number of non-null values</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>housing.info(), housing.shape </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20640 entries, 0 to 20639
Data columns (total 10 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   longitude           20640 non-null  float64
 1   latitude            20640 non-null  float64
 2   housing_median_age  20640 non-null  float64
 3   total_rooms         20640 non-null  float64
 4   total_bedrooms      20433 non-null  float64
 5   population          20640 non-null  float64
 6   households          20640 non-null  float64
 7   median_income       20640 non-null  float64
 8   median_house_value  20640 non-null  float64
 9   ocean_proximity     20640 non-null  object 
dtypes: float64(9), object(1)
memory usage: 1.6+ MB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(None, (20640, 10))</code></pre>
</div>
</div>
<p>Notice that the <code>total_bedrooms</code> attribute has only 20,433 non-null values, meaning that 207 districts are missing this feature. We will need to take care of this later.</p>
<p>All attributes are numerical, except for <code>ocean_proximity</code>. Its type is object, so it could hold any kind of Python object. But since you loaded this data from a CSV file, you know that it must be a text attribute. When you looked at the top five rows, you probably noticed that the values in the <code>ocean_proximity</code> column were repetitive, which means that it is probably a categorical attribute. You can find out what categories exist and how many districts belong to each category by using the <code>value_counts()</code> method.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:278,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258783939,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6f2351d2-7380-4526-8fe1-8f6c41179fb6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>housing[<span class="st">"ocean_proximity"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>&lt;1H OCEAN     9136
INLAND        6551
NEAR OCEAN    2658
NEAR BAY      2290
ISLAND           5
Name: ocean_proximity, dtype: int64</code></pre>
</div>
</div>
<p>Note that the null values are ignored below (so, for example, count of <code>total_bedrooms</code> is 20,433, not 20,640).</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:708,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258875033,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="dc0bfab7-0759-4977-b1c4-bc91fc16e84c">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>housing.describe() <span class="co"># The describe() method shows a summary of the numerical attributes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

  <div id="df-0106c99e-0d2b-4a21-8762-fffb72a5ee1c">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>20640.000000</td>
<td>20640.000000</td>
<td>20640.000000</td>
<td>20640.000000</td>
<td>20433.000000</td>
<td>20640.000000</td>
<td>20640.000000</td>
<td>20640.000000</td>
<td>20640.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>-119.569704</td>
<td>35.631861</td>
<td>28.639486</td>
<td>2635.763081</td>
<td>537.870553</td>
<td>1425.476744</td>
<td>499.539680</td>
<td>3.870671</td>
<td>206855.816909</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.003532</td>
<td>2.135952</td>
<td>12.585558</td>
<td>2181.615252</td>
<td>421.385070</td>
<td>1132.462122</td>
<td>382.329753</td>
<td>1.899822</td>
<td>115395.615874</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>-124.350000</td>
<td>32.540000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>0.499900</td>
<td>14999.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>-121.800000</td>
<td>33.930000</td>
<td>18.000000</td>
<td>1447.750000</td>
<td>296.000000</td>
<td>787.000000</td>
<td>280.000000</td>
<td>2.563400</td>
<td>119600.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>-118.490000</td>
<td>34.260000</td>
<td>29.000000</td>
<td>2127.000000</td>
<td>435.000000</td>
<td>1166.000000</td>
<td>409.000000</td>
<td>3.534800</td>
<td>179700.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>-118.010000</td>
<td>37.710000</td>
<td>37.000000</td>
<td>3148.000000</td>
<td>647.000000</td>
<td>1725.000000</td>
<td>605.000000</td>
<td>4.743250</td>
<td>264725.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>-114.310000</td>
<td>41.950000</td>
<td>52.000000</td>
<td>39320.000000</td>
<td>6445.000000</td>
<td>35682.000000</td>
<td>6082.000000</td>
<td>15.000100</td>
<td>500001.000000</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0106c99e-0d2b-4a21-8762-fffb72a5ee1c')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0106c99e-0d2b-4a21-8762-fffb72a5ee1c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0106c99e-0d2b-4a21-8762-fffb72a5ee1c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Another quick way to get a feel of the type of data you are dealing with is to plot a histogram for each numerical attribute. A histogram shows the number of instances (on the vertical axis) that have a given value range (on the horizontal axis).</p>
<p>You can either plot this one attribute at a time, or you can call the <code>hist()</code> method on the whole dataset (dataframe), and it will plot a histogram for each numerical attribute:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2236,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676258919187,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0cb2e186-f62d-40ba-cc13-67144e4c3e6b">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>housing.hist(bins<span class="op">=</span><span class="dv">50</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">8</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-11-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Notice a few things in these histograms: 1. First, the median income attribute does not look like it is expressed in US dollars (USD). After checking with the team that collected the data, you are told that the data has been scaled and capped at 15 (actually 15.0001) for higher median incomes, and at 0.5 (actually 0.4999) for lower median incomes. The numbers represent roughly tens of thousands of dollars (e.g., 3 actually means about $30,000). Working with preprocessed attributes is common in Machine Learning, and it is not necessarily a problem, but you should try to understand how the data was computed.</p>
<ol start="2" type="1">
<li>The housing median age and the median house value were also capped. The latter may be a serious problem since it is your target attribute (your labels). Your Machine Learning algorithms may learn that prices never go beyond that limit. You need to check with your client team (the team that will use your system’s output) to see if this is a problem or not. If they tell you that they need precise predictions even beyond $500,000, then you have mainly two options:</li>
</ol>
<ul>
<li>Collect proper labels for the districts whose labels were capped.</li>
<li>Remove those districts from the training set (and also from the test set, since your system should not be evaluated poorly if it predicts values beyond $500,000).</li>
</ul>
<ol start="3" type="1">
<li><p>These attributes have very different scales. We will discuss this later in this chapter when we explore feature scaling.</p></li>
<li><p>Finally, many histograms are heavy tail and skewed right: they extend much farther to the right of the median than to the left. This may make it a bit harder for some Machine Learning algorithms to detect patterns. We will try transforming these attributes later on to have more bell-shaped distributions.</p></li>
</ol>
</section>
<section id="create-a-test-set" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="create-a-test-set"><span class="header-section-number">2.2.3</span> Create a Test Set</h3>
<p>To avoid the <strong>data snooping bias</strong>. Creating a test set! This is theoretically quite simple: just pick some instances randomly, typically 20% of the dataset (or less if your dataset is very large), and set them aside</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># to make this notebook's output identical at every run</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># https://en.wikipedia.org/wiki/42_(number)</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a>train_set, test_set <span class="op">=</span> train_test_split(housing, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:267,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259105195,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="28feb908-4b06-4fa7-b41c-c3a109d4694c">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="bu">len</span>(train_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>16512</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:587,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259109510,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8a896cf5-78fe-4866-9e1f-89e03c90a7a9">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="bu">len</span>(test_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>4128</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:11,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259127948,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8d6ff95f-63ed-413e-9ec3-df1851462d8c">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>test_set.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

  <div id="df-bed72bbd-822e-4882-8a17-132085a7febf">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">20046</td>
<td>-122.38</td>
<td>40.67</td>
<td>10.0</td>
<td>2281.0</td>
<td>444.0</td>
<td>1274.0</td>
<td>438.0</td>
<td>2.2120</td>
<td>65600.0</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3024</td>
<td>-118.37</td>
<td>33.83</td>
<td>35.0</td>
<td>1207.0</td>
<td>207.0</td>
<td>601.0</td>
<td>213.0</td>
<td>4.7308</td>
<td>353400.0</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15663</td>
<td>-117.24</td>
<td>32.72</td>
<td>39.0</td>
<td>3089.0</td>
<td>431.0</td>
<td>1175.0</td>
<td>432.0</td>
<td>7.5925</td>
<td>466700.0</td>
<td>NEAR OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20484</td>
<td>-118.44</td>
<td>34.05</td>
<td>18.0</td>
<td>4780.0</td>
<td>1192.0</td>
<td>1886.0</td>
<td>1036.0</td>
<td>4.4674</td>
<td>500001.0</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9814</td>
<td>-118.44</td>
<td>34.18</td>
<td>33.0</td>
<td>2127.0</td>
<td>414.0</td>
<td>1056.0</td>
<td>391.0</td>
<td>4.3750</td>
<td>286100.0</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13311</td>
<td>-121.76</td>
<td>36.92</td>
<td>36.0</td>
<td>2096.0</td>
<td>409.0</td>
<td>1454.0</td>
<td>394.0</td>
<td>3.2216</td>
<td>238300.0</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7113</td>
<td>-120.45</td>
<td>34.91</td>
<td>16.0</td>
<td>712.0</td>
<td>147.0</td>
<td>355.0</td>
<td>162.0</td>
<td>2.5600</td>
<td>150000.0</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7668</td>
<td>-117.86</td>
<td>33.79</td>
<td>31.0</td>
<td>3523.0</td>
<td>922.0</td>
<td>2660.0</td>
<td>949.0</td>
<td>3.1792</td>
<td>146400.0</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18246</td>
<td>-117.43</td>
<td>33.91</td>
<td>15.0</td>
<td>14281.0</td>
<td>2511.0</td>
<td>7540.0</td>
<td>2245.0</td>
<td>4.3222</td>
<td>138000.0</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5723</td>
<td>-118.18</td>
<td>34.13</td>
<td>44.0</td>
<td>2734.0</td>
<td>415.0</td>
<td>1057.0</td>
<td>424.0</td>
<td>7.9213</td>
<td>477800.0</td>
<td>&lt;1H OCEAN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bed72bbd-822e-4882-8a17-132085a7febf')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bed72bbd-822e-4882-8a17-132085a7febf button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bed72bbd-822e-4882-8a17-132085a7febf');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="optional" class="level4" data-number="2.2.3.1">
<h4 data-number="2.2.3.1" class="anchored" data-anchor-id="optional"><span class="header-section-number">2.2.3.1</span> Optional</h4>
<p>So far we have considered purely random sampling methods. This is generally fine if your dataset is large enough (especially relative to the number of attributes), but if it is not, you run the risk of introducing a significant sampling bias. When a survey company decides to call 1,000 people to ask them a few questions, they don’t just pick 1,000 people randomly in a phone book. They try to ensure that these 1,000 people are <strong>representative</strong> of the whole population.</p>
<p>For example, the US population is composed of 51.3% female and 48.7% male, so a well-conducted survey in the US would try to maintain this ratio in the sample: 513 female and 487 male. This is called stratified sampling: the population is divided into homogeneous subgroups called strata, and the right number of instances is sampled from each stratum to guarantee that the <strong>test set is representative of the overall population</strong>. If they used purely random sampling, the survey results may be significantly biased.</p>
<p><strong>Suppose you chatted with experts who told you that the median income is a very important attribute to predict median housing prices</strong>. You may want to ensure that the test set is representative of the various categories of incomes in the whole dataset.</p>
<p>Since the median income is a continuous numerical attribute, you first need to create an income category attribute. Let’s look at the median income histogram more closely.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1343,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259166368,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="82391b6f-4327-4f01-c58f-3e6afebfb1aa">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>housing[<span class="st">"median_income"</span>].hist()</span>
<span id="cb22-2"><a href="#cb22-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-16-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Most median income values are clustered around 1.5 to 6 (i.e., $15,000 – $60,000), but some median incomes go far beyond 6. It is important to have a sufficient number of instances in your dataset for each stratum, or else the estimate of the stratum’s importance may be biased. This means that you <strong>should not have too many strata</strong>, and each stratum should be large enough. The following code uses the <code>pd.cut()</code> function to create an income category attribute with 5 categories (labeled from 1 to 5): category 1 ranges from 0 to 1.5 (i.e., less than $15,000), category 2 from 1.5 to 3, and so on:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>housing[<span class="st">"income_cat"</span>] <span class="op">=</span> pd.cut(housing[<span class="st">"median_income"</span>], bins<span class="op">=</span>[<span class="fl">0.</span>, <span class="fl">1.5</span>, <span class="fl">3.0</span>, <span class="fl">4.5</span>, <span class="fl">6.</span>, np.inf],</span>
<span id="cb23-2"><a href="#cb23-2"></a>                               labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259185567,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="90031550-f73b-4480-e788-69be5126f2af">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>housing[<span class="st">"income_cat"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>3    7236
2    6581
4    3639
5    2362
1     822
Name: income_cat, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:487,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259186049,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5851bcb2-61cc-456d-f953-ab044f6e7045">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>housing[<span class="st">"income_cat"</span>].hist()</span>
<span id="cb26-2"><a href="#cb26-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-19-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Now you are ready to do stratified sampling based on the income category. For this you can use Scikit-Learn’s <code>StratifiedShuffleSplit</code> class:</p>
<p>https://scikit-learn.org/stable/modules/cross_validation.html#stratified-shuffle-split</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>strat_train_set, strat_test_set <span class="op">=</span> train_test_split(</span>
<span id="cb27-2"><a href="#cb27-2"></a>    housing, test_size<span class="op">=</span><span class="fl">0.2</span>, stratify<span class="op">=</span>housing[<span class="st">"income_cat"</span>], random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see if this worked as expected. You can start by looking at the income category proportions in the test set:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259190494,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="297e44aa-226e-4245-a7e0-8e84bb4f7c09">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>strat_test_set[<span class="st">"income_cat"</span>].value_counts() <span class="op">/</span> <span class="bu">len</span>(strat_test_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>3    0.350533
2    0.318798
4    0.176357
5    0.114341
1    0.039971
Name: income_cat, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:319,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259193126,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f5905f46-2d1a-476a-e16b-e85c122fa1f3">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>housing[<span class="st">"income_cat"</span>].value_counts() <span class="op">/</span> <span class="bu">len</span>(housing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>3    0.350581
2    0.318847
4    0.176308
5    0.114438
1    0.039826
Name: income_cat, dtype: float64</code></pre>
</div>
</div>
<p>With similar code you can measure the income category proportions in the full dataset. Below we compare the income category proportions in the overall dataset, in the test set generated with stratified sampling, and in a test set generated using purely random sampling. As you can see, the test set generated using stratified sampling has income category proportions almost identical to those in the full dataset, whereas the test set generated using purely random sampling is quite skewed.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:271,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259205730,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2feadf01-7ad0-4339-8493-866a7f6844b7">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">def</span> income_cat_proportions(data):</span>
<span id="cb32-2"><a href="#cb32-2"></a>    <span class="cf">return</span> data[<span class="st">"income_cat"</span>].value_counts() <span class="op">/</span> <span class="bu">len</span>(data)</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a>train_set, test_set <span class="op">=</span> train_test_split(housing, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a></span>
<span id="cb32-6"><a href="#cb32-6"></a>compare_props <span class="op">=</span> pd.DataFrame({</span>
<span id="cb32-7"><a href="#cb32-7"></a>    <span class="st">"Overall %"</span>: income_cat_proportions(housing),</span>
<span id="cb32-8"><a href="#cb32-8"></a>    <span class="st">"Stratified %"</span>: income_cat_proportions(strat_test_set),</span>
<span id="cb32-9"><a href="#cb32-9"></a>    <span class="st">"Random %"</span>: income_cat_proportions(test_set),</span>
<span id="cb32-10"><a href="#cb32-10"></a>}).sort_index()</span>
<span id="cb32-11"><a href="#cb32-11"></a>compare_props.index.name <span class="op">=</span> <span class="st">"Income Category"</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>compare_props[<span class="st">"Strat. Error %"</span>] <span class="op">=</span> (compare_props[<span class="st">"Stratified %"</span>]<span class="op">/</span>compare_props[<span class="st">"Overall %"</span>] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb32-13"><a href="#cb32-13"></a>compare_props[<span class="st">"Rand. Error %"</span>] <span class="op">=</span> (compare_props[<span class="st">"Random %"</span>]<span class="op">/</span>compare_props[<span class="st">"Overall %"</span>] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb32-14"><a href="#cb32-14"></a>(compare_props <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

  <div id="df-1bddb129-15a0-4e06-a6d2-6c6998ee0961">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Overall %</th>
<th data-quarto-table-cell-role="th">Stratified %</th>
<th data-quarto-table-cell-role="th">Random %</th>
<th data-quarto-table-cell-role="th">Strat. Error %</th>
<th data-quarto-table-cell-role="th">Rand. Error %</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Income Category</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>3.98</td>
<td>4.00</td>
<td>4.24</td>
<td>0.36</td>
<td>6.45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>31.88</td>
<td>31.88</td>
<td>30.74</td>
<td>-0.02</td>
<td>-3.59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>35.06</td>
<td>35.05</td>
<td>34.52</td>
<td>-0.01</td>
<td>-1.53</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>17.63</td>
<td>17.64</td>
<td>18.41</td>
<td>0.03</td>
<td>4.42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>11.44</td>
<td>11.43</td>
<td>12.09</td>
<td>-0.08</td>
<td>5.63</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1bddb129-15a0-4e06-a6d2-6c6998ee0961')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1bddb129-15a0-4e06-a6d2-6c6998ee0961 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1bddb129-15a0-4e06-a6d2-6c6998ee0961');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>You won’t use the income_cat column again, so you might as well drop it, reverting the data back to its original state:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="cf">for</span> set_ <span class="kw">in</span> (strat_train_set, strat_test_set):</span>
<span id="cb33-2"><a href="#cb33-2"></a>    set_.drop(<span class="st">"income_cat"</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="discover-and-visualize-the-data-to-gain-insights" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="discover-and-visualize-the-data-to-gain-insights"><span class="header-section-number">2.3</span> Discover and Visualize the Data to Gain Insights</h2>
<p>Let’s create a copy so you can play with it without harming the training set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>housing <span class="op">=</span> strat_train_set.copy()</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">#housing = train_set.copy()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualizing-geographical-data" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="visualizing-geographical-data"><span class="header-section-number">2.3.1</span> Visualizing Geographical Data</h3>
<p>Since there is geographical information (latitude and longitude), it is a good idea to create a scatterplot of all districts to visualize the data</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2258,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259248956,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="75ec4a37-f1bc-4256-de71-99cda9a125e0">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>housing.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"longitude"</span>, y<span class="op">=</span><span class="st">"latitude"</span>, grid<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-26-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>This looks like California all right, but other than that it is hard to see any particular pattern. Setting the alpha option to 0.2 makes it much easier to visualize the places where there is a <strong>high density of data points</strong></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2996,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259315201,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="24dbdc57-1be4-4ee7-963d-71ddc5ade9b2">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>housing.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"longitude"</span>, y<span class="op">=</span><span class="st">"latitude"</span>, grid<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>save_fig(<span class="st">"better_visualization_plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
<p>Now that’s much better: you can clearly see the high-density areas, namely the Bay Area and around Los Angeles and San Diego, plus a long line of fairly high-density areas in the Central Valley.</p>
<p>Now let’s look at the housing prices (Figure 2-13). The radius of each circle represents the district’s population (option <code>s</code>), and the color represents the price (option <code>c</code>). We will use a predefined color map (option <code>cmap</code>) called <code>jet</code>, which ranges from blue (low values) to red (high prices):</p>
<p>The argument <code>sharex=False</code> fixes a display bug (the x-axis values and legend were not displayed). This is a temporary fix (see: https://github.com/pandas-dev/pandas/issues/10611 ).</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:8111,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676009794320,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a6262899-9896-4dde-f9c7-a78864ad4951">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>housing.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"longitude"</span>, y<span class="op">=</span><span class="st">"latitude"</span>, grid<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb38-2"><a href="#cb38-2"></a>             s<span class="op">=</span> housing[<span class="st">"population"</span>] <span class="op">/</span> <span class="dv">100</span>, label<span class="op">=</span><span class="st">"population"</span>,</span>
<span id="cb38-3"><a href="#cb38-3"></a>             c<span class="op">=</span><span class="st">"median_house_value"</span>, cmap<span class="op">=</span><span class="st">"jet"</span>, colorbar<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb38-4"><a href="#cb38-4"></a>             legend<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="va">False</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb38-5"><a href="#cb38-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
<p>This image tells you that the housing prices are very much related to the location (e.g., close to the ocean) and to the population density, as you probably knew already.</p>
<p>It will probably be useful to use a clustering algorithm to detect the main clusters, and add new features that measure the <strong>proximity to the cluster centers</strong>. The <code>ocean proximity</code> attribute may be useful as well, although in Northern California the housing prices in coastal districts are not too high, so it is not a simple rule.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676009823985,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6d7b7f34-4a2a-4dfb-c180-2a357bb85600">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Download the California image</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>filename <span class="op">=</span> <span class="st">"california.png"</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="cf">if</span> <span class="kw">not</span> (IMAGES_PATH <span class="op">/</span> filename).is_file():</span>
<span id="cb40-4"><a href="#cb40-4"></a>    homl3_root <span class="op">=</span> <span class="st">"https://github.com/ageron/handson-ml3/raw/main/"</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>    url <span class="op">=</span> homl3_root <span class="op">+</span> <span class="st">"images/end_to_end_project/"</span> <span class="op">+</span> filename</span>
<span id="cb40-6"><a href="#cb40-6"></a>    <span class="bu">print</span>(<span class="st">"Downloading"</span>, filename)</span>
<span id="cb40-7"><a href="#cb40-7"></a>    urllib.request.urlretrieve(url, IMAGES_PATH <span class="op">/</span> filename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading california.png</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:11189,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676009835172,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="840c8221-c808-4ce7-a53e-acf5e75d6945">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>housing_renamed <span class="op">=</span> housing.rename(columns<span class="op">=</span>{</span>
<span id="cb42-2"><a href="#cb42-2"></a>    <span class="st">"latitude"</span>: <span class="st">"Latitude"</span>, <span class="st">"longitude"</span>: <span class="st">"Longitude"</span>,</span>
<span id="cb42-3"><a href="#cb42-3"></a>    <span class="st">"population"</span>: <span class="st">"Population"</span>,</span>
<span id="cb42-4"><a href="#cb42-4"></a>    <span class="st">"median_house_value"</span>: <span class="st">"Median house value (ᴜsᴅ)"</span>})</span>
<span id="cb42-5"><a href="#cb42-5"></a>housing_renamed.plot(</span>
<span id="cb42-6"><a href="#cb42-6"></a>             kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"Longitude"</span>, y<span class="op">=</span><span class="st">"Latitude"</span>,</span>
<span id="cb42-7"><a href="#cb42-7"></a>             s<span class="op">=</span>housing_renamed[<span class="st">"Population"</span>] <span class="op">/</span> <span class="dv">100</span>, label<span class="op">=</span><span class="st">"Population"</span>,</span>
<span id="cb42-8"><a href="#cb42-8"></a>             c<span class="op">=</span><span class="st">"Median house value (ᴜsᴅ)"</span>, cmap<span class="op">=</span><span class="st">"jet"</span>, colorbar<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb42-9"><a href="#cb42-9"></a>             legend<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="va">False</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb42-10"><a href="#cb42-10"></a></span>
<span id="cb42-11"><a href="#cb42-11"></a>california_img <span class="op">=</span> plt.imread(IMAGES_PATH <span class="op">/</span> filename)</span>
<span id="cb42-12"><a href="#cb42-12"></a>axis <span class="op">=</span> <span class="op">-</span><span class="fl">124.55</span>, <span class="op">-</span><span class="fl">113.95</span>, <span class="fl">32.45</span>, <span class="fl">42.05</span></span>
<span id="cb42-13"><a href="#cb42-13"></a>plt.axis(axis)</span>
<span id="cb42-14"><a href="#cb42-14"></a>plt.imshow(california_img, extent<span class="op">=</span>axis)</span>
<span id="cb42-15"><a href="#cb42-15"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
</section>
<section id="looking-for-correlations" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="looking-for-correlations"><span class="header-section-number">2.3.2</span> Looking for Correlations</h3>
<p>Since the dataset is not too large, you can easily compute the standard correlation coefficient (also called Pearson’s r) between every pair of attributes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>corr_matrix <span class="op">=</span> housing.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s look at how much each attribute correlates with the median house value:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:257,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676259409491,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="644c7ce0-c346-47a8-ebb4-181fbaec516a">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>corr_matrix[<span class="st">"median_house_value"</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>median_house_value    1.000000
median_income         0.688380
total_rooms           0.137455
housing_median_age    0.102175
households            0.071426
total_bedrooms        0.054635
population           -0.020153
longitude            -0.050859
latitude             -0.139584
Name: median_house_value, dtype: float64</code></pre>
</div>
</div>
<p>The correlation coefficient ranges from –1 to 1. When it is close to 1, it means that there is a strong positive correlation; For example, the median house value tends to go up when the median income goes up.</p>
<p>When the coefficient is close to –1, it means that there is a strong negative correlation; you can see a small negative correlation between the latitude and the median house value (i.e., prices have a slight tendency to go down when you go north).</p>
<p>Finally, coefficients close to zero mean that there is no linear correlation. It may completely miss out on nonlinear relationships (e.g., “if x is close to zero then y generally goes up”)</p>
<p>Another way to check for correlation between attributes is to use Pandas’ <code>scatter_matrix</code> function, which plots every numerical attribute against every other numerical attribute. Since there are now 11 numerical attributes, you would get 121 plots (including index), which would not fit on a page, so let’s just focus on a few promising attributes that seem most correlated with the median housing value</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:20128,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676009911412,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3c3abdac-14eb-4386-dec4-26939ace577f">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>attributes <span class="op">=</span> [<span class="st">"median_house_value"</span>, <span class="st">"median_income"</span>, <span class="st">"total_rooms"</span>, <span class="st">"housing_median_age"</span>]</span>
<span id="cb47-2"><a href="#cb47-2"></a>plt.figure(figsize<span class="op">=</span>[<span class="dv">12</span>,<span class="dv">8</span>])</span>
<span id="cb47-3"><a href="#cb47-3"></a>sns.pairplot(housing[attributes])</span>
<span id="cb47-4"><a href="#cb47-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
<p>The most promising attribute to predict the median house value is the median income, so let’s zoom in on their correlation scatterplot</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2064,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676009958728,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="246b7408-0484-44b9-c91e-66c301dde114">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>housing.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"median_income"</span>, y<span class="op">=</span><span class="st">"median_house_value"</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, grid<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a>plt.axis([<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">550000</span>])</span>
<span id="cb49-3"><a href="#cb49-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
<p>This plot reveals a few things.</p>
<ol type="1">
<li><p>First, the correlation is indeed very strong; you can clearly see the upward trend and the points are not too dispersed.</p></li>
<li><p>Second, the price cap that we noticed earlier is clearly visible as a horizontal line at <code>$500,000</code>. But this plot reveals other less obvious straight lines: a horizontal line around <code>$450,000</code>, another around <code>$350,000</code>, perhaps one around <code>$280,000</code>, and a few more below that. You may want to try removing the corresponding districts to prevent your algorithms from learning to reproduce these data quirks.</p></li>
</ol>
</section>
<section id="experimenting-with-attribute-combinations" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="experimenting-with-attribute-combinations"><span class="header-section-number">2.3.3</span> Experimenting with Attribute Combinations</h3>
<p>Hopefully the previous sections gave you an idea of a few ways you can explore the data and gain insights.</p>
<ul>
<li>We identified a few data quirks that you may want to clean up before feeding the data to a machine learning algorithm</li>
<li>We found interesting correlations between attributes, in particular with the target attribute</li>
<li>We also noticed that some attributes have a skewed-right distribution, so you may want to transform them (e.g., by computing their logarithm or square root).</li>
</ul>
<p>Of course, your mileage will vary considerably with each project, but the general ideas are similar.</p>
<p>One last thing you may want to do before actually preparing the data for Machine Learning algorithms is to try out various attribute combinations. For example, the total number of rooms in a district is not very useful if you don’t know how many households there are. What you really want is the number of rooms per household.</p>
<p>Similarly, the total number of bedrooms by itself is not very useful: you probably want to compare it to the number of rooms. And the population per household also seems like an interesting attribute combination to look at.</p>
<p>Let’s create these new attributes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>housing[<span class="st">"rooms_per_household"</span>] <span class="op">=</span> housing[<span class="st">"total_rooms"</span>]<span class="op">/</span>housing[<span class="st">"households"</span>]</span>
<span id="cb51-2"><a href="#cb51-2"></a>housing[<span class="st">"bedrooms_ratio"</span>] <span class="op">=</span> housing[<span class="st">"total_bedrooms"</span>]<span class="op">/</span>housing[<span class="st">"total_rooms"</span>]</span>
<span id="cb51-3"><a href="#cb51-3"></a>housing[<span class="st">"population_per_household"</span>] <span class="op">=</span> housing[<span class="st">"population"</span>]<span class="op">/</span>housing[<span class="st">"households"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now let’s look at the correlation matrix again:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:289,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010084776,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="70c9eeeb-919a-48ba-ea9f-7358ac271ca9">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>corr_matrix <span class="op">=</span> housing.corr()</span>
<span id="cb52-2"><a href="#cb52-2"></a>corr_matrix[<span class="st">"median_house_value"</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>median_house_value          1.000000
median_income               0.688380
rooms_per_household         0.143663
total_rooms                 0.137455
housing_median_age          0.102175
households                  0.071426
total_bedrooms              0.054635
population                 -0.020153
population_per_household   -0.038224
longitude                  -0.050859
latitude                   -0.139584
bedrooms_ratio             -0.256397
Name: median_house_value, dtype: float64</code></pre>
</div>
</div>
<p>Hey, not bad! The new <code>bedrooms_ratio</code> attribute is much more correlated with the median house value than the total number of rooms or bedrooms. Apparently houses with a lower bedroom/room ratio tend to be more expensive. <strong>The number of rooms per household is also more informative than the total number of rooms in a district—obviously the larger the houses, the more expensive they are.</strong></p>
<p>This round of exploration does not have to be absolutely thorough; the point is to start off on the right foot and quickly gain insights that will help you get a first reasonably good prototype. But this is an <strong>iterative process</strong>: once you get a prototype up and running, you can analyze its output to gain more insights and come back to this exploration step.</p>
</section>
</section>
<section id="prepare-the-data-for-machine-learning-algorithms" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="prepare-the-data-for-machine-learning-algorithms"><span class="header-section-number">2.4</span> Prepare the Data for Machine Learning Algorithms</h2>
<p>Let’s separate the predictors and the labels since we don’t necessarily want to apply the same transformations to the predictors and the target values (note that <code>drop()</code> creates a copy of the data and does not affect <code>strat_train_set</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>housing <span class="op">=</span> strat_train_set.drop(<span class="st">"median_house_value"</span>, axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># drop labels for training set X</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>housing_labels <span class="op">=</span> strat_train_set[<span class="st">"median_house_value"</span>].copy() <span class="co"># y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-cleaning" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">2.4.1</span> Data Cleaning</h3>
<p>Most Machine Learning algorithms cannot work with missing features, so let’s create a few functions to take care of them. You noticed earlier that the <code>total_bedrooms</code> attribute has some missing values, so let’s fix this. You have three options:</p>
<ul>
<li>Get rid of the corresponding districts.</li>
<li>Get rid of the whole attribute.</li>
<li>Set the values to some value (zero, the mean, the median, etc.).</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:306,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010189176,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6248b0fb-0553-488f-b8f5-cf4cbf9f83d5">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>sample_incomplete_rows <span class="op">=</span> housing[housing.isnull().<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb55-2"><a href="#cb55-2"></a>sample_incomplete_rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

  <div id="df-7793f8f3-f26e-46b6-98ea-9cd6e16dde24">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14452</td>
<td>-120.67</td>
<td>40.50</td>
<td>15.0</td>
<td>5343.0</td>
<td>NaN</td>
<td>2503.0</td>
<td>902.0</td>
<td>3.5962</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18217</td>
<td>-117.96</td>
<td>34.03</td>
<td>35.0</td>
<td>2093.0</td>
<td>NaN</td>
<td>1755.0</td>
<td>403.0</td>
<td>3.4115</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11889</td>
<td>-118.05</td>
<td>34.04</td>
<td>33.0</td>
<td>1348.0</td>
<td>NaN</td>
<td>1098.0</td>
<td>257.0</td>
<td>4.2917</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20325</td>
<td>-118.88</td>
<td>34.17</td>
<td>15.0</td>
<td>4260.0</td>
<td>NaN</td>
<td>1701.0</td>
<td>669.0</td>
<td>5.1033</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14360</td>
<td>-117.87</td>
<td>33.62</td>
<td>8.0</td>
<td>1266.0</td>
<td>NaN</td>
<td>375.0</td>
<td>183.0</td>
<td>9.8020</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2348</td>
<td>-122.70</td>
<td>38.35</td>
<td>14.0</td>
<td>2313.0</td>
<td>NaN</td>
<td>954.0</td>
<td>397.0</td>
<td>3.7813</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">366</td>
<td>-122.50</td>
<td>37.75</td>
<td>44.0</td>
<td>1819.0</td>
<td>NaN</td>
<td>1137.0</td>
<td>354.0</td>
<td>3.4919</td>
<td>NEAR OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18241</td>
<td>-121.44</td>
<td>38.54</td>
<td>39.0</td>
<td>2855.0</td>
<td>NaN</td>
<td>1217.0</td>
<td>562.0</td>
<td>3.2404</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18493</td>
<td>-116.21</td>
<td>33.75</td>
<td>22.0</td>
<td>894.0</td>
<td>NaN</td>
<td>830.0</td>
<td>202.0</td>
<td>3.0673</td>
<td>INLAND</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16519</td>
<td>-117.86</td>
<td>34.01</td>
<td>16.0</td>
<td>4632.0</td>
<td>NaN</td>
<td>3038.0</td>
<td>727.0</td>
<td>5.1762</td>
<td>&lt;1H OCEAN</td>
</tr>
</tbody>
</table>


<p>168 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7793f8f3-f26e-46b6-98ea-9cd6e16dde24')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7793f8f3-f26e-46b6-98ea-9cd6e16dde24 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7793f8f3-f26e-46b6-98ea-9cd6e16dde24');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:566,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010219961,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1056d30a-0bb3-4830-fdaf-04b5b3b877b0">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>sample_incomplete_rows.dropna(subset<span class="op">=</span>[<span class="st">"total_bedrooms"</span>])    <span class="co"># option 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

  <div id="df-cedb77a7-d5e2-4b50-80c4-b807348d7494">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cedb77a7-d5e2-4b50-80c4-b807348d7494')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cedb77a7-d5e2-4b50-80c4-b807348d7494 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cedb77a7-d5e2-4b50-80c4-b807348d7494');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:309,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010234094,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8c27a98d-f7bf-4e06-d7c4-02d77ad30213">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>sample_incomplete_rows.drop(<span class="st">"total_bedrooms"</span>, axis<span class="op">=</span><span class="dv">1</span>)       <span class="co"># option 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

  <div id="df-5ade013d-b8e0-46af-b97b-be8cfe56b0e3">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14452</td>
<td>-120.67</td>
<td>40.50</td>
<td>15.0</td>
<td>5343.0</td>
<td>2503.0</td>
<td>902.0</td>
<td>3.5962</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18217</td>
<td>-117.96</td>
<td>34.03</td>
<td>35.0</td>
<td>2093.0</td>
<td>1755.0</td>
<td>403.0</td>
<td>3.4115</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11889</td>
<td>-118.05</td>
<td>34.04</td>
<td>33.0</td>
<td>1348.0</td>
<td>1098.0</td>
<td>257.0</td>
<td>4.2917</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20325</td>
<td>-118.88</td>
<td>34.17</td>
<td>15.0</td>
<td>4260.0</td>
<td>1701.0</td>
<td>669.0</td>
<td>5.1033</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14360</td>
<td>-117.87</td>
<td>33.62</td>
<td>8.0</td>
<td>1266.0</td>
<td>375.0</td>
<td>183.0</td>
<td>9.8020</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2348</td>
<td>-122.70</td>
<td>38.35</td>
<td>14.0</td>
<td>2313.0</td>
<td>954.0</td>
<td>397.0</td>
<td>3.7813</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">366</td>
<td>-122.50</td>
<td>37.75</td>
<td>44.0</td>
<td>1819.0</td>
<td>1137.0</td>
<td>354.0</td>
<td>3.4919</td>
<td>NEAR OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18241</td>
<td>-121.44</td>
<td>38.54</td>
<td>39.0</td>
<td>2855.0</td>
<td>1217.0</td>
<td>562.0</td>
<td>3.2404</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18493</td>
<td>-116.21</td>
<td>33.75</td>
<td>22.0</td>
<td>894.0</td>
<td>830.0</td>
<td>202.0</td>
<td>3.0673</td>
<td>INLAND</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16519</td>
<td>-117.86</td>
<td>34.01</td>
<td>16.0</td>
<td>4632.0</td>
<td>3038.0</td>
<td>727.0</td>
<td>5.1762</td>
<td>&lt;1H OCEAN</td>
</tr>
</tbody>
</table>


<p>168 rows × 8 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5ade013d-b8e0-46af-b97b-be8cfe56b0e3')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5ade013d-b8e0-46af-b97b-be8cfe56b0e3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5ade013d-b8e0-46af-b97b-be8cfe56b0e3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:370,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010252936,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0691b160-68f1-4548-eef9-1fee955288b6">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>median <span class="op">=</span> housing[<span class="st">"total_bedrooms"</span>].median()</span>
<span id="cb58-2"><a href="#cb58-2"></a>sample_incomplete_rows[<span class="st">"total_bedrooms"</span>].fillna(median, inplace<span class="op">=</span><span class="va">True</span>) <span class="co"># option 3</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>sample_incomplete_rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py:6392: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  return self._update_inplace(result)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">

  <div id="df-f8202778-d9dd-4c5e-85a8-01f43d574f88">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14452</td>
<td>-120.67</td>
<td>40.50</td>
<td>15.0</td>
<td>5343.0</td>
<td>434.0</td>
<td>2503.0</td>
<td>902.0</td>
<td>3.5962</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18217</td>
<td>-117.96</td>
<td>34.03</td>
<td>35.0</td>
<td>2093.0</td>
<td>434.0</td>
<td>1755.0</td>
<td>403.0</td>
<td>3.4115</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11889</td>
<td>-118.05</td>
<td>34.04</td>
<td>33.0</td>
<td>1348.0</td>
<td>434.0</td>
<td>1098.0</td>
<td>257.0</td>
<td>4.2917</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20325</td>
<td>-118.88</td>
<td>34.17</td>
<td>15.0</td>
<td>4260.0</td>
<td>434.0</td>
<td>1701.0</td>
<td>669.0</td>
<td>5.1033</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14360</td>
<td>-117.87</td>
<td>33.62</td>
<td>8.0</td>
<td>1266.0</td>
<td>434.0</td>
<td>375.0</td>
<td>183.0</td>
<td>9.8020</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2348</td>
<td>-122.70</td>
<td>38.35</td>
<td>14.0</td>
<td>2313.0</td>
<td>434.0</td>
<td>954.0</td>
<td>397.0</td>
<td>3.7813</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">366</td>
<td>-122.50</td>
<td>37.75</td>
<td>44.0</td>
<td>1819.0</td>
<td>434.0</td>
<td>1137.0</td>
<td>354.0</td>
<td>3.4919</td>
<td>NEAR OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18241</td>
<td>-121.44</td>
<td>38.54</td>
<td>39.0</td>
<td>2855.0</td>
<td>434.0</td>
<td>1217.0</td>
<td>562.0</td>
<td>3.2404</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18493</td>
<td>-116.21</td>
<td>33.75</td>
<td>22.0</td>
<td>894.0</td>
<td>434.0</td>
<td>830.0</td>
<td>202.0</td>
<td>3.0673</td>
<td>INLAND</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16519</td>
<td>-117.86</td>
<td>34.01</td>
<td>16.0</td>
<td>4632.0</td>
<td>434.0</td>
<td>3038.0</td>
<td>727.0</td>
<td>5.1762</td>
<td>&lt;1H OCEAN</td>
</tr>
</tbody>
</table>


<p>168 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f8202778-d9dd-4c5e-85a8-01f43d574f88')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f8202778-d9dd-4c5e-85a8-01f43d574f88 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f8202778-d9dd-4c5e-85a8-01f43d574f88');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>If you choose option 3, you should compute the median value on the training set, and use it to fill the missing values in the training set, but also don’t forget to <strong>save the median value</strong> that you have computed. You will need it later to replace missing values in the test set when you want to evaluate your system, and also once the system goes live to replace missing values in new data.</p>
<p><code>Scikit-Learn</code> provides a handy class to take care of missing values: <code>SimpleImputer</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb60-2"><a href="#cb60-2"></a>imputer <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since the median can only be computed on numerical attributes, you then need to create a copy of the data with only the numerical attributes (this will exclude the text attribute <code>ocean_proximity</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>housing_num <span class="op">=</span> housing.select_dtypes(include<span class="op">=</span>[np.number])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:283,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010315806,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="51b5a050-9679-4d6d-ce67-279d51e72ccf">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>imputer.fit(housing_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SimpleImputer(strategy='median')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div></div></div>
</div>
</div>
<blockquote class="blockquote">
<p>All objects in SKlearn share a consistent and simple interface: 1. <strong>Estimators</strong>: Any object that can estimate some parameters based on a dataset is called an estimator (e.g., a <code>SimpleImputer</code> is an estimator). The estimation itself is performed by the <code>fit()</code> method, and it takes a dataset as a parameter, or two for supervised learning algorithms—the second dataset contains the labels. Any other parameter needed to guide the estimation process is considered a hyperparameter (such as a <code>SimpleImputer</code>’s strategy), and it must be set as an instance variable (generally via a constructor parameter). 2. <strong>Transformers</strong>: Some estimators (such as a <code>SimpleImputer</code>) can also transform a dataset; these are called transformers. Once again, the API is simple: the transformation is performed by the <code>transform()</code> method with the dataset to transform as a parameter. It returns the transformed dataset. This transformation generally relies on the learned parameters, as is the case for a <code>SimpleImputer</code>. All transformers also have a convenience method called <code>fit_transform()</code>, which is equivalent to calling <code>fit()</code> and then <code>transform()</code> (but sometimes <code>fit_transform()</code> is optimized and runs much faster). 3. <strong>Predictors</strong>: Finally, some estimators, given a dataset, are capable of making predictions; they are called predictors. For example, the <code>LinearRegression</code> model was a predictor. A predictor has a <code>predict()</code> method that takes a dataset of new instances and returns a dataset of corresponding predictions. It also has a <code>score()</code> method that measures the quality of the predictions, given a test set (and the corresponding labels, in the case of supervised learning algorithms).</p>
</blockquote>
<blockquote class="blockquote">
<p>As with all estimators, it is important to fit the scalers to the training data only: never use <code>fit()</code> or <code>fit_transform()</code> for anything else than the training set. Once you have a trained scaler, you can then use it to <code>transform()</code> any other set, including the validation set, the test set, and new data.</p>
</blockquote>
<p>The imputer has simply computed the median of each attribute and stored the result in its <code>statistics_</code> instance variable. Only the <code>total_bedrooms</code> attribute had missing values, <strong>but we cannot be sure that there won’t be any missing values in new data after the system goes live</strong>, so it is safer to apply the imputer to all the numerical attributes:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:444,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010426750,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5f034dc1-5d0a-4201-8063-50cb48e41835">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>imputer.statistics_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>array([-118.51  ,   34.26  ,   29.    , 2125.    ,  434.    , 1167.    ,
        408.    ,    3.5385])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:306,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010441654,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="bcfa48ab-56aa-4345-d5ea-9a3d25aca050">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>imputer.feature_names_in_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>array(['longitude', 'latitude', 'housing_median_age', 'total_rooms',
       'total_bedrooms', 'population', 'households', 'median_income'],
      dtype=object)</code></pre>
</div>
</div>
<p>Now you can use this “trained” imputer to transform the training set by replacing missing values with the learned medians:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>X <span class="op">=</span> imputer.transform(housing_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The result is a plain NumPy array containing the transformed features. If you want to put it back into a Pandas DataFrame, it’s simple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a><span class="co">#housing_tr = pd.DataFrame(X, columns=housing_num.columns, index=housing_num.index)</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="im">from</span> sklearn <span class="im">import</span> config_context</span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="cf">with</span> config_context(transform_output<span class="op">=</span><span class="st">"pandas"</span>):</span>
<span id="cb68-4"><a href="#cb68-4"></a>    housing_tr <span class="op">=</span> imputer.transform(housing_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>See https://scikit-learn.org/stable/auto_examples/miscellaneous/plot_set_output.html#sphx-glr-auto-examples-miscellaneous-plot-set-output-py</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:317,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010515265,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ab2f8939-7226-47fc-bba4-daff1aa1b14f">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>housing_tr.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

  <div id="df-f8a2160d-97f6-49b5-a32d-8ea55817567b">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">13096</td>
<td>-122.42</td>
<td>37.80</td>
<td>52.0</td>
<td>3321.0</td>
<td>1115.0</td>
<td>1576.0</td>
<td>1034.0</td>
<td>2.0987</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14973</td>
<td>-118.38</td>
<td>34.14</td>
<td>40.0</td>
<td>1965.0</td>
<td>354.0</td>
<td>666.0</td>
<td>357.0</td>
<td>6.0876</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3785</td>
<td>-121.98</td>
<td>38.36</td>
<td>33.0</td>
<td>1083.0</td>
<td>217.0</td>
<td>562.0</td>
<td>203.0</td>
<td>2.4330</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14689</td>
<td>-117.11</td>
<td>33.75</td>
<td>17.0</td>
<td>4174.0</td>
<td>851.0</td>
<td>1845.0</td>
<td>780.0</td>
<td>2.2618</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20507</td>
<td>-118.15</td>
<td>33.77</td>
<td>36.0</td>
<td>4366.0</td>
<td>1211.0</td>
<td>1912.0</td>
<td>1172.0</td>
<td>3.5292</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f8a2160d-97f6-49b5-a32d-8ea55817567b')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f8a2160d-97f6-49b5-a32d-8ea55817567b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f8a2160d-97f6-49b5-a32d-8ea55817567b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="dealing-with-outlier-optional" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="dealing-with-outlier-optional"><span class="header-section-number">2.4.2</span> Dealing with outlier (Optional)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> IsolationForest</span>
<span id="cb70-2"><a href="#cb70-2"></a></span>
<span id="cb70-3"><a href="#cb70-3"></a>isolation_forest <span class="op">=</span> IsolationForest(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb70-4"><a href="#cb70-4"></a>outlier_pred <span class="op">=</span> isolation_forest.fit_predict(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you wanted to drop outliers, you would run the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>outlier_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a><span class="co">#housing = housing.iloc[outlier_pred == 1]</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="co">#housing_labels = housing_labels.iloc[outlier_pred == 1]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="handling-text-and-categorical-attributes" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="handling-text-and-categorical-attributes"><span class="header-section-number">2.4.3</span> Handling Text and Categorical Attributes</h3>
<p>So far we have only dealt with numerical attributes, but your data may also contain text attributes. In this dataset, there is just one: the <code>ocean_proximity</code> attribute. Let’s look at its value for the first few instances:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010576373,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0759fd77-a30f-45b9-d020-6d080cff1dad">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>housing_cat <span class="op">=</span> housing[[<span class="st">"ocean_proximity"</span>]] <span class="co"># Note the double square bracket</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>housing_cat.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">

  <div id="df-9f63c914-53de-48eb-92b1-d96324c5e730">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">13096</td>
<td>NEAR BAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14973</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3785</td>
<td>INLAND</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14689</td>
<td>INLAND</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20507</td>
<td>NEAR OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1286</td>
<td>INLAND</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18078</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4396</td>
<td>NEAR BAY</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18031</td>
<td>&lt;1H OCEAN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6753</td>
<td>&lt;1H OCEAN</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9f63c914-53de-48eb-92b1-d96324c5e730')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9f63c914-53de-48eb-92b1-d96324c5e730 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9f63c914-53de-48eb-92b1-d96324c5e730');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Most Machine Learning algorithms prefer to work with numbers anyway, so let’s convert these categories from text to numbers.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010608156,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="77eab023-b9a9-44e4-f7c4-7017c789da50">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb74-2"><a href="#cb74-2"></a></span>
<span id="cb74-3"><a href="#cb74-3"></a>ordinal_encoder <span class="op">=</span> OrdinalEncoder()</span>
<span id="cb74-4"><a href="#cb74-4"></a>housing_cat_encoded <span class="op">=</span> ordinal_encoder.fit_transform(housing_cat)</span>
<span id="cb74-5"><a href="#cb74-5"></a>housing_cat_encoded[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>array([[3.],
       [0.],
       [1.],
       [1.],
       [4.],
       [1.],
       [0.],
       [3.],
       [0.],
       [0.]])</code></pre>
</div>
</div>
<p>You can get the list of categories using the <code>categories_</code> instance variable. It is a list containing a 1D array of categories for each categorical attribute (in this case, a list containing a single array since there is just one categorical attribute):</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010619503,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2e080c14-979d-4e4a-ebea-298668e66091">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>ordinal_encoder.categories_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>[array(['&lt;1H OCEAN', 'INLAND', 'ISLAND', 'NEAR BAY', 'NEAR OCEAN'],
       dtype=object)]</code></pre>
</div>
</div>
<p>One issue with this representation is that ML algorithms will <strong>assume that two nearby values are more similar than two distant values</strong>. This may be fine in some cases (e.g., for ordered categories such as “bad”, “average”, “good”, “excellent”), but it is obviously not the case for the <code>ocean_proximity</code> column (for example, categories 0 and 4 are clearly more similar than categories 0 and 1).</p>
<p>To fix this issue, a common solution is to create one binary attribute per category: one attribute equal to 1 when the category is “&lt;1H OCEAN” (and 0 otherwise), another attribute equal to 1 when the category is “INLAND” (and 0 otherwise), and so on. This is called <strong>one-hot encoding</strong>, because only one attribute will be equal to 1 (hot), while the others will be 0 (cold). The new attributes are sometimes called dummy attributes. Scikit-Learn provides a <code>OneHotEncoder</code> class to convert categorical values into one-hot vectors</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:312,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010640892,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="915e2e1e-534c-4e90-a1f5-01e300ccf0d4">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb78-2"><a href="#cb78-2"></a></span>
<span id="cb78-3"><a href="#cb78-3"></a>cat_encoder <span class="op">=</span> OneHotEncoder()</span>
<span id="cb78-4"><a href="#cb78-4"></a>housing_cat_1hot <span class="op">=</span> cat_encoder.fit_transform(housing_cat)</span>
<span id="cb78-5"><a href="#cb78-5"></a>housing_cat_1hot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>&lt;16512x5 sparse matrix of type '&lt;class 'numpy.float64'&gt;'
    with 16512 stored elements in Compressed Sparse Row format&gt;</code></pre>
</div>
</div>
<p>By default, the <code>OneHotEncoder</code> class returns a sparse array, but we can convert it to a dense array if needed by calling the <code>toarray()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010642588,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="006bafd4-530a-4139-eefa-91764af6c48b">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a>housing_cat_1hot.toarray()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>array([[0., 0., 0., 1., 0.],
       [1., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0.],
       ...,
       [0., 0., 0., 0., 1.],
       [1., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1.]])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:315,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010649862,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="603d7bfb-2b83-4bf1-fe6f-f1d52ef24242">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a>cat_encoder.categories_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>[array(['&lt;1H OCEAN', 'INLAND', 'ISLAND', 'NEAR BAY', 'NEAR OCEAN'],
       dtype=object)]</code></pre>
</div>
</div>
<p>The advantage of <code>OneHotEncoder</code> over <code>get_dummies()</code> is that</p>
<ol type="1">
<li><p>It remembers which categories it was trained on. This is very important because once your model is in production, it should be fed exactly the same features as during training: no more, no less.</p></li>
<li><p><code>OneHotEncoder</code> is smarter: it will detect the unknown category and raise an exception. If you prefer, you can set the <code>handle_unknown</code> hyperparameter to <code>"ignore"</code>, in which case it will just represent the unknown category with zeros</p></li>
</ol>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010678303,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d358339e-17cb-44d5-aa7c-c94fbc8af8e9">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>df_test_unknown <span class="op">=</span> pd.DataFrame({<span class="st">"ocean_proximity"</span>: [<span class="st">"&lt;2H OCEAN"</span>, <span class="st">"ISLAND"</span>]})</span>
<span id="cb84-2"><a href="#cb84-2"></a>pd.get_dummies(df_test_unknown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

  <div id="df-fcd0663e-186e-4291-90f8-218699b11679">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;2H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fcd0663e-186e-4291-90f8-218699b11679')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fcd0663e-186e-4291-90f8-218699b11679 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fcd0663e-186e-4291-90f8-218699b11679');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010680100,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0a918b16-8ca2-490d-8832-0b59310d1727">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1"></a>cat_encoder.handle_unknown <span class="op">=</span> <span class="st">"ignore"</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>cat_encoder.transform(df_test_unknown).toarray()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>array([[0., 0., 0., 0., 0.],
       [0., 0., 1., 0., 0.]])</code></pre>
</div>
</div>
<p>If a categorical attribute has a large number of possible categories (e.g., country code, profession, species, etc.), then one-hot encoding will result in a large number of input features. <strong>This may slow down training and degrade performance</strong>.</p>
<p>If this happens, you may want to replace the categorical input with useful numerical features related to the categories: for example, you could replace the <code>ocean_proximity</code> feature with the distance to the ocean (similarly, a country code could be replaced with the country’s population and GDP per capita).</p>
<p>Alternatively, you could replace each category with a learnable low dimensional vector called an embedding. Each category’s representation would be learned during training: this is an example of <strong>representation learning</strong>.</p>
<p>When you fit any Scikit-Learn estimator using a DataFrame, the estimator stores the column names in the <code>feature_names_in_</code> attribute. Scikit-Learn then ensures that any DataFrame fed to this estimator after that (e.g., to <code>transform()</code> or <code>predict()</code>) has the same column names. Transformers also provide a <code>get_feature_names_out()</code> method that you can use to build a DataFrame around the transformer’s output:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:283,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010706167,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="088fa2dc-7ad0-4928-d3ef-7238f001c6e7">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1"></a>cat_encoder.feature_names_in_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>array(['ocean_proximity'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:492,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010711041,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="93c3aa9f-e8f4-4dbf-b783-bf22881d12e9">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a>cat_encoder.get_feature_names_out()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>array(['ocean_proximity_&lt;1H OCEAN', 'ocean_proximity_INLAND',
       'ocean_proximity_ISLAND', 'ocean_proximity_NEAR BAY',
       'ocean_proximity_NEAR OCEAN'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:285,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010753463,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ba6dff27-987d-4016-9d20-c3e920101b7d">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a>df_test_unknown <span class="op">=</span> pd.DataFrame({<span class="st">"ocean_proximity"</span>: [<span class="st">"&lt;2H OCEAN"</span>, <span class="st">"ISLAND"</span>]})</span>
<span id="cb91-2"><a href="#cb91-2"></a>df_output <span class="op">=</span> pd.DataFrame(cat_encoder.transform(df_test_unknown).toarray(),</span>
<span id="cb91-3"><a href="#cb91-3"></a>                         columns<span class="op">=</span>cat_encoder.get_feature_names_out(),</span>
<span id="cb91-4"><a href="#cb91-4"></a>                         index<span class="op">=</span>df_test_unknown.index)</span>
<span id="cb91-5"><a href="#cb91-5"></a>df_output</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">

  <div id="df-9d7033a3-46c3-4973-8226-1d81d737d5de">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR OCEAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9d7033a3-46c3-4973-8226-1d81d737d5de')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9d7033a3-46c3-4973-8226-1d81d737d5de button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9d7033a3-46c3-4973-8226-1d81d737d5de');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="feature-scaling-and-transformation" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="feature-scaling-and-transformation"><span class="header-section-number">2.4.4</span> Feature Scaling and Transformation</h3>
<p>One of the most important transformations you need to apply to your data is feature scaling. With few exceptions, machine learning algorithms don’t perform well when the input numerical attributes have very different scales. This is the case for the housing data: the total number of rooms ranges from about 6 to 39,320, while the median incomes only range from 0 to 15. Without any scaling, most models will be biased toward ignoring the median income and focusing more on the number of rooms.</p>
<section id="min-max-scaling" class="level4" data-number="2.4.4.1">
<h4 data-number="2.4.4.1" class="anchored" data-anchor-id="min-max-scaling"><span class="header-section-number">2.4.4.1</span> Min-max scaling</h4>
<p>Min-max scaling (many people call this <strong>normalization</strong>) is the simplest: for each attribute, the values are shifted and rescaled so that they end up ranging from 0 to 1. This is performed by subtracting the min value and dividing by the difference between the min and the max. Scikit-Learn provides a transformer called <code>MinMaxScaler</code> for this. It has a <code>feature_range</code> hyperparameter that lets you change the range if, for some reason, you don’t want 0–1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb92-2"><a href="#cb92-2"></a></span>
<span id="cb92-3"><a href="#cb92-3"></a>min_max_scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb92-4"><a href="#cb92-4"></a>housing_num_min_max_scaled <span class="op">=</span> min_max_scaler.fit_transform(housing_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="standardization" class="level4" data-number="2.4.4.2">
<h4 data-number="2.4.4.2" class="anchored" data-anchor-id="standardization"><span class="header-section-number">2.4.4.2</span> Standardization</h4>
<p>Standardization is different: first it subtracts the mean value (so standardized values have a zero mean), then it divides the result by the standard deviation (so standardized values have a standard deviation equal to 1). Unlike min-max scaling, standardization does not restrict values to a specific range. <strong>However, standardization is much less affected by outliers</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb93-2"><a href="#cb93-2"></a></span>
<span id="cb93-3"><a href="#cb93-3"></a>std_scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb93-4"><a href="#cb93-4"></a>housing_num_std_scaled <span class="op">=</span> std_scaler.fit_transform(housing_num)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="other-scaling-optional" class="level4" data-number="2.4.4.3">
<h4 data-number="2.4.4.3" class="anchored" data-anchor-id="other-scaling-optional"><span class="header-section-number">2.4.4.3</span> Other scaling (Optional)</h4>
<p>When a feature’s distribution has a heavy tail (i.e., when values far from the mean are not exponentially rare), both min-max scaling and standardization will squash most values into a small range. Machine learning models generally don’t like this at all. So before you scale the feature, you should first transform it to shrink the heavy tail, and if possible to make the distribution roughly symmetrical. For example, a common way to do this for positive features with a heavy tail to the right is to replace the feature with its <strong>square root</strong> (or raise the feature to a power between 0 and 1). If the feature has a really long and heavy tail, such as a power law distribution, then replacing the feature with its <strong>logarithm</strong> may help.</p>
<p>For example, the population feature roughly follows a power law</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:881,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010813677,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d3a59426-345e-4375-c4ed-33676f980755">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">3</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb94-2"><a href="#cb94-2"></a>housing[<span class="st">"population"</span>].hist(ax<span class="op">=</span>axs[<span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb94-3"><a href="#cb94-3"></a>housing[<span class="st">"population"</span>].<span class="bu">apply</span>(np.log).hist(ax<span class="op">=</span>axs[<span class="dv">1</span>], bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb94-4"><a href="#cb94-4"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">"Population"</span>)</span>
<span id="cb94-5"><a href="#cb94-5"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">"Log of population"</span>)</span>
<span id="cb94-6"><a href="#cb94-6"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">"Number of districts"</span>)</span>
<span id="cb94-7"><a href="#cb94-7"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-66-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Another approach to handle heavy-tailed features consists in <strong>bucketizing</strong> the feature. This means chopping its distribution into roughly equal-sized buckets, and replacing each feature value with the index of the bucket it belongs to. For example, you could replace each value with its percentile. Bucketizing with equal-sized buckets results in a feature with an almost uniform distribution, so there’s no need for further scaling, or you can just divide by the number of buckets to force the values to the 0–1 range.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:332,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010822946,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="508fc394-2c18-4122-b9b4-d2bec06b7735">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a>percentiles <span class="op">=</span> [np.percentile(housing[<span class="st">"median_income"</span>], p) <span class="cf">for</span> p <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>)]</span>
<span id="cb95-2"><a href="#cb95-2"></a>flattened_median_income <span class="op">=</span> pd.cut(housing[<span class="st">"median_income"</span>], bins<span class="op">=</span>[<span class="op">-</span>np.inf] <span class="op">+</span> percentiles <span class="op">+</span> [np.inf], labels<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb95-3"><a href="#cb95-3"></a>flattened_median_income.hist(bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb95-4"><a href="#cb95-4"></a>plt.xlabel(<span class="st">"Median income percentile"</span>)</span>
<span id="cb95-5"><a href="#cb95-5"></a>plt.ylabel(<span class="st">"Number of districts"</span>)</span>
<span id="cb95-6"><a href="#cb95-6"></a>plt.show()</span>
<span id="cb95-7"><a href="#cb95-7"></a><span class="co"># Note: incomes below the 1st percentile are labeled 1, and incomes above the</span></span>
<span id="cb95-8"><a href="#cb95-8"></a><span class="co"># 99th percentile are labeled 100. This is why the distribution below ranges</span></span>
<span id="cb95-9"><a href="#cb95-9"></a><span class="co"># from 1 to 100 (not 0 to 100).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-67-output-1.svg" class="img-fluid"></p>
</div>
</div>
<blockquote class="blockquote">
<p>When a feature has a multimodal distribution (i.e., with two or more clear peaks, called modes), such as the <code>housing_median_age</code> feature, it can also be helpful to bucketize it, <strong>but this time treating the bucket IDs as categories</strong>, rather than as numerical values. This means that the bucket indices must be encoded, for example using a <code>OneHotEncoder</code> (so you usually don’t want to use too many buckets). This approach will allow the regression model to more easily learn different rules for different ranges of this feature value.</p>
</blockquote>
<p>For example, perhaps houses built around 35 years ago have a peculiar style that fell out of fashion, and therefore they’re cheaper than their age alone would suggest.</p>
<p>Another approach to transforming multimodal distributions is to add a feature for each of the modes (at least the main ones), representing the similarity between the housing median age and that particular mode. The similarity measure is typically computed using a radial basis function (RBF). Using Scikit-Learn’s <code>rbf_kernel()</code> function, you can create a new Gaussian RBF feature measuring the similarity between the housing median age and 35:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:956,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676010878323,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="39222bde-7a8c-4e09-81ac-daac214ae267">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a><span class="im">from</span> sklearn.metrics.pairwise <span class="im">import</span> rbf_kernel</span>
<span id="cb96-2"><a href="#cb96-2"></a></span>
<span id="cb96-3"><a href="#cb96-3"></a>ages <span class="op">=</span> np.linspace(housing[<span class="st">"housing_median_age"</span>].<span class="bu">min</span>(),</span>
<span id="cb96-4"><a href="#cb96-4"></a>                   housing[<span class="st">"housing_median_age"</span>].<span class="bu">max</span>(),</span>
<span id="cb96-5"><a href="#cb96-5"></a>                   <span class="dv">500</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb96-6"><a href="#cb96-6"></a>gamma1 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb96-7"><a href="#cb96-7"></a>gamma2 <span class="op">=</span> <span class="fl">0.03</span></span>
<span id="cb96-8"><a href="#cb96-8"></a>rbf1 <span class="op">=</span> rbf_kernel(ages, [[<span class="dv">35</span>]], gamma<span class="op">=</span>gamma1)</span>
<span id="cb96-9"><a href="#cb96-9"></a>rbf2 <span class="op">=</span> rbf_kernel(ages, [[<span class="dv">35</span>]], gamma<span class="op">=</span>gamma2)</span>
<span id="cb96-10"><a href="#cb96-10"></a></span>
<span id="cb96-11"><a href="#cb96-11"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb96-12"><a href="#cb96-12"></a></span>
<span id="cb96-13"><a href="#cb96-13"></a>ax1.set_xlabel(<span class="st">"Housing median age"</span>)</span>
<span id="cb96-14"><a href="#cb96-14"></a>ax1.set_ylabel(<span class="st">"Number of districts"</span>)</span>
<span id="cb96-15"><a href="#cb96-15"></a>ax1.hist(housing[<span class="st">"housing_median_age"</span>], bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb96-16"><a href="#cb96-16"></a></span>
<span id="cb96-17"><a href="#cb96-17"></a>ax2 <span class="op">=</span> ax1.twinx()  <span class="co"># create a twin axis that shares the same x-axis</span></span>
<span id="cb96-18"><a href="#cb96-18"></a>color <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb96-19"><a href="#cb96-19"></a>ax2.plot(ages, rbf1, color<span class="op">=</span>color, label<span class="op">=</span><span class="st">"gamma = 0.10"</span>)</span>
<span id="cb96-20"><a href="#cb96-20"></a>ax2.plot(ages, rbf2, color<span class="op">=</span>color, label<span class="op">=</span><span class="st">"gamma = 0.03"</span>, linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb96-21"><a href="#cb96-21"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelcolor<span class="op">=</span>color)</span>
<span id="cb96-22"><a href="#cb96-22"></a>ax2.set_ylabel(<span class="st">"Age similarity"</span>, color<span class="op">=</span>color)</span>
<span id="cb96-23"><a href="#cb96-23"></a></span>
<span id="cb96-24"><a href="#cb96-24"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb96-25"><a href="#cb96-25"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-68-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>As the chart shows, the new age similarity feature peaks at 35, right around the spike in the housing median age distribution: if this particular age group is well correlated with lower prices, there’s a good chance that this new feature will help.</p>
</section>
</section>
<section id="custom-transformers" class="level3" data-number="2.4.5">
<h3 data-number="2.4.5" class="anchored" data-anchor-id="custom-transformers"><span class="header-section-number">2.4.5</span> Custom Transformers</h3>
<p>Although <code>Scikit-Learn</code> provides many useful transformers, you will need to write your own for tasks such as custom cleanup operations or combining specific attributes.</p>
<section id="function-with-no-training-parameter-optional" class="level4" data-number="2.4.5.1">
<h4 data-number="2.4.5.1" class="anchored" data-anchor-id="function-with-no-training-parameter-optional"><span class="header-section-number">2.4.5.1</span> Function with no training parameter (Optional)</h4>
<p>For transformations that don’t require any training, you can just write a function that takes a NumPy array as input and outputs the transformed. Let’s create a log-transformer and apply it to the <code>population</code> feature:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> FunctionTransformer</span>
<span id="cb97-2"><a href="#cb97-2"></a>log_transformer <span class="op">=</span> FunctionTransformer(np.log, inverse_func<span class="op">=</span>np.exp)</span>
<span id="cb97-3"><a href="#cb97-3"></a>log_pop <span class="op">=</span> log_transformer.transform(housing[[<span class="st">"population"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transform-with-training-parameter" class="level4" data-number="2.4.5.2">
<h4 data-number="2.4.5.2" class="anchored" data-anchor-id="transform-with-training-parameter"><span class="header-section-number">2.4.5.2</span> Transform with training parameter</h4>
<p><code>FunctionTransformer</code> is very handy, but what if you would like your transformer to be trainable, learning some parameters in the <code>fit()</code> method and using them later in the <code>transform()</code> method? You can get <code>fit_transform()</code> for free by simply adding <code>TransformerMixin</code> as a base class: the default implementation will just call <code>fit()</code> and then <code>transform()</code>. If you add <code>BaseEstimator</code> as a base class (and avoid using <code>*args</code> and <code>**kwargs</code> in your constructor), you will also get two extra methods: <code>get_params()</code> and <code>set_params()</code>. These will be useful for automatic hyperparameter tuning.</p>
<p>For example, the following code demonstrates custom transformer that uses a KMeans clusterer in the <code>fit()</code> method to identify the main clusters in the training data, and then uses <code>rbf_kernel()</code> in the <code>transform()</code> method to measure how similar each sample is to each cluster center:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a><span class="im">from</span> sklearn.base <span class="im">import</span> BaseEstimator, TransformerMixin</span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb98-3"><a href="#cb98-3"></a></span>
<span id="cb98-4"><a href="#cb98-4"></a><span class="kw">class</span> ClusterSimilarity(BaseEstimator, TransformerMixin):</span>
<span id="cb98-5"><a href="#cb98-5"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, n_clusters<span class="op">=</span><span class="dv">10</span>, gamma<span class="op">=</span><span class="fl">1.0</span>, random_state<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb98-6"><a href="#cb98-6"></a>        <span class="va">self</span>.n_clusters <span class="op">=</span> n_clusters</span>
<span id="cb98-7"><a href="#cb98-7"></a>        <span class="va">self</span>.gamma <span class="op">=</span> gamma</span>
<span id="cb98-8"><a href="#cb98-8"></a>        <span class="va">self</span>.random_state <span class="op">=</span> random_state</span>
<span id="cb98-9"><a href="#cb98-9"></a></span>
<span id="cb98-10"><a href="#cb98-10"></a>    <span class="kw">def</span> fit(<span class="va">self</span>, X, y<span class="op">=</span><span class="va">None</span>, sample_weight<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb98-11"><a href="#cb98-11"></a>        <span class="va">self</span>.kmeans_ <span class="op">=</span> KMeans(<span class="va">self</span>.n_clusters, random_state<span class="op">=</span><span class="va">self</span>.random_state)</span>
<span id="cb98-12"><a href="#cb98-12"></a>        <span class="va">self</span>.kmeans_.fit(X, sample_weight<span class="op">=</span>sample_weight)</span>
<span id="cb98-13"><a href="#cb98-13"></a>        <span class="cf">return</span> <span class="va">self</span>  <span class="co"># always return self!</span></span>
<span id="cb98-14"><a href="#cb98-14"></a></span>
<span id="cb98-15"><a href="#cb98-15"></a>    <span class="kw">def</span> transform(<span class="va">self</span>, X):</span>
<span id="cb98-16"><a href="#cb98-16"></a>        <span class="cf">return</span> rbf_kernel(X, <span class="va">self</span>.kmeans_.cluster_centers_, gamma<span class="op">=</span><span class="va">self</span>.gamma)</span>
<span id="cb98-17"><a href="#cb98-17"></a>    </span>
<span id="cb98-18"><a href="#cb98-18"></a>    <span class="kw">def</span> get_feature_names_out(<span class="va">self</span>, names<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb98-19"><a href="#cb98-19"></a>        <span class="cf">return</span> [<span class="ss">f"Cluster </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> similarity"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_clusters)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>K-means is a clustering algorithm that locates clusters in the data. How many it searches for is controlled by the <code>n_clusters</code> hyperparameter. After training, the cluster centers are available via the <code>cluster_centers_</code> attribute. The <code>fit()</code> method of KMeans supports an optional argument <code>sample_weight</code>, which lets the user specify the relative weights of the samples. k-means is a stochastic algorithm, meaning that it relies on randomness to locate the clusters, so if you want reproducible results, you must set the <code>random_state</code> parameter. As you can see, despite the complexity of the task, the code is fairly straightforward. Now let’s use this custom transformer:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2168,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011010624,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a8f8d861-fcc2-4b04-983c-977012644d07">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a>cluster_simil <span class="op">=</span> ClusterSimilarity(n_clusters<span class="op">=</span><span class="dv">10</span>, gamma<span class="op">=</span><span class="fl">1.</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a>similarities <span class="op">=</span> cluster_simil.fit_transform(housing[[<span class="st">"latitude"</span>, <span class="st">"longitude"</span>]], sample_weight<span class="op">=</span>housing_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
</div>
<p>This code creates a <code>ClusterSimilarity</code> transformer, setting the number of clusters to 10. Then it calls <code>fit_transform()</code> with the latitude and longitude of every district in the training set, weighting each district by its median house value. The transformer uses k-means to locate the clusters, then measures the Gaussian RBF similarity between each district and all 10 cluster centers. The result is a matrix with one row per district, and one column per cluster.</p>
<blockquote class="blockquote">
<p>See https://www.kaggle.com/code/ryanholbrook/clustering-with-k-means for the rationale of using clustering results as features.</p>
</blockquote>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7514,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011030591,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9c2a8d12-aae0-4ef8-b16a-3acbdad67e7a">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a>housing_renamed <span class="op">=</span> housing.rename(columns<span class="op">=</span>{</span>
<span id="cb101-2"><a href="#cb101-2"></a>    <span class="st">"latitude"</span>: <span class="st">"Latitude"</span>, <span class="st">"longitude"</span>: <span class="st">"Longitude"</span>,</span>
<span id="cb101-3"><a href="#cb101-3"></a>    <span class="st">"population"</span>: <span class="st">"Population"</span>,</span>
<span id="cb101-4"><a href="#cb101-4"></a>    <span class="st">"median_house_value"</span>: <span class="st">"Median house value (ᴜsᴅ)"</span>})</span>
<span id="cb101-5"><a href="#cb101-5"></a>housing_renamed[<span class="st">"Max cluster similarity"</span>] <span class="op">=</span> similarities.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb101-6"><a href="#cb101-6"></a></span>
<span id="cb101-7"><a href="#cb101-7"></a>housing_renamed.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"Longitude"</span>, y<span class="op">=</span><span class="st">"Latitude"</span>, grid<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb101-8"><a href="#cb101-8"></a>                     s<span class="op">=</span>housing_renamed[<span class="st">"Population"</span>] <span class="op">/</span> <span class="dv">100</span>, label<span class="op">=</span><span class="st">"Population"</span>,</span>
<span id="cb101-9"><a href="#cb101-9"></a>                     c<span class="op">=</span><span class="st">"Max cluster similarity"</span>,</span>
<span id="cb101-10"><a href="#cb101-10"></a>                     cmap<span class="op">=</span><span class="st">"jet"</span>, colorbar<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb101-11"><a href="#cb101-11"></a>                     legend<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="va">False</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>))</span>
<span id="cb101-12"><a href="#cb101-12"></a>plt.plot(cluster_simil.kmeans_.cluster_centers_[:, <span class="dv">1</span>],</span>
<span id="cb101-13"><a href="#cb101-13"></a>         cluster_simil.kmeans_.cluster_centers_[:, <span class="dv">0</span>],</span>
<span id="cb101-14"><a href="#cb101-14"></a>         linestyle<span class="op">=</span><span class="st">""</span>, color<span class="op">=</span><span class="st">"black"</span>, marker<span class="op">=</span><span class="st">"X"</span>, markersize<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb101-15"><a href="#cb101-15"></a>         label<span class="op">=</span><span class="st">"Cluster centers"</span>)</span>
<span id="cb101-16"><a href="#cb101-16"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb101-17"><a href="#cb101-17"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
<p>The figure shows the 10 cluster centers found by k-means. The districts are colored according to their geographic similarity to their closest cluster center. As you can see, most clusters are located in highly populated and expensive areas.</p>
</section>
</section>
<section id="transformation-pipelines" class="level3" data-number="2.4.6">
<h3 data-number="2.4.6" class="anchored" data-anchor-id="transformation-pipelines"><span class="header-section-number">2.4.6</span> Transformation Pipelines</h3>
<p>As you can see, there are many data transformation steps that need to be executed in the right order. Fortunately, Scikit-Learn provides the <code>Pipeline</code> class to help with such sequences of transformations. Here is a small pipeline for numerical attributes, which will first impute then scale the input features:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:292,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011090027,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="37a68281-735d-4357-eebc-ea8d1236afc1">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline, make_pipeline</span>
<span id="cb103-2"><a href="#cb103-2"></a></span>
<span id="cb103-3"><a href="#cb103-3"></a>num_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb103-4"><a href="#cb103-4"></a>    (<span class="st">"impute"</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>)),</span>
<span id="cb103-5"><a href="#cb103-5"></a>    (<span class="st">"standardize"</span>, StandardScaler()),</span>
<span id="cb103-6"><a href="#cb103-6"></a>])</span>
<span id="cb103-7"><a href="#cb103-7"></a>num_pipeline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('impute', SimpleImputer(strategy='median')),
                ('standardize', StandardScaler())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('impute', SimpleImputer(strategy='median')),
                ('standardize', StandardScaler())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div>
</div>
</div>
<p>The <code>Pipeline</code> constructor takes a list of name/estimator pairs (2-tuples) defining a sequence of steps. The names can be anything you like, as long as they are unique and don’t contain double underscores <code>(__)</code>. They will be useful later, when we discuss hyperparameter tuning. The estimators must all be transformers (i.e., they must have a <code>fit_transform()</code> method), except for the last one, which can be anything: a transformer, a predictor, or any other type of estimator.</p>
<p>When you call the pipeline’s <code>fit()</code> method, it calls <code>fit_transform()</code> sequentially on all the transformers, passing the output of each call as the parameter to the next call until it reaches the final estimator, for which it just calls the <code>fit()</code> method. The pipeline exposes the same methods as the final estimator. In this example the last estimator is a <code>StandardScaler</code>, which is a transformer, so the pipeline also acts like a transformer.</p>
<p>If you call the pipeline’s <code>transform()</code> method, it will sequentially apply all the transformations to the data. If the last estimator were a predictor instead of a transformer, then the pipeline would have a <code>predict()</code> method rather than a <code>transform()</code> method. Calling it would sequentially apply all the transformations to the data and pass the result to the predictor’s <code>predict()</code> method.</p>
<p>Let’s call the pipeline’s <code>fit_transform()</code> method and look at the output’s first two rows, rounded to two decimal places:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:301,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011109537,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="62d7b2be-1034-43ac-8795-f9e759618eaa">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a>housing_num_prepared <span class="op">=</span> num_pipeline.fit_transform(housing_num)</span>
<span id="cb104-2"><a href="#cb104-2"></a>housing_num_prepared[:<span class="dv">2</span>].<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>array([[-1.42,  1.01,  1.86,  0.31,  1.37,  0.14,  1.39, -0.94],
       [ 0.6 , -0.7 ,  0.91, -0.31, -0.44, -0.69, -0.37,  1.17]])</code></pre>
</div>
</div>
<p>So far, we have handled the categorical columns and the numerical columns separately. It would be more convenient to have a single transformer capable of handling all columns, applying the appropriate transformations to each column. For this, you can use a <code>ColumnTransformer</code>. For example, the following <code>ColumnTransformer</code> will apply <code>num_pipeline</code> (the one we just defined) to the numerical attributes and <code>cat_pipeline</code> to the categorical attribute:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb106-2"><a href="#cb106-2"></a></span>
<span id="cb106-3"><a href="#cb106-3"></a>num_attribs <span class="op">=</span> [<span class="st">"longitude"</span>, <span class="st">"latitude"</span>, <span class="st">"housing_median_age"</span>, <span class="st">"total_rooms"</span>,</span>
<span id="cb106-4"><a href="#cb106-4"></a>               <span class="st">"total_bedrooms"</span>, <span class="st">"population"</span>, <span class="st">"households"</span>, <span class="st">"median_income"</span>]</span>
<span id="cb106-5"><a href="#cb106-5"></a>cat_attribs <span class="op">=</span> [<span class="st">"ocean_proximity"</span>]</span>
<span id="cb106-6"><a href="#cb106-6"></a></span>
<span id="cb106-7"><a href="#cb106-7"></a>cat_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb106-8"><a href="#cb106-8"></a>    (<span class="st">"impute"</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">"most_frequent"</span>)),</span>
<span id="cb106-9"><a href="#cb106-9"></a>    (<span class="st">"encoder"</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">"ignore"</span>))</span>
<span id="cb106-10"><a href="#cb106-10"></a>    ])</span>
<span id="cb106-11"><a href="#cb106-11"></a></span>
<span id="cb106-12"><a href="#cb106-12"></a>preprocessing <span class="op">=</span> ColumnTransformer([</span>
<span id="cb106-13"><a href="#cb106-13"></a>    (<span class="st">"num"</span>, num_pipeline, num_attribs),</span>
<span id="cb106-14"><a href="#cb106-14"></a>    (<span class="st">"cat"</span>, cat_pipeline, cat_attribs),</span>
<span id="cb106-15"><a href="#cb106-15"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We construct a <code>ColumnTransformer</code>. Its constructor requires a list of triplets (3-tuples), each containing a name (which must be unique and not contain double underscores), a transformer, and a list of names (or indices) of columns that the transformer should be applied to.</p>
<blockquote class="blockquote">
<p>Instead of using a transformer, you can specify the string “drop” if you want the columns to be dropped, or you can specify “passthrough” if you want the columns to be left untouched. By default, the remaining columns (i.e., the ones that were not listed) will be dropped, but you can set the remainder hyperparameter to any transformer (or to “passthrough”) if you want these columns to be handled differently.</p>
</blockquote>
<p>Since listing all the column names is not very convenient, Scikit-Learn provides a <code>make_column_selector()</code> function that returns a selector function you can use to automatically select all the features of a given type, such as numerical or categorical.</p>
<p>You can pass this selector function to the <code>ColumnTransformer</code> instead of column names or indices. Moreover, if you don’t care about naming the transformers, you can use <code>make_column_transformer()</code>, which chooses the names for you.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> make_column_selector, make_column_transformer</span>
<span id="cb107-2"><a href="#cb107-2"></a></span>
<span id="cb107-3"><a href="#cb107-3"></a>preprocessing <span class="op">=</span> make_column_transformer(</span>
<span id="cb107-4"><a href="#cb107-4"></a>    (num_pipeline, make_column_selector(dtype_include<span class="op">=</span>np.number)),</span>
<span id="cb107-5"><a href="#cb107-5"></a>    (cat_pipeline, make_column_selector(dtype_include<span class="op">=</span><span class="bu">object</span>)),</span>
<span id="cb107-6"><a href="#cb107-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’re ready to apply this <code>ColumnTransformer</code> to the housing data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a><span class="co"># https://github.com/scikit-learn/scikit-learn/issues/25224</span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="co"># with config_context(transform_output="pandas"):</span></span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="co">#  housing_prepared = preprocessing.fit_transform(housing)</span></span>
<span id="cb108-4"><a href="#cb108-4"></a></span>
<span id="cb108-5"><a href="#cb108-5"></a>housing_prepared <span class="op">=</span> preprocessing.fit_transform(housing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once again this returns a NumPy array, but you can get the column names using <code>preprocessing.get_feature_names_out()</code> and wrap the data in a nice DataFrame as we did before.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011231557,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="468d1b27-989a-4f49-eb72-a820712f7349">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>housing_prepared_fr <span class="op">=</span> pd.DataFrame(</span>
<span id="cb109-2"><a href="#cb109-2"></a>    housing_prepared,</span>
<span id="cb109-3"><a href="#cb109-3"></a>    columns<span class="op">=</span>preprocessing.get_feature_names_out(),</span>
<span id="cb109-4"><a href="#cb109-4"></a>    index<span class="op">=</span>housing.index)</span>
<span id="cb109-5"><a href="#cb109-5"></a>housing_prepared_fr.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">

  <div id="df-6dfa256b-aadb-48c9-83d9-3dd12e138f98">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pipeline-1__longitude</th>
<th data-quarto-table-cell-role="th">pipeline-1__latitude</th>
<th data-quarto-table-cell-role="th">pipeline-1__housing_median_age</th>
<th data-quarto-table-cell-role="th">pipeline-1__total_rooms</th>
<th data-quarto-table-cell-role="th">pipeline-1__total_bedrooms</th>
<th data-quarto-table-cell-role="th">pipeline-1__population</th>
<th data-quarto-table-cell-role="th">pipeline-1__households</th>
<th data-quarto-table-cell-role="th">pipeline-1__median_income</th>
<th data-quarto-table-cell-role="th">pipeline-2__ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">pipeline-2__ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">pipeline-2__ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">pipeline-2__ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">pipeline-2__ocean_proximity_NEAR OCEAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">13096</td>
<td>-1.423037</td>
<td>1.013606</td>
<td>1.861119</td>
<td>0.311912</td>
<td>1.368167</td>
<td>0.137460</td>
<td>1.394812</td>
<td>-0.936491</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14973</td>
<td>0.596394</td>
<td>-0.702103</td>
<td>0.907630</td>
<td>-0.308620</td>
<td>-0.435925</td>
<td>-0.693771</td>
<td>-0.373485</td>
<td>1.171942</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6dfa256b-aadb-48c9-83d9-3dd12e138f98')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6dfa256b-aadb-48c9-83d9-3dd12e138f98 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6dfa256b-aadb-48c9-83d9-3dd12e138f98');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The code that builds the pipeline to do all of this should look familiar to you by now:</p>
<ul>
<li><p>Missing values in numerical features will be imputed by replacing them with the median, as most ML algorithms don’t expect missing values. In categorical features, missing values will be replaced by the most frequent category.</p></li>
<li><p>The categorical feature will be one-hot encoded, as most ML algorithms only accept numerical inputs.</p></li>
<li><p>A few ratio features will be computed and added: <code>bedrooms_ratio</code>,<code>rooms_per_house</code>, and <code>people_per_house</code>. Hopefully these will better correlate with the median house value, and thereby help the ML models.</p></li>
<li><p>A few cluster similarity features will also be added. These will likely be more useful to the model than latitude and longitude.</p></li>
<li><p>Features with a long tail will be replaced by their logarithm, as most models prefer features with roughly uniform or Gaussian distributions.</p></li>
<li><p>All numerical features will be standardized, as most ML algorithms prefer when all features have roughly the same scale.</p></li>
</ul>
<blockquote class="blockquote">
<p>If you don’t want to name the transformers, you can use the <code>make_pipeline()</code> function instead <code>Pipeline</code></p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">def</span> column_ratio(X):</span>
<span id="cb110-2"><a href="#cb110-2"></a>    <span class="cf">return</span> X[:, [<span class="dv">0</span>]] <span class="op">/</span> X[:, [<span class="dv">1</span>]]</span>
<span id="cb110-3"><a href="#cb110-3"></a></span>
<span id="cb110-4"><a href="#cb110-4"></a><span class="kw">def</span> ratio_name(function_transformer, feature_names_in):</span>
<span id="cb110-5"><a href="#cb110-5"></a>    <span class="cf">return</span> [<span class="st">"ratio"</span>]  <span class="co"># feature names out</span></span>
<span id="cb110-6"><a href="#cb110-6"></a></span>
<span id="cb110-7"><a href="#cb110-7"></a><span class="kw">def</span> ratio_pipeline():</span>
<span id="cb110-8"><a href="#cb110-8"></a>    <span class="cf">return</span> make_pipeline(</span>
<span id="cb110-9"><a href="#cb110-9"></a>        SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>),</span>
<span id="cb110-10"><a href="#cb110-10"></a>        FunctionTransformer(column_ratio, feature_names_out<span class="op">=</span>ratio_name),</span>
<span id="cb110-11"><a href="#cb110-11"></a>        StandardScaler())</span>
<span id="cb110-12"><a href="#cb110-12"></a></span>
<span id="cb110-13"><a href="#cb110-13"></a>log_pipeline <span class="op">=</span> make_pipeline(</span>
<span id="cb110-14"><a href="#cb110-14"></a>    SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>),</span>
<span id="cb110-15"><a href="#cb110-15"></a>    FunctionTransformer(np.log, feature_names_out<span class="op">=</span><span class="st">"one-to-one"</span>),</span>
<span id="cb110-16"><a href="#cb110-16"></a>    StandardScaler())</span>
<span id="cb110-17"><a href="#cb110-17"></a></span>
<span id="cb110-18"><a href="#cb110-18"></a>cluster_simil <span class="op">=</span> ClusterSimilarity(n_clusters<span class="op">=</span><span class="dv">10</span>, gamma<span class="op">=</span><span class="fl">1.</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb110-19"><a href="#cb110-19"></a>default_num_pipeline <span class="op">=</span> make_pipeline(SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>), StandardScaler())</span>
<span id="cb110-20"><a href="#cb110-20"></a></span>
<span id="cb110-21"><a href="#cb110-21"></a>preprocessing <span class="op">=</span> ColumnTransformer([</span>
<span id="cb110-22"><a href="#cb110-22"></a>        (<span class="st">"bedrooms"</span>, ratio_pipeline(), [<span class="st">"total_bedrooms"</span>, <span class="st">"total_rooms"</span>]),</span>
<span id="cb110-23"><a href="#cb110-23"></a>        (<span class="st">"rooms_per_house"</span>, ratio_pipeline(), [<span class="st">"total_rooms"</span>, <span class="st">"households"</span>]),</span>
<span id="cb110-24"><a href="#cb110-24"></a>        (<span class="st">"people_per_house"</span>, ratio_pipeline(), [<span class="st">"population"</span>, <span class="st">"households"</span>]),</span>
<span id="cb110-25"><a href="#cb110-25"></a>        (<span class="st">"log"</span>, log_pipeline, [<span class="st">"total_bedrooms"</span>, <span class="st">"total_rooms"</span>, <span class="st">"population"</span>,</span>
<span id="cb110-26"><a href="#cb110-26"></a>                               <span class="st">"households"</span>, <span class="st">"median_income"</span>]),</span>
<span id="cb110-27"><a href="#cb110-27"></a>        (<span class="st">"geo"</span>, cluster_simil, [<span class="st">"latitude"</span>, <span class="st">"longitude"</span>]),</span>
<span id="cb110-28"><a href="#cb110-28"></a>        (<span class="st">"cat"</span>, cat_pipeline, make_column_selector(dtype_include<span class="op">=</span><span class="bu">object</span>)),</span>
<span id="cb110-29"><a href="#cb110-29"></a>    ],</span>
<span id="cb110-30"><a href="#cb110-30"></a>    remainder<span class="op">=</span>default_num_pipeline)  <span class="co"># one column remaining: housing_median_age</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you run this <code>ColumnTransformer</code>, it performs all the transformations and outputs a NumPy array with 24 features:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:982,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011251664,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="cb27c833-0c7f-4d59-cbbd-bdb3dd73fd7b">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>housing_prepared <span class="op">=</span> preprocessing.fit_transform(housing)</span>
<span id="cb111-2"><a href="#cb111-2"></a>housing_prepared.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>(16512, 24)</code></pre>
</div>
</div>
</section>
</section>
<section id="select-and-train-a-model" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="select-and-train-a-model"><span class="header-section-number">2.5</span> Select and Train a Model</h2>
<p>At last! You framed the problem, you got the data and explored it, you sampled a training set and a test set, and you wrote a preprocessing pipeline to automatically clean up and prepare your data for machine learning algorithms. You are now ready to select and train a machine learning model.</p>
<section id="training-and-evaluating-on-the-training-set" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="training-and-evaluating-on-the-training-set"><span class="header-section-number">2.5.1</span> Training and Evaluating on the Training Set</h3>
<p>Let’s first train a Linear Regression model</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1682,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011259631,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0d06f333-104d-403a-d6b3-9b5dd0778698">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb114-2"><a href="#cb114-2"></a></span>
<span id="cb114-3"><a href="#cb114-3"></a>lin_reg <span class="op">=</span> make_pipeline(preprocessing, LinearRegression())</span>
<span id="cb114-4"><a href="#cb114-4"></a>lin_reg.fit(housing, housing_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="84">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('columntransformer',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2...
                                                   'households',
                                                   'median_income']),
                                                 ('geo',
                                                  ClusterSimilarity(random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                ('linearregression', LinearRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('columntransformer',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2...
                                                   'households',
                                                   'median_income']),
                                                 ('geo',
                                                  ClusterSimilarity(random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                ('linearregression', LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">columntransformer: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                             SimpleImputer(strategy='median')),
                                            ('standardscaler',
                                             StandardScaler())]),
                  transformers=[('bedrooms',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('functiontransformer',
                                                  FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                                                                      func=&lt;function column_ratio...
                                 ['total_bedrooms', 'total_rooms', 'population',
                                  'households', 'median_income']),
                                ('geo', ClusterSimilarity(random_state=42),
                                 ['latitude', 'longitude']),
                                ('cat',
                                 Pipeline(steps=[('impute',
                                                  SimpleImputer(strategy='most_frequent')),
                                                 ('encoder',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">bedrooms</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox"><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox"><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox"><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">rooms_per_house</label><div class="sk-toggleable__content"><pre>['total_rooms', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox"><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-13" type="checkbox"><label for="sk-estimator-id-13" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-14" type="checkbox"><label for="sk-estimator-id-14" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-15" type="checkbox"><label for="sk-estimator-id-15" class="sk-toggleable__label sk-toggleable__label-arrow">people_per_house</label><div class="sk-toggleable__content"><pre>['population', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-16" type="checkbox"><label for="sk-estimator-id-16" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-17" type="checkbox"><label for="sk-estimator-id-17" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox"><label for="sk-estimator-id-18" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox"><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">log</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms', 'population', 'households', 'median_income']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox"><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox"><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out='one-to-one', func=&lt;ufunc 'log'&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox"><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox"><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">geo</label><div class="sk-toggleable__content"><pre>['latitude', 'longitude']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox"><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">ClusterSimilarity</label><div class="sk-toggleable__content"><pre>ClusterSimilarity(random_state=42)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox"><label for="sk-estimator-id-25" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox"><label for="sk-estimator-id-26" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='most_frequent')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox"><label for="sk-estimator-id-27" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox"><label for="sk-estimator-id-28" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre>['housing_median_age']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox"><label for="sk-estimator-id-29" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox"><label for="sk-estimator-id-30" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox"><label for="sk-estimator-id-31" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
</div>
<p>You now have a working linear regression model. You try it out on the training set, looking at the first five predictions and comparing them to the labels:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:290,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011281981,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4888e97f-8238-4ef3-daa9-0df76c73171d">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a>housing_predictions <span class="op">=</span> lin_reg.predict(housing)</span>
<span id="cb116-2"><a href="#cb116-2"></a>housing_predictions[:<span class="dv">5</span>].<span class="bu">round</span>(<span class="op">-</span><span class="dv">2</span>)  <span class="co"># -2 = rounded to the nearest hundred</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>array([243700., 372400., 128800.,  94400., 328300.])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:281,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011294968,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="88d0b56c-7c39-44a6-d85e-839371a9c637">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>housing_labels.iloc[:<span class="dv">5</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>array([458300., 483800., 101700.,  96100., 361800.])</code></pre>
</div>
</div>
<p>Remember that you chose to use the RMSE as your performance measure, so you want to measure this regression model’s RMSE on the whole training set using Scikit-Learn’s <code>mean_squared_error()</code> function, with the <code>squared</code> argument set to <code>False</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:285,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011301055,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="18e5927a-bfa0-49c2-c6d7-bc2a183a6e7c">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb120-2"><a href="#cb120-2"></a></span>
<span id="cb120-3"><a href="#cb120-3"></a>lin_rmse <span class="op">=</span> mean_squared_error(housing_labels, housing_predictions, squared<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb120-4"><a href="#cb120-4"></a>lin_rmse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>68687.89176590038</code></pre>
</div>
</div>
<p>This is better than nothing, but clearly not a great score: the <code>median_housing_values</code> of most districts range between <code>$120,000</code> and <code>$265,000</code>, so a typical prediction error of <code>$68,628</code> is really not very satisfying. This is an example of a model <strong>underfitting</strong> the training data. When this happens it can mean that the features do not provide enough information to make good predictions, or that the model is not powerful enough.</p>
<p>The main ways to fix underfitting are to select a more powerful model, to feed the training algorithm with better features, or to reduce the constraints on the model. This model is not regularized, which rules out the last option. You could try to add more features, but first you want to try a more complex model to see how it does. We decide to try a <code>DecisionTreeRegressor</code>, as this is a fairly powerful model capable of finding complex nonlinear relationships in the data.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3055,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011331526,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4ff63d51-75de-49ec-e6b5-9c1f7c098a5b">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb122-2"><a href="#cb122-2"></a></span>
<span id="cb122-3"><a href="#cb122-3"></a>tree_reg <span class="op">=</span> make_pipeline(preprocessing, DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>))</span>
<span id="cb122-4"><a href="#cb122-4"></a>tree_reg.fit(housing, housing_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="88">
<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('columntransformer',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2...
                                                   'median_income']),
                                                 ('geo',
                                                  ClusterSimilarity(random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                ('decisiontreeregressor',
                 DecisionTreeRegressor(random_state=42))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox"><label for="sk-estimator-id-32" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('columntransformer',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2...
                                                   'median_income']),
                                                 ('geo',
                                                  ClusterSimilarity(random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                ('decisiontreeregressor',
                 DecisionTreeRegressor(random_state=42))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox"><label for="sk-estimator-id-33" class="sk-toggleable__label sk-toggleable__label-arrow">columntransformer: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                             SimpleImputer(strategy='median')),
                                            ('standardscaler',
                                             StandardScaler())]),
                  transformers=[('bedrooms',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('functiontransformer',
                                                  FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                                                                      func=&lt;function column_ratio...
                                 ['total_bedrooms', 'total_rooms', 'population',
                                  'households', 'median_income']),
                                ('geo', ClusterSimilarity(random_state=42),
                                 ['latitude', 'longitude']),
                                ('cat',
                                 Pipeline(steps=[('impute',
                                                  SimpleImputer(strategy='most_frequent')),
                                                 ('encoder',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox"><label for="sk-estimator-id-34" class="sk-toggleable__label sk-toggleable__label-arrow">bedrooms</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox"><label for="sk-estimator-id-35" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox"><label for="sk-estimator-id-36" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-37" type="checkbox"><label for="sk-estimator-id-37" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-38" type="checkbox"><label for="sk-estimator-id-38" class="sk-toggleable__label sk-toggleable__label-arrow">rooms_per_house</label><div class="sk-toggleable__content"><pre>['total_rooms', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-39" type="checkbox"><label for="sk-estimator-id-39" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-40" type="checkbox"><label for="sk-estimator-id-40" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-41" type="checkbox"><label for="sk-estimator-id-41" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-42" type="checkbox"><label for="sk-estimator-id-42" class="sk-toggleable__label sk-toggleable__label-arrow">people_per_house</label><div class="sk-toggleable__content"><pre>['population', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-43" type="checkbox"><label for="sk-estimator-id-43" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-44" type="checkbox"><label for="sk-estimator-id-44" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-45" type="checkbox"><label for="sk-estimator-id-45" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-46" type="checkbox"><label for="sk-estimator-id-46" class="sk-toggleable__label sk-toggleable__label-arrow">log</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms', 'population', 'households', 'median_income']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-47" type="checkbox"><label for="sk-estimator-id-47" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-48" type="checkbox"><label for="sk-estimator-id-48" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out='one-to-one', func=&lt;ufunc 'log'&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-49" type="checkbox"><label for="sk-estimator-id-49" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-50" type="checkbox"><label for="sk-estimator-id-50" class="sk-toggleable__label sk-toggleable__label-arrow">geo</label><div class="sk-toggleable__content"><pre>['latitude', 'longitude']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-51" type="checkbox"><label for="sk-estimator-id-51" class="sk-toggleable__label sk-toggleable__label-arrow">ClusterSimilarity</label><div class="sk-toggleable__content"><pre>ClusterSimilarity(random_state=42)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-52" type="checkbox"><label for="sk-estimator-id-52" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-53" type="checkbox"><label for="sk-estimator-id-53" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='most_frequent')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-54" type="checkbox"><label for="sk-estimator-id-54" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-55" type="checkbox"><label for="sk-estimator-id-55" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre>['housing_median_age']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-56" type="checkbox"><label for="sk-estimator-id-56" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-57" type="checkbox"><label for="sk-estimator-id-57" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-58" type="checkbox"><label for="sk-estimator-id-58" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=42)</pre></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:454,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011334736,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="601352de-9298-4d66-864d-5a8af96e40f6">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>housing_predictions <span class="op">=</span> tree_reg.predict(housing)</span>
<span id="cb124-2"><a href="#cb124-2"></a>tree_rmse <span class="op">=</span> mean_squared_error(housing_labels, housing_predictions, squared<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb124-3"><a href="#cb124-3"></a>tree_rmse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>0.0</code></pre>
</div>
</div>
<p>It is much more likely that the model has badly <strong>overfit</strong> the data. How can you be sure? As we saw earlier, you don’t want to touch the test set until you are ready to launch a model you are confident about, so you need to use part of the training set for training, and part for model validation.</p>
</section>
<section id="better-evaluation-using-cross-validation" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="better-evaluation-using-cross-validation"><span class="header-section-number">2.5.2</span> Better Evaluation Using Cross-Validation</h3>
<p>One way to evaluate the Decision Tree model would be to use the <code>train_test_split</code> function to split the training set into a smaller training set and a <strong>validation set</strong>, then train your models against the smaller training set and evaluate them against the validation set.</p>
<p>A great alternative is to use <code>Scikit-Learn</code>’s K-fold cross-validation feature. The following code randomly splits the training set into 10 distinct subsets called folds, then it trains and evaluates the Decision Tree model 10 times, picking a different fold for evaluation every time and training on the other 9 folds. The result is an array containing the 10 evaluation scores:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:9348,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011367487,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a32e34f8-5a1f-48cc-9616-916a37833b53">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb126-2"><a href="#cb126-2"></a></span>
<span id="cb126-3"><a href="#cb126-3"></a><span class="co"># Scikit-Learn’s cross-validation features expect a utility function (greater is better) rather than a cost function (lower is better),</span></span>
<span id="cb126-4"><a href="#cb126-4"></a>tree_rmses <span class="op">=</span> <span class="op">-</span>cross_val_score(tree_reg, housing, housing_labels, scoring<span class="op">=</span><span class="st">"neg_root_mean_squared_error"</span>, cv<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
</div>
<p>Let’s look at the results:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011367487,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6d58e43c-31de-4efb-99b9-121c7dc3b373">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a>pd.Series(tree_rmses).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>count       10.000000
mean     66868.027288
std       2060.966425
min      63649.536493
25%      65338.078316
50%      66801.953094
75%      68229.934454
max      70094.778246
dtype: float64</code></pre>
</div>
</div>
<p>Now the decision tree doesn’t look as good as it did earlier. In fact, it seems to perform almost as poorly as the linear regression model! Notice that cross-validation allows you to get not only an estimate of the performance of your model, but also a measure of how precise this estimate is (i.e., its standard deviation). The decision tree has an RMSE of about 66,868, with a standard deviation of about 2,061. You would not have this information if you just used one validation set! We know there’s an overfitting problem because the training error is low (actually zero) while the validation error is high.</p>
<p>Let’s compute the same scores for the Linear Regression model just to be sure</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6586,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011380048,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6f1c4391-b3e6-4826-b27a-16479445bef8">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a>lin_rmses <span class="op">=</span> <span class="op">-</span>cross_val_score(lin_reg, housing, housing_labels, scoring<span class="op">=</span><span class="st">"neg_root_mean_squared_error"</span>, cv<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb130-2"><a href="#cb130-2"></a>pd.Series(lin_rmses).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>count       10.000000
mean     69858.018195
std       4182.205077
min      65397.780144
25%      68070.536263
50%      68619.737842
75%      69810.076342
max      80959.348171
dtype: float64</code></pre>
</div>
</div>
<p>Let’s try one last model now: the <code>RandomForestRegressor</code>.Random Forests work by training many Decision Trees on random subsets of the features, then averaging out their predictions.</p>
<p>Building a model on top of many other models is called <strong>Ensemble Learning</strong>, and it is often a great way to push ML algorithms even further.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:222669,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011611267,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="08b61ae3-be67-49ea-814a-1319d9d7e37d">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb133-2"><a href="#cb133-2"></a></span>
<span id="cb133-3"><a href="#cb133-3"></a>forest_reg <span class="op">=</span> make_pipeline(preprocessing, RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>))</span>
<span id="cb133-4"><a href="#cb133-4"></a>forest_rmses <span class="op">=</span> <span class="op">-</span>cross_val_score(forest_reg, housing, housing_labels, scoring<span class="op">=</span><span class="st">"neg_root_mean_squared_error"</span>, cv<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011611268,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="11bf8c19-456e-40ba-d981-221d55bc0e76">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1"></a>pd.Series(forest_rmses).describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>count       10.000000
mean     47019.561281
std       1033.957120
min      45458.112527
25%      46464.031184
50%      46967.596354
75%      47325.694987
max      49243.765795
dtype: float64</code></pre>
</div>
</div>
<p>Wow, this is much better: random forests really look very promising for this task! However, if you train a <code>RandomForest</code> and measure the RMSE on the training set, you will find roughly 17,474: that’s much lower, meaning that there’s still quite a lot of overfitting going on.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:25041,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011636307,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9f328713-670a-4e55-c059-5f854f9eab73">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1"></a>forest_reg.fit(housing, housing_labels)</span>
<span id="cb137-2"><a href="#cb137-2"></a>housing_predictions <span class="op">=</span> forest_reg.predict(housing)</span>
<span id="cb137-3"><a href="#cb137-3"></a>forest_rmse <span class="op">=</span> mean_squared_error(housing_labels, housing_predictions, squared<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb137-4"><a href="#cb137-4"></a>forest_rmse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>17474.619286483998</code></pre>
</div>
</div>
<p>Possible solutions are to simplify the model, constrain it (i.e., regularize it), or get a lot more training data. Before you dive much deeper into random forests, however, you should try out many other models from various categories of machine learning algorithms (e.g., several support vector machines with different kernels, and possibly a neural network), without spending too much time tweaking the hyperparameters. <strong>The goal is to shortlist a few (two to five) promising models.</strong></p>
</section>
</section>
<section id="fine-tune-your-model" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="fine-tune-your-model"><span class="header-section-number">2.6</span> Fine-Tune Your Model</h2>
<p>Let’s assume that you now have a shortlist of promising models. You now need to fine-tune them. Let’s look at a few ways you can do that.</p>
<section id="grid-search" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="grid-search"><span class="header-section-number">2.6.1</span> Grid Search</h3>
<p>One way to do that would be to fiddle with the hyperparameters manually, until you find a great combination of hyperparameter values. This would be very tedious work, and you may not have time to explore many combinations.</p>
<p>Instead you should get <code>Scikit-Learn</code>’s <code>GridSearchCV</code> to search for you. All you need to do is tell it which hyperparameters you want it to experiment with, and what values to try out, and it will evaluate all the possible combinations of hyperparameter values, using cross-validation. For example, the following code searches for the best combination of hyperparameter values for the <code>RandomForestRegressor</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:251806,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011888111,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3a5737a2-51e5-488f-e8b7-c443fbb45716">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb140-2"><a href="#cb140-2"></a></span>
<span id="cb140-3"><a href="#cb140-3"></a>full_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb140-4"><a href="#cb140-4"></a>    (<span class="st">"preprocessing"</span>, preprocessing),</span>
<span id="cb140-5"><a href="#cb140-5"></a>    (<span class="st">"random_forest"</span>, RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>)),</span>
<span id="cb140-6"><a href="#cb140-6"></a>])</span>
<span id="cb140-7"><a href="#cb140-7"></a>param_grid <span class="op">=</span> [</span>
<span id="cb140-8"><a href="#cb140-8"></a>    {<span class="st">'preprocessing__geo__n_clusters'</span>: [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>],</span>
<span id="cb140-9"><a href="#cb140-9"></a>     <span class="st">'random_forest__max_features'</span>: [<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>]},</span>
<span id="cb140-10"><a href="#cb140-10"></a>    {<span class="st">'preprocessing__geo__n_clusters'</span>: [<span class="dv">10</span>, <span class="dv">15</span>],</span>
<span id="cb140-11"><a href="#cb140-11"></a>     <span class="st">'random_forest__max_features'</span>: [<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>]},</span>
<span id="cb140-12"><a href="#cb140-12"></a>]</span>
<span id="cb140-13"><a href="#cb140-13"></a>grid_search <span class="op">=</span> GridSearchCV(full_pipeline, param_grid, cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>)</span>
<span id="cb140-14"><a href="#cb140-14"></a>grid_search.fit(housing, housing_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="96">
<style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[('preprocessing',
                                        ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                                                     SimpleImputer(strategy='median')),
                                                                                    ('standardscaler',
                                                                                     StandardScaler())]),
                                                          transformers=[('bedrooms',
                                                                         Pipeline(steps=[('simpleimputer',
                                                                                          SimpleImputer(strategy='median')),
                                                                                         ('functiontransformer',
                                                                                          FunctionTransformer(feature_names_out=&lt;f...
                                                                         &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                                       ('random_forest',
                                        RandomForestRegressor(random_state=42))]),
             param_grid=[{'preprocessing__geo__n_clusters': [5, 8, 10],
                          'random_forest__max_features': [4, 6, 8]},
                         {'preprocessing__geo__n_clusters': [10, 15],
                          'random_forest__max_features': [6, 8, 10]}],
             scoring='neg_root_mean_squared_error')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-59" type="checkbox"><label for="sk-estimator-id-59" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[('preprocessing',
                                        ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                                                     SimpleImputer(strategy='median')),
                                                                                    ('standardscaler',
                                                                                     StandardScaler())]),
                                                          transformers=[('bedrooms',
                                                                         Pipeline(steps=[('simpleimputer',
                                                                                          SimpleImputer(strategy='median')),
                                                                                         ('functiontransformer',
                                                                                          FunctionTransformer(feature_names_out=&lt;f...
                                                                         &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                                       ('random_forest',
                                        RandomForestRegressor(random_state=42))]),
             param_grid=[{'preprocessing__geo__n_clusters': [5, 8, 10],
                          'random_forest__max_features': [4, 6, 8]},
                         {'preprocessing__geo__n_clusters': [10, 15],
                          'random_forest__max_features': [6, 8, 10]}],
             scoring='neg_root_mean_squared_error')</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-60" type="checkbox"><label for="sk-estimator-id-60" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessing',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14b...
                                                   'median_income']),
                                                 ('geo',
                                                  ClusterSimilarity(random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                ('random_forest', RandomForestRegressor(random_state=42))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-61" type="checkbox"><label for="sk-estimator-id-61" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessing: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                             SimpleImputer(strategy='median')),
                                            ('standardscaler',
                                             StandardScaler())]),
                  transformers=[('bedrooms',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('functiontransformer',
                                                  FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                                                                      func=&lt;function column_ratio...
                                 ['total_bedrooms', 'total_rooms', 'population',
                                  'households', 'median_income']),
                                ('geo', ClusterSimilarity(random_state=42),
                                 ['latitude', 'longitude']),
                                ('cat',
                                 Pipeline(steps=[('impute',
                                                  SimpleImputer(strategy='most_frequent')),
                                                 ('encoder',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-62" type="checkbox"><label for="sk-estimator-id-62" class="sk-toggleable__label sk-toggleable__label-arrow">bedrooms</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-63" type="checkbox"><label for="sk-estimator-id-63" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-64" type="checkbox"><label for="sk-estimator-id-64" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-65" type="checkbox"><label for="sk-estimator-id-65" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-66" type="checkbox"><label for="sk-estimator-id-66" class="sk-toggleable__label sk-toggleable__label-arrow">rooms_per_house</label><div class="sk-toggleable__content"><pre>['total_rooms', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-67" type="checkbox"><label for="sk-estimator-id-67" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-68" type="checkbox"><label for="sk-estimator-id-68" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-69" type="checkbox"><label for="sk-estimator-id-69" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-70" type="checkbox"><label for="sk-estimator-id-70" class="sk-toggleable__label sk-toggleable__label-arrow">people_per_house</label><div class="sk-toggleable__content"><pre>['population', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-71" type="checkbox"><label for="sk-estimator-id-71" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-72" type="checkbox"><label for="sk-estimator-id-72" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-73" type="checkbox"><label for="sk-estimator-id-73" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-74" type="checkbox"><label for="sk-estimator-id-74" class="sk-toggleable__label sk-toggleable__label-arrow">log</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms', 'population', 'households', 'median_income']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-75" type="checkbox"><label for="sk-estimator-id-75" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-76" type="checkbox"><label for="sk-estimator-id-76" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out='one-to-one', func=&lt;ufunc 'log'&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-77" type="checkbox"><label for="sk-estimator-id-77" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-78" type="checkbox"><label for="sk-estimator-id-78" class="sk-toggleable__label sk-toggleable__label-arrow">geo</label><div class="sk-toggleable__content"><pre>['latitude', 'longitude']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-79" type="checkbox"><label for="sk-estimator-id-79" class="sk-toggleable__label sk-toggleable__label-arrow">ClusterSimilarity</label><div class="sk-toggleable__content"><pre>ClusterSimilarity(random_state=42)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-80" type="checkbox"><label for="sk-estimator-id-80" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-81" type="checkbox"><label for="sk-estimator-id-81" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='most_frequent')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-82" type="checkbox"><label for="sk-estimator-id-82" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-83" type="checkbox"><label for="sk-estimator-id-83" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre>['housing_median_age']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-84" type="checkbox"><label for="sk-estimator-id-84" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-85" type="checkbox"><label for="sk-estimator-id-85" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-86" type="checkbox"><label for="sk-estimator-id-86" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestRegressor</label><div class="sk-toggleable__content"><pre>RandomForestRegressor(random_state=42)</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<p>Notice that you can refer to any hyperparameter of any estimator in a pipeline, even if this estimator is nested deep inside several pipelines and <code>column transformers</code>. For example, when Scikit-Learn sees <code>"preprocessing__geo__n_clusters"</code>, <strong>it splits this string at the double underscores</strong>, then it looks for an estimator named <code>"preprocessing"</code> in the pipeline and finds the preprocessing <code>ColumnTransformer</code>. Next, it looks for a transformer named <code>"geo"</code> inside this <code>ColumnTransformer</code> and finds the <code>ClusterSimilarity</code> transformer we used on the latitude and longitude attributes. Then it finds this transformer’s <code>n_clusters</code> hyperparameter. Similarly, <code>random_forest__max_features</code> refers to the <code>max_features</code> hyperparameter of the estimator named <code>"random_forest"</code>, which is of course the <code>RandomForest</code> model</p>
<p>There are two dictionaries in this <code>param_grid</code>, so <code>GridSearchCV</code> will first evaluate all 3 × 3 = 9 combinations of <code>n_clusters</code> and <code>max_features</code> hyperparameter values specified in the first dict, then it will try all 2 × 3 = 6 combinations of hyperparameter values in the second dict. So in total the grid search will explore 9 + 6 = 15 combinations of hyperparameter values, and it will train the pipeline 3 times per combination, since we are using 3-fold cross validation. This means there will be a grand total of 15 × 3 = 45 rounds of training!</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:13,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011888112,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="689414c4-0dbc-4455-d7b5-3e1c5700aa7b">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1"></a>grid_search.best_params_</span>
<span id="cb142-2"><a href="#cb142-2"></a></span>
<span id="cb142-3"><a href="#cb142-3"></a><span class="co"># Since 15 is the maximum values that were evaluated, you</span></span>
<span id="cb142-4"><a href="#cb142-4"></a><span class="co"># should probably try searching again with higher values, since the</span></span>
<span id="cb142-5"><a href="#cb142-5"></a><span class="co"># score may continue to improve.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>{'preprocessing__geo__n_clusters': 15, 'random_forest__max_features': 6}</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011888112,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ca906085-8b91-438c-9c6e-ba42869ecde8">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1"></a>grid_search.best_estimator_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessing',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14b...
                                                  ClusterSimilarity(n_clusters=15,
                                                                    random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b14c8a1f0&gt;)])),
                ('random_forest',
                 RandomForestRegressor(max_features=6, random_state=42))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-87" type="checkbox"><label for="sk-estimator-id-87" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessing',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14b...
                                                  ClusterSimilarity(n_clusters=15,
                                                                    random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b14c8a1f0&gt;)])),
                ('random_forest',
                 RandomForestRegressor(max_features=6, random_state=42))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-88" type="checkbox"><label for="sk-estimator-id-88" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessing: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                             SimpleImputer(strategy='median')),
                                            ('standardscaler',
                                             StandardScaler())]),
                  transformers=[('bedrooms',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('functiontransformer',
                                                  FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                                                                      func=&lt;function column_ratio...
                                 ['total_bedrooms', 'total_rooms', 'population',
                                  'households', 'median_income']),
                                ('geo',
                                 ClusterSimilarity(n_clusters=15,
                                                   random_state=42),
                                 ['latitude', 'longitude']),
                                ('cat',
                                 Pipeline(steps=[('impute',
                                                  SimpleImputer(strategy='most_frequent')),
                                                 ('encoder',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b14c8a1f0&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-89" type="checkbox"><label for="sk-estimator-id-89" class="sk-toggleable__label sk-toggleable__label-arrow">bedrooms</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-90" type="checkbox"><label for="sk-estimator-id-90" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-91" type="checkbox"><label for="sk-estimator-id-91" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-92" type="checkbox"><label for="sk-estimator-id-92" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-93" type="checkbox"><label for="sk-estimator-id-93" class="sk-toggleable__label sk-toggleable__label-arrow">rooms_per_house</label><div class="sk-toggleable__content"><pre>['total_rooms', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-94" type="checkbox"><label for="sk-estimator-id-94" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-95" type="checkbox"><label for="sk-estimator-id-95" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-96" type="checkbox"><label for="sk-estimator-id-96" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-97" type="checkbox"><label for="sk-estimator-id-97" class="sk-toggleable__label sk-toggleable__label-arrow">people_per_house</label><div class="sk-toggleable__content"><pre>['population', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-98" type="checkbox"><label for="sk-estimator-id-98" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-99" type="checkbox"><label for="sk-estimator-id-99" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-100" type="checkbox"><label for="sk-estimator-id-100" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-101" type="checkbox"><label for="sk-estimator-id-101" class="sk-toggleable__label sk-toggleable__label-arrow">log</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms', 'population', 'households', 'median_income']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-102" type="checkbox"><label for="sk-estimator-id-102" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-103" type="checkbox"><label for="sk-estimator-id-103" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out='one-to-one', func=&lt;ufunc 'log'&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-104" type="checkbox"><label for="sk-estimator-id-104" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-105" type="checkbox"><label for="sk-estimator-id-105" class="sk-toggleable__label sk-toggleable__label-arrow">geo</label><div class="sk-toggleable__content"><pre>['latitude', 'longitude']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-106" type="checkbox"><label for="sk-estimator-id-106" class="sk-toggleable__label sk-toggleable__label-arrow">ClusterSimilarity</label><div class="sk-toggleable__content"><pre>ClusterSimilarity(n_clusters=15, random_state=42)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-107" type="checkbox"><label for="sk-estimator-id-107" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b14c8a1f0&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-108" type="checkbox"><label for="sk-estimator-id-108" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='most_frequent')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-109" type="checkbox"><label for="sk-estimator-id-109" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-110" type="checkbox"><label for="sk-estimator-id-110" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre>['housing_median_age']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-111" type="checkbox"><label for="sk-estimator-id-111" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-112" type="checkbox"><label for="sk-estimator-id-112" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-113" type="checkbox"><label for="sk-estimator-id-113" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestRegressor</label><div class="sk-toggleable__content"><pre>RandomForestRegressor(max_features=6, random_state=42)</pre></div></div></div></div></div></div></div>
</div>
</div>
<p>You can access the best estimator using <code>grid_search.best_estimator_</code>. If <code>GridSearchCV</code> is initialized with <code>refit=True</code> (which is the default), then once it finds the best estimator using cross-validation, it retrains it on the whole training set. This is usually a good idea, since feeding it more data will likely improve its performance.</p>
<p>The evaluation scores are available using <code>grid_search.cv_results_</code>. This is a dictionary, but if you wrap it in a DataFrame you get a nice list of all the test scores for each combination of hyperparameters and for each cross-validation split, as well as the mean test score across all splits:</p>
<p>Let’s look at the score of each hyperparameter combination tested during the grid search:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676011888112,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1213bbb4-21e6-4f03-b080-d6f82e8bf022">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1"></a>cv_res <span class="op">=</span> pd.DataFrame(grid_search.cv_results_)</span>
<span id="cb145-2"><a href="#cb145-2"></a>cv_res.sort_values(by<span class="op">=</span><span class="st">"mean_test_score"</span>, ascending<span class="op">=</span><span class="va">False</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb145-3"><a href="#cb145-3"></a></span>
<span id="cb145-4"><a href="#cb145-4"></a>cv_res <span class="op">=</span> cv_res[[<span class="st">"param_preprocessing__geo__n_clusters"</span>,</span>
<span id="cb145-5"><a href="#cb145-5"></a>                 <span class="st">"param_random_forest__max_features"</span>, <span class="st">"split0_test_score"</span>,</span>
<span id="cb145-6"><a href="#cb145-6"></a>                 <span class="st">"split1_test_score"</span>, <span class="st">"split2_test_score"</span>, <span class="st">"mean_test_score"</span>]]</span>
<span id="cb145-7"><a href="#cb145-7"></a>score_cols <span class="op">=</span> [<span class="st">"split0"</span>, <span class="st">"split1"</span>, <span class="st">"split2"</span>, <span class="st">"mean_test_rmse"</span>]</span>
<span id="cb145-8"><a href="#cb145-8"></a>cv_res.columns <span class="op">=</span> [<span class="st">"n_clusters"</span>, <span class="st">"max_features"</span>] <span class="op">+</span> score_cols</span>
<span id="cb145-9"><a href="#cb145-9"></a>cv_res[score_cols] <span class="op">=</span> <span class="op">-</span>cv_res[score_cols].<span class="bu">round</span>().astype(np.int64)</span>
<span id="cb145-10"><a href="#cb145-10"></a></span>
<span id="cb145-11"><a href="#cb145-11"></a>cv_res.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">

  <div id="df-fd96ef39-0f88-47d6-b3f6-cdbdaca41bba">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">n_clusters</th>
<th data-quarto-table-cell-role="th">max_features</th>
<th data-quarto-table-cell-role="th">split0</th>
<th data-quarto-table-cell-role="th">split1</th>
<th data-quarto-table-cell-role="th">split2</th>
<th data-quarto-table-cell-role="th">mean_test_rmse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>15</td>
<td>6</td>
<td>43460</td>
<td>43919</td>
<td>44748</td>
<td>44042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>15</td>
<td>8</td>
<td>44132</td>
<td>44075</td>
<td>45010</td>
<td>44406</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>15</td>
<td>10</td>
<td>44374</td>
<td>44286</td>
<td>45316</td>
<td>44659</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>10</td>
<td>6</td>
<td>44683</td>
<td>44655</td>
<td>45657</td>
<td>44999</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>6</td>
<td>44683</td>
<td>44655</td>
<td>45657</td>
<td>44999</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fd96ef39-0f88-47d6-b3f6-cdbdaca41bba')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fd96ef39-0f88-47d6-b3f6-cdbdaca41bba button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fd96ef39-0f88-47d6-b3f6-cdbdaca41bba');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The mean test RMSE score for the best model is 44,042, which is better than the score you got earlier using the default hyperparameter values (which was 47,019). Congratulations, you have successfully fine-tuned your best model!</p>
</section>
<section id="randomized-search" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="randomized-search"><span class="header-section-number">2.6.2</span> Randomized Search</h3>
<p>The grid search approach is fine when you are exploring relatively few combinations, like in the previous example, but when the hyperparameter search space is large, it is often preferable to use <code>RandomizedSearchCV</code> instead. This class can be used in much the same way as the <code>GridSearchCV</code> class, but instead of trying out all possible combinations, it evaluates a given number of random combinations by selecting a random value for each hyperparameter at every iteration.</p>
<p>For each hyperparameter, you must provide either a list of possible values, or a probability distribution:</p>
<p>Try 30 (<code>n_iter</code> × <code>cv</code>) random combinations of hyperparameters:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:209538,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097641,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2ffca173-ca70-4233-b751-87be602a74e6">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb146-2"><a href="#cb146-2"></a><span class="im">from</span> scipy.stats <span class="im">import</span> randint</span>
<span id="cb146-3"><a href="#cb146-3"></a></span>
<span id="cb146-4"><a href="#cb146-4"></a>param_distribs <span class="op">=</span> {<span class="st">'preprocessing__geo__n_clusters'</span>: randint(low<span class="op">=</span><span class="dv">3</span>, high<span class="op">=</span><span class="dv">50</span>),</span>
<span id="cb146-5"><a href="#cb146-5"></a>          <span class="st">'random_forest__max_features'</span>: randint(low<span class="op">=</span><span class="dv">2</span>, high<span class="op">=</span><span class="dv">20</span>)}</span>
<span id="cb146-6"><a href="#cb146-6"></a></span>
<span id="cb146-7"><a href="#cb146-7"></a>rnd_search <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb146-8"><a href="#cb146-8"></a>    full_pipeline, param_distributions<span class="op">=</span>param_distribs, n_iter<span class="op">=</span><span class="dv">10</span>, cv<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb146-9"><a href="#cb146-9"></a>    scoring<span class="op">=</span><span class="st">'neg_root_mean_squared_error'</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb146-10"><a href="#cb146-10"></a></span>
<span id="cb146-11"><a href="#cb146-11"></a>rnd_search.fit(housing, housing_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(
/usr/local/lib/python3.8/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="100">
<style>#sk-container-id-7 {color: black;background-color: white;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomizedSearchCV(cv=3,
                   estimator=Pipeline(steps=[('preprocessing',
                                              ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                                                           SimpleImputer(strategy='median')),
                                                                                          ('standardscaler',
                                                                                           StandardScaler())]),
                                                                transformers=[('bedrooms',
                                                                               Pipeline(steps=[('simpleimputer',
                                                                                                SimpleImputer(strategy='median')),
                                                                                               ('functiontransformer',
                                                                                                FunctionTransformer(feature_names_...
                                                                               &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                                             ('random_forest',
                                              RandomForestRegressor(random_state=42))]),
                   param_distributions={'preprocessing__geo__n_clusters': &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7f2b14de5280&gt;,
                                        'random_forest__max_features': &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7f2b146d3160&gt;},
                   random_state=42, scoring='neg_root_mean_squared_error')</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-114" type="checkbox"><label for="sk-estimator-id-114" class="sk-toggleable__label sk-toggleable__label-arrow">RandomizedSearchCV</label><div class="sk-toggleable__content"><pre>RandomizedSearchCV(cv=3,
                   estimator=Pipeline(steps=[('preprocessing',
                                              ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                                                           SimpleImputer(strategy='median')),
                                                                                          ('standardscaler',
                                                                                           StandardScaler())]),
                                                                transformers=[('bedrooms',
                                                                               Pipeline(steps=[('simpleimputer',
                                                                                                SimpleImputer(strategy='median')),
                                                                                               ('functiontransformer',
                                                                                                FunctionTransformer(feature_names_...
                                                                               &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                                             ('random_forest',
                                              RandomForestRegressor(random_state=42))]),
                   param_distributions={'preprocessing__geo__n_clusters': &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7f2b14de5280&gt;,
                                        'random_forest__max_features': &lt;scipy.stats._distn_infrastructure.rv_frozen object at 0x7f2b146d3160&gt;},
                   random_state=42, scoring='neg_root_mean_squared_error')</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-115" type="checkbox"><label for="sk-estimator-id-115" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('preprocessing',
                 ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                                              SimpleImputer(strategy='median')),
                                                             ('standardscaler',
                                                              StandardScaler())]),
                                   transformers=[('bedrooms',
                                                  Pipeline(steps=[('simpleimputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('functiontransformer',
                                                                   FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14b...
                                                   'median_income']),
                                                 ('geo',
                                                  ClusterSimilarity(random_state=42),
                                                  ['latitude', 'longitude']),
                                                 ('cat',
                                                  Pipeline(steps=[('impute',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])),
                ('random_forest', RandomForestRegressor(random_state=42))])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-116" type="checkbox"><label for="sk-estimator-id-116" class="sk-toggleable__label sk-toggleable__label-arrow">preprocessing: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=Pipeline(steps=[('simpleimputer',
                                             SimpleImputer(strategy='median')),
                                            ('standardscaler',
                                             StandardScaler())]),
                  transformers=[('bedrooms',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('functiontransformer',
                                                  FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                                                                      func=&lt;function column_ratio...
                                 ['total_bedrooms', 'total_rooms', 'population',
                                  'households', 'median_income']),
                                ('geo', ClusterSimilarity(random_state=42),
                                 ['latitude', 'longitude']),
                                ('cat',
                                 Pipeline(steps=[('impute',
                                                  SimpleImputer(strategy='most_frequent')),
                                                 ('encoder',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;)])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-117" type="checkbox"><label for="sk-estimator-id-117" class="sk-toggleable__label sk-toggleable__label-arrow">bedrooms</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-118" type="checkbox"><label for="sk-estimator-id-118" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-119" type="checkbox"><label for="sk-estimator-id-119" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-120" type="checkbox"><label for="sk-estimator-id-120" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-121" type="checkbox"><label for="sk-estimator-id-121" class="sk-toggleable__label sk-toggleable__label-arrow">rooms_per_house</label><div class="sk-toggleable__content"><pre>['total_rooms', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-122" type="checkbox"><label for="sk-estimator-id-122" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-123" type="checkbox"><label for="sk-estimator-id-123" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-124" type="checkbox"><label for="sk-estimator-id-124" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-125" type="checkbox"><label for="sk-estimator-id-125" class="sk-toggleable__label sk-toggleable__label-arrow">people_per_house</label><div class="sk-toggleable__content"><pre>['population', 'households']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-126" type="checkbox"><label for="sk-estimator-id-126" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-127" type="checkbox"><label for="sk-estimator-id-127" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out=&lt;function ratio_name at 0x7f2b14bd3d30&gt;,
                    func=&lt;function column_ratio at 0x7f2b14bd3af0&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-128" type="checkbox"><label for="sk-estimator-id-128" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-129" type="checkbox"><label for="sk-estimator-id-129" class="sk-toggleable__label sk-toggleable__label-arrow">log</label><div class="sk-toggleable__content"><pre>['total_bedrooms', 'total_rooms', 'population', 'households', 'median_income']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-130" type="checkbox"><label for="sk-estimator-id-130" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-131" type="checkbox"><label for="sk-estimator-id-131" class="sk-toggleable__label sk-toggleable__label-arrow">FunctionTransformer</label><div class="sk-toggleable__content"><pre>FunctionTransformer(feature_names_out='one-to-one', func=&lt;ufunc 'log'&gt;)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-132" type="checkbox"><label for="sk-estimator-id-132" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-133" type="checkbox"><label for="sk-estimator-id-133" class="sk-toggleable__label sk-toggleable__label-arrow">geo</label><div class="sk-toggleable__content"><pre>['latitude', 'longitude']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-134" type="checkbox"><label for="sk-estimator-id-134" class="sk-toggleable__label sk-toggleable__label-arrow">ClusterSimilarity</label><div class="sk-toggleable__content"><pre>ClusterSimilarity(random_state=42)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-135" type="checkbox"><label for="sk-estimator-id-135" class="sk-toggleable__label sk-toggleable__label-arrow">cat</label><div class="sk-toggleable__content"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x7f2b0e7f3fd0&gt;</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-136" type="checkbox"><label for="sk-estimator-id-136" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='most_frequent')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-137" type="checkbox"><label for="sk-estimator-id-137" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-138" type="checkbox"><label for="sk-estimator-id-138" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre>['housing_median_age']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-139" type="checkbox"><label for="sk-estimator-id-139" class="sk-toggleable__label sk-toggleable__label-arrow">SimpleImputer</label><div class="sk-toggleable__content"><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-140" type="checkbox"><label for="sk-estimator-id-140" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-141" type="checkbox"><label for="sk-estimator-id-141" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestRegressor</label><div class="sk-toggleable__content"><pre>RandomForestRegressor(random_state=42)</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:50,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097642,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="822dc352-1eaf-4323-f32b-ab6898060398">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1"></a>cv_res <span class="op">=</span> pd.DataFrame(rnd_search.cv_results_)</span>
<span id="cb148-2"><a href="#cb148-2"></a>cv_res.sort_values(by<span class="op">=</span><span class="st">"mean_test_score"</span>, ascending<span class="op">=</span><span class="va">False</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb148-3"><a href="#cb148-3"></a>cv_res <span class="op">=</span> cv_res[[<span class="st">"param_preprocessing__geo__n_clusters"</span>,</span>
<span id="cb148-4"><a href="#cb148-4"></a>                 <span class="st">"param_random_forest__max_features"</span>, <span class="st">"split0_test_score"</span>,</span>
<span id="cb148-5"><a href="#cb148-5"></a>                 <span class="st">"split1_test_score"</span>, <span class="st">"split2_test_score"</span>, <span class="st">"mean_test_score"</span>]]</span>
<span id="cb148-6"><a href="#cb148-6"></a>cv_res.columns <span class="op">=</span> [<span class="st">"n_clusters"</span>, <span class="st">"max_features"</span>] <span class="op">+</span> score_cols</span>
<span id="cb148-7"><a href="#cb148-7"></a>cv_res[score_cols] <span class="op">=</span> <span class="op">-</span>cv_res[score_cols].<span class="bu">round</span>().astype(np.int64)</span>
<span id="cb148-8"><a href="#cb148-8"></a>cv_res.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">

  <div id="df-f43badb4-35ab-4d33-994a-f60427e23385">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">n_clusters</th>
<th data-quarto-table-cell-role="th">max_features</th>
<th data-quarto-table-cell-role="th">split0</th>
<th data-quarto-table-cell-role="th">split1</th>
<th data-quarto-table-cell-role="th">split2</th>
<th data-quarto-table-cell-role="th">mean_test_rmse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>45</td>
<td>9</td>
<td>41287</td>
<td>42071</td>
<td>42627</td>
<td>41995</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>32</td>
<td>7</td>
<td>41690</td>
<td>42513</td>
<td>43224</td>
<td>42475</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>41</td>
<td>16</td>
<td>42223</td>
<td>42959</td>
<td>43321</td>
<td>42834</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>42</td>
<td>4</td>
<td>41818</td>
<td>43094</td>
<td>43817</td>
<td>42910</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>23</td>
<td>8</td>
<td>42264</td>
<td>42996</td>
<td>43830</td>
<td>43030</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f43badb4-35ab-4d33-994a-f60427e23385')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f43badb4-35ab-4d33-994a-f60427e23385 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f43badb4-35ab-4d33-994a-f60427e23385');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Another way to fine-tune your system is to try to combine the models that perform best. This is especially true if the individual models make very different types of errors.</p>
</section>
<section id="analyze-the-best-models-and-their-errors" class="level3" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="analyze-the-best-models-and-their-errors"><span class="header-section-number">2.6.3</span> Analyze the Best Models and Their Errors</h3>
<p>You will often gain good insights on the problem by inspecting the best models. For example, the <code>RandomForestRegressor</code> can indicate the relative importance of each attribute for making accurate predictions</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:49,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097642,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0657352e-c48c-4d50-b286-0c7490d315c4">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1"></a>final_model <span class="op">=</span> rnd_search.best_estimator_  <span class="co"># includes preprocessing</span></span>
<span id="cb149-2"><a href="#cb149-2"></a>feature_importances <span class="op">=</span> final_model[<span class="st">"random_forest"</span>].feature_importances_</span>
<span id="cb149-3"><a href="#cb149-3"></a>feature_importances.<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>array([0.07, 0.05, 0.05, 0.01, 0.01, 0.01, 0.01, 0.19, 0.04, 0.01, 0.  ,
       0.01, 0.01, 0.01, 0.01, 0.01, 0.  , 0.01, 0.01, 0.01, 0.  , 0.01,
       0.01, 0.01, 0.01, 0.01, 0.  , 0.  , 0.02, 0.01, 0.01, 0.01, 0.02,
       0.01, 0.  , 0.02, 0.03, 0.01, 0.01, 0.01, 0.01, 0.01, 0.02, 0.01,
       0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.02, 0.01, 0.  , 0.07,
       0.  , 0.  , 0.  , 0.01])</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:44,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097643,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="04672b26-6a06-464a-adb7-de7546896ddc">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1"></a><span class="bu">sorted</span>(<span class="bu">zip</span>(feature_importances,</span>
<span id="cb151-2"><a href="#cb151-2"></a>           final_model[<span class="st">"preprocessing"</span>].get_feature_names_out()),</span>
<span id="cb151-3"><a href="#cb151-3"></a>           reverse<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>[(0.18694559869103852, 'log__median_income'),
 (0.0748194905715524, 'cat__ocean_proximity_INLAND'),
 (0.06926417748515576, 'bedrooms__ratio'),
 (0.05446998753775219, 'rooms_per_house__ratio'),
 (0.05262301809680712, 'people_per_house__ratio'),
 (0.03819415873915732, 'geo__Cluster 0 similarity'),
 (0.02879263999929514, 'geo__Cluster 28 similarity'),
 (0.023530192521380392, 'geo__Cluster 24 similarity'),
 (0.020544786346378206, 'geo__Cluster 27 similarity'),
 (0.019873052631077512, 'geo__Cluster 43 similarity'),
 (0.018597511022930273, 'geo__Cluster 34 similarity'),
 (0.017409085415656868, 'geo__Cluster 37 similarity'),
 (0.015546519677632162, 'geo__Cluster 20 similarity'),
 (0.014230331127504292, 'geo__Cluster 17 similarity'),
 (0.0141032216204026, 'geo__Cluster 39 similarity'),
 (0.014065768027447325, 'geo__Cluster 9 similarity'),
 (0.01354220782825315, 'geo__Cluster 4 similarity'),
 (0.01348963625822907, 'geo__Cluster 3 similarity'),
 (0.01338319626383868, 'geo__Cluster 38 similarity'),
 (0.012240533790212824, 'geo__Cluster 31 similarity'),
 (0.012089046542256785, 'geo__Cluster 7 similarity'),
 (0.01152326329703204, 'geo__Cluster 23 similarity'),
 (0.011397459905603558, 'geo__Cluster 40 similarity'),
 (0.011282340924816439, 'geo__Cluster 36 similarity'),
 (0.01104139770781063, 'remainder__housing_median_age'),
 (0.010671123191312802, 'geo__Cluster 44 similarity'),
 (0.010296376177202627, 'geo__Cluster 5 similarity'),
 (0.010184798445004483, 'geo__Cluster 42 similarity'),
 (0.010121853542225083, 'geo__Cluster 11 similarity'),
 (0.009795219101117579, 'geo__Cluster 35 similarity'),
 (0.00952581084310724, 'geo__Cluster 10 similarity'),
 (0.009433209165984823, 'geo__Cluster 13 similarity'),
 (0.00915075361116215, 'geo__Cluster 1 similarity'),
 (0.009021485619463173, 'geo__Cluster 30 similarity'),
 (0.00894936224917583, 'geo__Cluster 41 similarity'),
 (0.008901832702357514, 'geo__Cluster 25 similarity'),
 (0.008897504713401587, 'geo__Cluster 29 similarity'),
 (0.0086846298524955, 'geo__Cluster 21 similarity'),
 (0.008061104590483955, 'geo__Cluster 15 similarity'),
 (0.00786048176566994, 'geo__Cluster 16 similarity'),
 (0.007793633130749198, 'geo__Cluster 22 similarity'),
 (0.007501766442066527, 'log__total_rooms'),
 (0.0072024111938241275, 'geo__Cluster 32 similarity'),
 (0.006947156598995616, 'log__population'),
 (0.006800076770899128, 'log__households'),
 (0.006736105364684462, 'log__total_bedrooms'),
 (0.006315268213499131, 'geo__Cluster 33 similarity'),
 (0.005796398579893261, 'geo__Cluster 14 similarity'),
 (0.005234954623294958, 'geo__Cluster 6 similarity'),
 (0.0045514083468621595, 'geo__Cluster 12 similarity'),
 (0.004546042080216035, 'geo__Cluster 18 similarity'),
 (0.004314514641115755, 'geo__Cluster 2 similarity'),
 (0.003953528110719969, 'geo__Cluster 19 similarity'),
 (0.003297404747742136, 'geo__Cluster 26 similarity'),
 (0.00289453474290887, 'cat__ocean_proximity_&lt;1H OCEAN'),
 (0.0016978863168109126, 'cat__ocean_proximity_NEAR OCEAN'),
 (0.0016391131530559377, 'geo__Cluster 8 similarity'),
 (0.00015061247730531558, 'cat__ocean_proximity_NEAR BAY'),
 (7.301686597099842e-05, 'cat__ocean_proximity_ISLAND')]</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:39,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097643,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="78b7bb38-f5e5-4559-f734-aa7638f6e0b6">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1"></a>extra_attribs <span class="op">=</span> [<span class="st">"rooms_per_hhold"</span>, <span class="st">"pop_per_hhold"</span>, <span class="st">"bedrooms_per_room"</span>]</span>
<span id="cb153-2"><a href="#cb153-2"></a><span class="co">#cat_encoder = cat_pipeline.named_steps["cat_encoder"] # old solution</span></span>
<span id="cb153-3"><a href="#cb153-3"></a><span class="co">#cat_encoder = full_pipeline.named_transformers_["cat"]</span></span>
<span id="cb153-4"><a href="#cb153-4"></a><span class="co">#cat_one_hot_attribs = list(cat_encoder.categories_[0])</span></span>
<span id="cb153-5"><a href="#cb153-5"></a><span class="co">#attributes = num_attribs + extra_attribs + cat_one_hot_attribs</span></span>
<span id="cb153-6"><a href="#cb153-6"></a></span>
<span id="cb153-7"><a href="#cb153-7"></a>rel_imp <span class="op">=</span> pd.Series(feature_importances, index<span class="op">=</span>final_model[<span class="st">"preprocessing"</span>].get_feature_names_out()).sort_values(inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb153-8"><a href="#cb153-8"></a><span class="bu">print</span>(rel_imp[<span class="op">-</span><span class="dv">15</span>:])</span>
<span id="cb153-9"><a href="#cb153-9"></a>rel_imp[<span class="op">-</span><span class="dv">15</span>:].T.plot(kind<span class="op">=</span><span class="st">'barh'</span>, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb153-10"><a href="#cb153-10"></a>plt.xlabel(<span class="st">'Variable Importance'</span>)</span>
<span id="cb153-11"><a href="#cb153-11"></a>plt.gca().legend_ <span class="op">=</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>geo__Cluster 39 similarity     0.014103
geo__Cluster 17 similarity     0.014230
geo__Cluster 20 similarity     0.015547
geo__Cluster 37 similarity     0.017409
geo__Cluster 34 similarity     0.018598
geo__Cluster 43 similarity     0.019873
geo__Cluster 27 similarity     0.020545
geo__Cluster 24 similarity     0.023530
geo__Cluster 28 similarity     0.028793
geo__Cluster 0 similarity      0.038194
people_per_house__ratio        0.052623
rooms_per_house__ratio         0.054470
bedrooms__ratio                0.069264
cat__ocean_proximity_INLAND    0.074819
log__median_income             0.186946
dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-101-output-2.svg" class="img-fluid"></p>
</div>
</div>
<p>With this information, you may want to try dropping some of the less useful features (e.g., apparently only one ocean_proximity category is really useful, so you could try dropping the others)</p>
<p>You should also look at the specific errors that your system makes, then try to understand why it makes them and what could fix the problem (adding extra features or, on the contrary, getting rid of uninformative ones, cleaning up outliers, etc.).</p>
<blockquote class="blockquote">
<p>Now is also a good time to ensure that your model not only works well on average, but also on all categories of districts, whether they’re rural or urban, rich or poor, northern or southern, minority or not, etc. Creating subsets of your validation set for each category takes a bit of work, but it’s important: if your model performs poorly on a whole category of districts, then it should probably not be deployed until the issue is solved, or at least it should not be used to make predictions for that category, as it may do more harm than good!</p>
</blockquote>
</section>
<section id="evaluate-your-system-on-the-test-set" class="level3" data-number="2.6.4">
<h3 data-number="2.6.4" class="anchored" data-anchor-id="evaluate-your-system-on-the-test-set"><span class="header-section-number">2.6.4</span> Evaluate Your System on the Test Set</h3>
<p>After tweaking your models for a while, you eventually have a system that performs sufficiently well. Now is the time to evaluate the final model on the test set. Just get the predictors and the labels from your test set, and run your <code>final_model</code> to transform the data and make predictions, then evaluate these predictions:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:32,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097643,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ce8b9cd4-ae93-4b3b-94d8-30e145d8ed1c">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1"></a>X_test <span class="op">=</span> strat_test_set.drop(<span class="st">"median_house_value"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb155-2"><a href="#cb155-2"></a>y_test <span class="op">=</span> strat_test_set[<span class="st">"median_house_value"</span>].copy()</span>
<span id="cb155-3"><a href="#cb155-3"></a></span>
<span id="cb155-4"><a href="#cb155-4"></a>final_predictions <span class="op">=</span> final_model.predict(X_test)</span>
<span id="cb155-5"><a href="#cb155-5"></a></span>
<span id="cb155-6"><a href="#cb155-6"></a>final_rmse <span class="op">=</span> mean_squared_error(y_test, final_predictions, squared<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb155-7"><a href="#cb155-7"></a><span class="bu">print</span>(final_rmse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>41424.40026462184</code></pre>
</div>
</div>
<p>In some cases, such a point estimate of the generalization error will not be quite enough to convince you to launch: what if it is just 0.1% better than the model currently in production? You might want to have an idea of how precise this estimate is.</p>
<p>For this, you can compute a 95% confidence interval for the generalization error using <code>scipy.stats.t.interval()</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:28,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097643,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="137613ec-33e0-4d44-e056-65d90efedfbb">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb157-2"><a href="#cb157-2"></a></span>
<span id="cb157-3"><a href="#cb157-3"></a>confidence <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb157-4"><a href="#cb157-4"></a>squared_errors <span class="op">=</span> (final_predictions <span class="op">-</span> y_test) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb157-5"><a href="#cb157-5"></a>np.sqrt(stats.t.interval(confidence, <span class="bu">len</span>(squared_errors) <span class="op">-</span> <span class="dv">1</span>, loc<span class="op">=</span>squared_errors.mean(), scale<span class="op">=</span>stats.sem(squared_errors)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>array([39275.40861216, 43467.27680583])</code></pre>
</div>
</div>
<p>We could compute the interval manually like this:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:25,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097644,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a1e9beaa-d613-4213-b79c-1a8feb278757">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1"></a>m <span class="op">=</span> <span class="bu">len</span>(squared_errors)</span>
<span id="cb159-2"><a href="#cb159-2"></a>mean <span class="op">=</span> squared_errors.mean()</span>
<span id="cb159-3"><a href="#cb159-3"></a>tscore <span class="op">=</span> stats.t.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>, df<span class="op">=</span>m <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb159-4"><a href="#cb159-4"></a>tmargin <span class="op">=</span> tscore <span class="op">*</span> squared_errors.std(ddof<span class="op">=</span><span class="dv">1</span>) <span class="op">/</span> np.sqrt(m)</span>
<span id="cb159-5"><a href="#cb159-5"></a>np.sqrt(mean <span class="op">-</span> tmargin), np.sqrt(mean <span class="op">+</span> tmargin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>(39275.40861216077, 43467.2768058342)</code></pre>
</div>
</div>
<p>Alternatively, we could use a z-scores rather than t-scores:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:21,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097644,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="866fff78-d748-4347-bfca-592b60e36095">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1"></a>zscore <span class="op">=</span> stats.norm.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb161-2"><a href="#cb161-2"></a>zmargin <span class="op">=</span> zscore <span class="op">*</span> squared_errors.std(ddof<span class="op">=</span><span class="dv">1</span>) <span class="op">/</span> np.sqrt(m)</span>
<span id="cb161-3"><a href="#cb161-3"></a>np.sqrt(mean <span class="op">-</span> zmargin), np.sqrt(mean <span class="op">+</span> zmargin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>(39276.05610140007, 43466.691749969636)</code></pre>
</div>
</div>
<p>The performance will usually be slightly worse than what you measured using cross-validation if you did a lot of hyperparameter tuning (<strong>because your system ends up fine-tuned to perform well on the validation data, and will likely not perform as well on unknown datasets</strong>). It is not the case in this example, but when this happens you must resist the temptation to tweak the hyperparameters to make the numbers look good on the test set; the improvements would be unlikely to generalize to new data.</p>
<p>Now comes the project prelaunch phase: you need to present your solution highlighting what you have learned, what worked and what did not, what assumptions were made, and what your system’s limitations are), document everything, and create nice presentations with clear visualizations and easy-to-remember statements (e.g., “the median income is the number one predictor of housing prices”).</p>
<p>In this California housing example, the final performance of the system is not much better than the experts’, but it may still be a good idea to launch it, especially if this frees up some time for the experts so they can work on more interesting and productive tasks.</p>
</section>
</section>
<section id="launch-monitor-and-maintain-your-system" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="launch-monitor-and-maintain-your-system"><span class="header-section-number">2.7</span> Launch, Monitor, and Maintain Your System</h2>
<p>Perfect, you got approval to launch! You now need to get your solution ready for production (e.g., polish the code, write documentation and tests, and so on). Then you can deploy your model to your production environment.</p>
<p>The most basic way to do this is just to save the best model you trained, transfer the file to your production environment, and load it. To save the model, you can use the <code>joblib</code> library like this:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:16,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012097644,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9bc885cd-869e-4a74-8d8a-a70f4730da7b">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1"></a><span class="im">import</span> joblib</span>
<span id="cb163-2"><a href="#cb163-2"></a></span>
<span id="cb163-3"><a href="#cb163-3"></a>joblib.dump(final_model, <span class="st">"my_california_housing_model.pkl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>['my_california_housing_model.pkl']</code></pre>
</div>
</div>
<p>Once your model is transferred to production, you can load it and use it. For this you must first import any custom classes and functions the model relies on (which means transferring the code to production), then load the model using <code>joblib</code> and use it to make predictions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1"></a><span class="im">import</span> joblib</span>
<span id="cb165-2"><a href="#cb165-2"></a></span>
<span id="cb165-3"><a href="#cb165-3"></a>final_model_reloaded <span class="op">=</span> joblib.load(<span class="st">"my_california_housing_model.pkl"</span>)</span>
<span id="cb165-4"><a href="#cb165-4"></a></span>
<span id="cb165-5"><a href="#cb165-5"></a>new_data <span class="op">=</span> housing.iloc[:<span class="dv">5</span>]  <span class="co"># pretend these are new districts</span></span>
<span id="cb165-6"><a href="#cb165-6"></a>predictions <span class="op">=</span> final_model_reloaded.predict(new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example, perhaps the model will be used within a website: the user will type in some data about a new district and click the Estimate Price button. This will send a query containing the data to the web server, which will forward it to your web application, and finally your code will simply call the model’s <code>predict()</code> method (<strong>you want to load the model upon server startup</strong>, rather than every time the model is used).</p>
<p>Alternatively, you can wrap the model within a dedicated web service that your web application can query through a REST API. This makes it easier to upgrade your model to new versions without interrupting the main application. It also simplifies scaling, since you can start as many web services as needed and load-balance the requests coming from your web application across these web services. Moreover, it allows your web application to use any language, not just Python.</p>
<p>Another popular strategy is to deploy your model to the cloud, for example on Google’s Vertex AI (formerly known as Google Cloud AI Platform and Google Cloud ML Engine): just save your model using <code>joblib</code> and upload it to Google Cloud Storage (GCS), then head over to Vertex AI and create a new model version, pointing it to the GCS file. That’s it! This gives you a simple web service that takes care of load balancing and scaling for you.</p>
<p>It take JSON requests containing the input data (e.g., of a district) and returns JSON responses containing the predictions. You can then use this web service in your website (or whatever production environment you are using). As we will see in model serving lesson that we will use it on AI Platform is not much different from deploying Scikit-Learn models.</p>
<p>But deployment is not the end of the story. You also need to write <strong>monitoring code to check your system’s live performance at regular intervals and trigger alerts when it drops</strong>. This could be a steep drop, likely due to a broken component in your infrastructure, but be aware that it could also be a gentle decay that could easily go unnoticed for a long time. This is quite common because models tend to “rot” over time: indeed, the world changes, so if the model was trained with last year’s data, it may not be adapted to today’s data.</p>
<section id="deployment" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="deployment"><span class="header-section-number">2.7.1</span> Deployment</h3>
<p>So you need to monitor your model’s live performance. But how do you that? Well, it depends. In some cases, the model’s performance can be inferred from <strong>downstream metrics</strong>. For example, if your model is part of a recommender system and it suggests products that the users may be interested in, then it’s easy to monitor the number of recommended products sold each day. If this number drops (compared to non-recommended products), then the prime suspect is the model. This may be because the data pipeline is broken, or perhaps the model needs to be retrained on fresh data.</p>
<p>However, it’s not always possible to determine the model’s performance without any human analysis. For example, suppose you trained an image classification model to detect several product defects on a production line. How can you get an alert if the model’s performance drops, before thousands of defective products get shipped to your clients? One solution is to send to human raters a sample of all the pictures that the model classified (especially pictures that the model wasn’t so sure about). Depending on the task, the raters may need to be experts, or they could be nonspecialists, such as workers on a crowdsourcing platform (e.g., Amazon Mechanical Turk). In some applications they could even be the users themselves, responding for example via surveys or repurposed captchas. Either way, you need to put in place a monitoring system (with or without human raters to evaluate the live model), as well as all the relevant processes to define what to do in case of failures and how to prepare for them.</p>
<p>Unfortunately, this can be a lot of work. In fact, <strong>it is often much more work than building and training a model</strong>. If the data keeps evolving, you will need to update your datasets and retrain your model regularly. You should probably automate the whole process as much as possible. Here are a few things you can automate:</p>
<ul>
<li>Collect fresh data regularly and label it (e.g., using human raters).</li>
<li>Write a script to train the model and fine-tune the hyperparameters automatically. This script could run automatically, for example every day or every week, depending on your needs.</li>
<li>Write another script that will evaluate both the new model and the previous model on the updated test set, and deploy the model to production if the performance has not decreased (if it did, make sure you investigate why). The script should probably test the performance of your model on various subsets of the test set, such as poor or rich districts, rural or urban districts, etc.</li>
</ul>
<p>You should also make sure <strong>you evaluate the model’s input data quality</strong>. Sometimes performance will degrade slightly because of a poor-quality signal (e.g., a malfunctioning sensor sending random values, or another team’s output becoming stale), but it may take a while before your system’s performance degrades enough to trigger an alert. If you monitor your model’s inputs, you may catch this earlier. For example, you could trigger an alert if more and more inputs are missing a feature, or if its mean or standard deviation drifts too far from the training set, or a categorical feature starts containing new categories.</p>
<p>Finally, make sure you keep <strong>backups of every model</strong> you create and have the process and tools in place to roll back to a previous model quickly, in case the new model starts failing badly for some reason. Having backups also makes it possible to easily compare new models with previous ones. Similarly, you should keep backups of every version of your datasets so that you can roll back to a previous dataset if the new one ever gets corrupted (e.g., if the fresh data that gets added to it turns out to be full of outliers). Having backups of your datasets also allows you to evaluate any model against any previous dataset.</p>
<p>As you can see, Machine Learning involves quite a lot of infrastructure, so don’t be surprised if your first ML project takes a lot of effort and time to build and deploy to production. Fortunately, once all the infrastructure is in place, going from idea to production will be much faster.</p>
</section>
</section>
<section id="low-code-ml-using-pycaret" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="low-code-ml-using-pycaret"><span class="header-section-number">2.8</span> Low-code ML using <code>PyCaret</code></h2>
<p><code>PyCaret</code> is a high-level, low-code Python library that makes it easy to compare, train, evaluate, tune, and deploy machine learning models with only a few lines of code.</p>
<p>At its core, <code>PyCaret</code> is basically just a large wrapper over many data science libraries such as <code>Scikit-learn</code>, <code>Yellowbrick</code>, <code>SHAP</code>, <code>Optuna</code>, and <code>Spacy</code>. Yes, you could use these libraries for the same tasks, but if you don’t want to write a lot of code, PyCaret could save you a lot of time.</p>
<p><a href="https://pycaret.readthedocs.io/en/latest/api/regression.html">https://pycaret.readthedocs.io/en/latest/api/regression.html</a></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:288960,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676260915928,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3b6603c1-e635-4743-efbe-3ea53123e446">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1"></a><span class="op">!</span>pip install <span class="op">--</span>pre pycaret[full] <span class="op">-</span>qq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 480.1/480.1 KB 25.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 9.2/9.2 MB 93.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.9/79.9 MB 11.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 213.0/213.0 KB 28.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 280.2/280.2 KB 24.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.0/16.0 MB 73.5 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 81.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 106.8/106.8 KB 12.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 45.8/45.8 KB 6.5 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
  WARNING: Requested plotly-resampler&gt;=0.7.2.2 from https://files.pythonhosted.org/packages/d7/5e/71a9e34a36c1855d0c4e30a88405d58c4bbbe7ece802b188628a643f2cda/plotly_resampler-0.8.4rc1.tar.gz#sha256=154ebffa9778813fe457ac9112e71e085ac283644a1e26b869bd5c6b7bf064a2 (from pycaret[full]), but installing version 0.8.4rc1
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 81.2/81.2 KB 11.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 KB 9.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.8/43.8 KB 6.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 50.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 147.7/147.7 KB 20.6 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 84.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 7.6/7.6 MB 99.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.1/12.1 MB 93.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 324.4/324.4 KB 35.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100.3/100.3 KB 14.5 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 362.2/362.2 KB 29.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 92.0/92.0 KB 10.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 61.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 76.6/76.6 MB 11.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.9/56.9 KB 7.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 9.9/9.9 MB 70.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 83.0/83.0 KB 10.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 317.1/317.1 KB 28.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 88.2/88.2 KB 9.9 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.3/1.3 MB 75.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 277.8/277.8 KB 29.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 575.9/575.9 KB 54.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 41.1/41.1 KB 6.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 177.5/177.5 KB 23.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.2/56.2 KB 7.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 14.2/14.2 MB 84.5 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 101.5/101.5 KB 17.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 365.3/365.3 KB 38.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 92.2/92.2 KB 12.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.4/57.4 MB 14.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 193.6/193.6 MB 7.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 64.7/64.7 KB 9.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.0/17.0 MB 68.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 KB 13.5 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 464.9/464.9 KB 37.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.9/12.9 MB 71.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 240.9/240.9 KB 19.2 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.2/3.2 MB 66.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.6/16.6 MB 49.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 58.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.4/10.4 MB 105.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 KB 10.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 227.8/227.8 KB 1.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 54.3/54.3 KB 4.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 54.5/54.5 KB 8.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 508.4/508.4 KB 45.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.5/3.5 MB 94.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 181.3/181.3 KB 26.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 135.5/135.5 KB 20.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 793.8/793.8 KB 54.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 129.4/129.4 KB 17.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.5/40.5 KB 5.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 15.2/15.2 MB 92.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 9.9/9.9 MB 102.5 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 662.4/662.4 KB 53.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.7/57.7 KB 9.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 471.0/471.0 KB 50.7 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 47.0/47.0 KB 5.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 219.7/219.7 KB 25.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 83.1/83.1 KB 11.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 65.8/65.8 KB 10.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 96.6/96.6 KB 15.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 133.1/133.1 KB 19.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 232.7/232.7 KB 28.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 187.8/187.8 KB 22.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 154.1/154.1 KB 20.3 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.6/71.6 KB 8.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 227.5/227.5 KB 21.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 51.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.5/71.5 KB 9.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 107.0/107.0 KB 11.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.7/140.7 KB 15.9 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 59.1 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 84.5/84.5 KB 11.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 200.5/200.5 KB 21.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.9/8.9 MB 94.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 29.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 300.0/300.0 KB 19.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 965.4/965.4 KB 43.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 82.3/82.3 KB 11.5 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 147.5/147.5 KB 16.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 184.0/184.0 KB 23.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.5/79.5 KB 11.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.8/40.8 KB 6.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 210.6/210.6 KB 22.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 27.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 51.1/51.1 KB 5.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 344.5/344.5 KB 34.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 68.8/68.8 KB 6.7 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 45.5/45.5 KB 4.8 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 44.6/44.6 KB 5.0 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 96.0/96.0 KB 8.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 185.1/185.1 KB 12.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.7/8.7 MB 8.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 114.5/114.5 KB 7.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.6/12.6 MB 10.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 85.5/85.5 MB 7.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.0/4.0 MB 22.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.1/1.1 MB 24.0 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 58.3/58.3 KB 8.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.0/132.0 KB 16.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 983.2/983.2 KB 43.8 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 78.7/78.7 KB 11.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 55.9/55.9 KB 7.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.6/140.6 KB 17.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 934.8/934.8 KB 59.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 144.2/144.2 KB 20.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.7/62.7 KB 9.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 275.7/275.7 KB 32.1 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.6/3.6 MB 72.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.5/6.5 MB 78.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 758.0/758.0 KB 58.0 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 50.5/50.5 KB 7.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 18.5/18.5 MB 65.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 384.9/384.9 KB 39.5 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 80.6/80.6 KB 10.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 135.3/135.3 KB 15.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 468.5/468.5 KB 37.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 64.4/64.4 KB 8.6 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 136.5/136.5 KB 15.2 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 69.6/69.6 KB 8.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.0/121.0 KB 16.6 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.7/102.7 KB 10.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 9.4/9.4 MB 63.1 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 679.5/679.5 KB 43.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.7/4.7 MB 87.7 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 296.5/296.5 KB 35.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 261.4/261.4 KB 27.4 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 133.4/133.4 KB 13.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 57.3/57.3 KB 8.9 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 357.2/357.2 KB 42.3 MB/s eta 0:00:00
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 83.6/83.6 KB 11.6 MB/s eta 0:00:00
  Building wheel for pyod (setup.py) ... done
  Building wheel for umap-learn (setup.py) ... done
  Building wheel for databricks-cli (setup.py) ... done
  Building wheel for fugue-sql-antlr (setup.py) ... done
  Building wheel for pynndescent (setup.py) ... done
  Building wheel for PyNomaly (setup.py) ... done
  Building wheel for dash-auth (setup.py) ... done
  Building wheel for emoji (setup.py) ... done
  Building wheel for ffmpy (setup.py) ... done
  Building wheel for python-multipart (setup.py) ... done
  Building wheel for htmlmin (setup.py) ... done
  Building wheel for lime (setup.py) ... done
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
google-colab 1.0.0 requires ipython~=7.9.0, but you have ipython 7.34.0 which is incompatible.</code></pre>
</div>
</div>
<p>Remember to restart the notebook to update the modules</p>
<section id="get-the-data-1" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="get-the-data-1"><span class="header-section-number">2.8.1</span> Get the data</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:748,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015055540,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9b7f9c1d-af11-4d9c-8a4b-b40d429370bc">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> StratifiedShuffleSplit</span>
<span id="cb168-2"><a href="#cb168-2"></a></span>
<span id="cb168-3"><a href="#cb168-3"></a>housing <span class="op">=</span> load_housing_data() <span class="co">#Let’s take a look at the top five rows. Each row represents one district. There are 10 attributes</span></span>
<span id="cb168-4"><a href="#cb168-4"></a>housing.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

  <div id="df-34198b9a-de17-49f9-a30a-7ef7f287b7cb">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-122.23</td>
<td>37.88</td>
<td>41.0</td>
<td>880.0</td>
<td>129.0</td>
<td>322.0</td>
<td>126.0</td>
<td>8.3252</td>
<td>452600.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-122.22</td>
<td>37.86</td>
<td>21.0</td>
<td>7099.0</td>
<td>1106.0</td>
<td>2401.0</td>
<td>1138.0</td>
<td>8.3014</td>
<td>358500.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-122.24</td>
<td>37.85</td>
<td>52.0</td>
<td>1467.0</td>
<td>190.0</td>
<td>496.0</td>
<td>177.0</td>
<td>7.2574</td>
<td>352100.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-122.25</td>
<td>37.85</td>
<td>52.0</td>
<td>1274.0</td>
<td>235.0</td>
<td>558.0</td>
<td>219.0</td>
<td>5.6431</td>
<td>341300.0</td>
<td>NEAR BAY</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-122.25</td>
<td>37.85</td>
<td>52.0</td>
<td>1627.0</td>
<td>280.0</td>
<td>565.0</td>
<td>259.0</td>
<td>3.8462</td>
<td>342200.0</td>
<td>NEAR BAY</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-34198b9a-de17-49f9-a30a-7ef7f287b7cb')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-34198b9a-de17-49f9-a30a-7ef7f287b7cb button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-34198b9a-de17-49f9-a30a-7ef7f287b7cb');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>Now that we have the data, we can initialize a <code>PyCaret</code> experiment, which will preprocess the data and enable logging for all of the models that we will train on this dataset.</p>
</section>
<section id="explore-the-data" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="explore-the-data"><span class="header-section-number">2.8.2</span> Explore the data</h3>
<p><code>ydata-profiling</code> primary goal is to provide a one-line Exploratory Data Analysis (EDA) experience in a consistent and fast solution. Like pandas <code>df.describe()</code> function, that is so handy, <code>ydata-profiling</code> delivers an extended analysis of a DataFrame while allowing the data analysis to be exported in different formats such as html and json.</p>
<p><a href="https://github.com/ydataai/ydata-profiling">https://github.com/ydataai/ydata-profiling</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1"></a><span class="im">from</span> ydata_profiling <span class="im">import</span> ProfileReport</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1"></a>profile <span class="op">=</span> ProfileReport(housing, title<span class="op">=</span><span class="st">"Profiling Report"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:50235,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676012366959,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d8869481-06a2-46af-ef20-05c436dd20be">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1"></a>profile.to_notebook_iframe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
<p>The <code>setup()</code> function initializes the environment in pycaret and creates the transformation pipeline to prepare the data for modeling and deployment. <code>setup()</code> must be called before executing any other function in pycaret. It takes two mandatory parameters: a pandas dataframe and the name of the target column. All other parameters are optional and are used to customize the pre-processing pipeline.</p>
<p>When <code>setup()</code> is executed, PyCaret’s inference algorithm will automatically infer the data types for all features based on certain properties. The data type should be inferred correctly but this is not always the case. To account for this, PyCaret displays a table containing the features and their inferred data types after <code>setup()</code> is executed.</p>
<blockquote class="blockquote">
<p>Ensuring that the data types are correct is of fundamental importance in PyCaret as it automatically performs a few pre-processing tasks which are imperative to any machine learning experiment. These tasks are performed differently for each data type which means it is very important for them to be correctly configured.</p>
</blockquote>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/initialize">https://pycaret.gitbook.io/docs/get-started/functions/initialize</a></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:16991,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015083550,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d7e02fba-4040-4468-e875-ebe4b1bad351">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1"></a><span class="im">from</span> pycaret.regression <span class="im">import</span> <span class="op">*</span></span>
<span id="cb173-2"><a href="#cb173-2"></a>exp1 <span class="op">=</span> setup(data <span class="op">=</span> housing, target <span class="op">=</span> <span class="st">'median_house_value'</span>, session_id<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<table id="T_e0338_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Description</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_e0338_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_e0338_row0_col0" class="data row0 col0">Session id</td>
<td id="T_e0338_row0_col1" class="data row0 col1">123</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_e0338_row1_col0" class="data row1 col0">Target</td>
<td id="T_e0338_row1_col1" class="data row1 col1">median_house_value</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_e0338_row2_col0" class="data row2 col0">Target type</td>
<td id="T_e0338_row2_col1" class="data row2 col1">Regression</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_e0338_row3_col0" class="data row3 col0">Original data shape</td>
<td id="T_e0338_row3_col1" class="data row3 col1">(20640, 10)</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_e0338_row4_col0" class="data row4 col0">Transformed data shape</td>
<td id="T_e0338_row4_col1" class="data row4 col1">(20640, 14)</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_e0338_row5_col0" class="data row5 col0">Transformed train set shape</td>
<td id="T_e0338_row5_col1" class="data row5 col1">(14447, 14)</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_e0338_row6_col0" class="data row6 col0">Transformed test set shape</td>
<td id="T_e0338_row6_col1" class="data row6 col1">(6193, 14)</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_e0338_row7_col0" class="data row7 col0">Numeric features</td>
<td id="T_e0338_row7_col1" class="data row7 col1">8</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_e0338_row8_col0" class="data row8 col0">Categorical features</td>
<td id="T_e0338_row8_col1" class="data row8 col1">1</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_e0338_row9_col0" class="data row9 col0">Rows with missing values</td>
<td id="T_e0338_row9_col1" class="data row9 col1">1.0%</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">10</td>
<td id="T_e0338_row10_col0" class="data row10 col0">Preprocess</td>
<td id="T_e0338_row10_col1" class="data row10 col1">True</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">11</td>
<td id="T_e0338_row11_col0" class="data row11 col0">Imputation type</td>
<td id="T_e0338_row11_col1" class="data row11 col1">simple</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">12</td>
<td id="T_e0338_row12_col0" class="data row12 col0">Numeric imputation</td>
<td id="T_e0338_row12_col1" class="data row12 col1">mean</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">13</td>
<td id="T_e0338_row13_col0" class="data row13 col0">Categorical imputation</td>
<td id="T_e0338_row13_col1" class="data row13 col1">mode</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">14</td>
<td id="T_e0338_row14_col0" class="data row14 col0">Maximum one-hot encoding</td>
<td id="T_e0338_row14_col1" class="data row14 col1">25</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row15" class="row_heading level0 row15" data-quarto-table-cell-role="th">15</td>
<td id="T_e0338_row15_col0" class="data row15 col0">Encoding method</td>
<td id="T_e0338_row15_col1" class="data row15 col1">None</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row16" class="row_heading level0 row16" data-quarto-table-cell-role="th">16</td>
<td id="T_e0338_row16_col0" class="data row16 col0">Fold Generator</td>
<td id="T_e0338_row16_col1" class="data row16 col1">KFold</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row17" class="row_heading level0 row17" data-quarto-table-cell-role="th">17</td>
<td id="T_e0338_row17_col0" class="data row17 col0">Fold Number</td>
<td id="T_e0338_row17_col1" class="data row17 col1">10</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row18" class="row_heading level0 row18" data-quarto-table-cell-role="th">18</td>
<td id="T_e0338_row18_col0" class="data row18 col0">CPU Jobs</td>
<td id="T_e0338_row18_col1" class="data row18 col1">-1</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row19" class="row_heading level0 row19" data-quarto-table-cell-role="th">19</td>
<td id="T_e0338_row19_col0" class="data row19 col0">Use GPU</td>
<td id="T_e0338_row19_col1" class="data row19 col1">False</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row20" class="row_heading level0 row20" data-quarto-table-cell-role="th">20</td>
<td id="T_e0338_row20_col0" class="data row20 col0">Log Experiment</td>
<td id="T_e0338_row20_col1" class="data row20 col1">False</td>
</tr>
<tr class="even">
<td id="T_e0338_level0_row21" class="row_heading level0 row21" data-quarto-table-cell-role="th">21</td>
<td id="T_e0338_row21_col0" class="data row21 col0">Experiment Name</td>
<td id="T_e0338_row21_col1" class="data row21 col1">reg-default-name</td>
</tr>
<tr class="odd">
<td id="T_e0338_level0_row22" class="row_heading level0 row22" data-quarto-table-cell-role="th">22</td>
<td id="T_e0338_row22_col0" class="data row22 col0">USI</td>
<td id="T_e0338_row22_col1" class="data row22 col1">1e11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <code>eda()</code> function generates automated Exploratory Data Analysis (EDA) using the <code>AutoViz</code> library.</p>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/analyze#eda">https://pycaret.gitbook.io/docs/get-started/functions/analyze#eda</a></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:10050,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015097053,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="70a879f3-88d7-4979-c799-c5fc2ce21873">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1"></a>eda(display_format <span class="op">=</span> <span class="st">'bokeh'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Output hidden; open in https://colab.research.google.com to view.</code></pre>
</div>
</div>
</section>
<section id="prepare-the-data" class="level3" data-number="2.8.3">
<h3 data-number="2.8.3" class="anchored" data-anchor-id="prepare-the-data"><span class="header-section-number">2.8.3</span> Prepare the data</h3>
<p>In order to demonstrate the <code>predict_model()</code> function on unseen data, a sample of 10% records has been withheld from the original dataset to be used for predictions. This should not be confused with a train/test split as this particular split is performed to simulate a real life scenario. Another way to think about this is that these records are not available at the time when the machine learning experiment was performed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb176-2"><a href="#cb176-2"></a></span>
<span id="cb176-3"><a href="#cb176-3"></a>housing, data_unseen <span class="op">=</span> train_test_split(housing, test_size<span class="op">=</span><span class="fl">0.1</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://pycaret.gitbook.io/docs/get-started/preprocessing">https://pycaret.gitbook.io/docs/get-started/preprocessing</a></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:498,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015110780,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5b612391-b4fa-4a3f-bfc7-d4cdf5db1918">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1"></a><span class="co">"""</span></span>
<span id="cb177-2"><a href="#cb177-2"></a><span class="co">class columnDropperTransformer(TransformerMixin):</span></span>
<span id="cb177-3"><a href="#cb177-3"></a><span class="co">    def __init__(self,columns):</span></span>
<span id="cb177-4"><a href="#cb177-4"></a><span class="co">        self.columns=columns</span></span>
<span id="cb177-5"><a href="#cb177-5"></a></span>
<span id="cb177-6"><a href="#cb177-6"></a><span class="co">    def transform(self,X,y=None):</span></span>
<span id="cb177-7"><a href="#cb177-7"></a><span class="co">        return X.drop(self.columns,axis=1)</span></span>
<span id="cb177-8"><a href="#cb177-8"></a></span>
<span id="cb177-9"><a href="#cb177-9"></a><span class="co">    def fit(self, X, y=None):</span></span>
<span id="cb177-10"><a href="#cb177-10"></a><span class="co">        return self </span></span>
<span id="cb177-11"><a href="#cb177-11"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>'\nclass columnDropperTransformer(TransformerMixin):\n    def __init__(self,columns):\n        self.columns=columns\n\n    def transform(self,X,y=None):\n        return X.drop(self.columns,axis=1)\n\n    def fit(self, X, y=None):\n        return self \n'</code></pre>
</div>
</div>
<p>Note that starting from PyCaret 3.0, it supports OOP API.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:15605,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015127172,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="da9687d7-afc2-49c6-d53a-5ca103350e9c">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1"></a>housing[<span class="st">"income_cat"</span>] <span class="op">=</span> pd.cut(housing[<span class="st">"median_income"</span>],</span>
<span id="cb179-2"><a href="#cb179-2"></a>                               bins<span class="op">=</span>[<span class="fl">0.</span>, <span class="fl">1.5</span>, <span class="fl">3.0</span>, <span class="fl">4.5</span>, <span class="fl">6.</span>, np.inf],</span>
<span id="cb179-3"><a href="#cb179-3"></a>                               labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb179-4"><a href="#cb179-4"></a></span>
<span id="cb179-5"><a href="#cb179-5"></a><span class="co"># log_experiment = 'wandb',</span></span>
<span id="cb179-6"><a href="#cb179-6"></a>reg_experiment <span class="op">=</span> setup(housing, </span>
<span id="cb179-7"><a href="#cb179-7"></a>            target <span class="op">=</span> <span class="st">'median_house_value'</span>, </span>
<span id="cb179-8"><a href="#cb179-8"></a>            train_size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span id="cb179-9"><a href="#cb179-9"></a>            data_split_stratify <span class="op">=</span> [<span class="st">'income_cat'</span>],</span>
<span id="cb179-10"><a href="#cb179-10"></a>            numeric_imputation <span class="op">=</span> <span class="st">'median'</span>,</span>
<span id="cb179-11"><a href="#cb179-11"></a>            categorical_imputation <span class="op">=</span> <span class="st">'mode'</span>,</span>
<span id="cb179-12"><a href="#cb179-12"></a>            normalize <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb179-13"><a href="#cb179-13"></a>            remove_outliers <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb179-14"><a href="#cb179-14"></a>            <span class="co">#custom_pipeline = columnDropperTransformer(['income_cat_1.0','income_cat_2.0','income_cat_3.0','income_cat_4.0','income_cat_5.0']),</span></span>
<span id="cb179-15"><a href="#cb179-15"></a>            session_id <span class="op">=</span> <span class="dv">42</span>, </span>
<span id="cb179-16"><a href="#cb179-16"></a>            <span class="co">#log_experiment=True,</span></span>
<span id="cb179-17"><a href="#cb179-17"></a>            profile <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb179-18"><a href="#cb179-18"></a>            experiment_name<span class="op">=</span><span class="st">'ca_housing'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<table id="T_973b0_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Description</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_973b0_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_973b0_row0_col0" class="data row0 col0">Session id</td>
<td id="T_973b0_row0_col1" class="data row0 col1">42</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_973b0_row1_col0" class="data row1 col0">Target</td>
<td id="T_973b0_row1_col1" class="data row1 col1">median_house_value</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_973b0_row2_col0" class="data row2 col0">Target type</td>
<td id="T_973b0_row2_col1" class="data row2 col1">Regression</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_973b0_row3_col0" class="data row3 col0">Original data shape</td>
<td id="T_973b0_row3_col1" class="data row3 col1">(18576, 11)</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_973b0_row4_col0" class="data row4 col0">Transformed data shape</td>
<td id="T_973b0_row4_col1" class="data row4 col1">(17951, 19)</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_973b0_row5_col0" class="data row5 col0">Transformed train set shape</td>
<td id="T_973b0_row5_col1" class="data row5 col1">(14236, 19)</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_973b0_row6_col0" class="data row6 col0">Transformed test set shape</td>
<td id="T_973b0_row6_col1" class="data row6 col1">(3716, 19)</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_973b0_row7_col0" class="data row7 col0">Numeric features</td>
<td id="T_973b0_row7_col1" class="data row7 col1">8</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_973b0_row8_col0" class="data row8 col0">Categorical features</td>
<td id="T_973b0_row8_col1" class="data row8 col1">2</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_973b0_row9_col0" class="data row9 col0">Rows with missing values</td>
<td id="T_973b0_row9_col1" class="data row9 col1">1.0%</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">10</td>
<td id="T_973b0_row10_col0" class="data row10 col0">Preprocess</td>
<td id="T_973b0_row10_col1" class="data row10 col1">True</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">11</td>
<td id="T_973b0_row11_col0" class="data row11 col0">Imputation type</td>
<td id="T_973b0_row11_col1" class="data row11 col1">simple</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">12</td>
<td id="T_973b0_row12_col0" class="data row12 col0">Numeric imputation</td>
<td id="T_973b0_row12_col1" class="data row12 col1">median</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">13</td>
<td id="T_973b0_row13_col0" class="data row13 col0">Categorical imputation</td>
<td id="T_973b0_row13_col1" class="data row13 col1">mode</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">14</td>
<td id="T_973b0_row14_col0" class="data row14 col0">Maximum one-hot encoding</td>
<td id="T_973b0_row14_col1" class="data row14 col1">25</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row15" class="row_heading level0 row15" data-quarto-table-cell-role="th">15</td>
<td id="T_973b0_row15_col0" class="data row15 col0">Encoding method</td>
<td id="T_973b0_row15_col1" class="data row15 col1">None</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row16" class="row_heading level0 row16" data-quarto-table-cell-role="th">16</td>
<td id="T_973b0_row16_col0" class="data row16 col0">Remove outliers</td>
<td id="T_973b0_row16_col1" class="data row16 col1">True</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row17" class="row_heading level0 row17" data-quarto-table-cell-role="th">17</td>
<td id="T_973b0_row17_col0" class="data row17 col0">Outliers threshold</td>
<td id="T_973b0_row17_col1" class="data row17 col1">0.050000</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row18" class="row_heading level0 row18" data-quarto-table-cell-role="th">18</td>
<td id="T_973b0_row18_col0" class="data row18 col0">Normalize</td>
<td id="T_973b0_row18_col1" class="data row18 col1">True</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row19" class="row_heading level0 row19" data-quarto-table-cell-role="th">19</td>
<td id="T_973b0_row19_col0" class="data row19 col0">Normalize method</td>
<td id="T_973b0_row19_col1" class="data row19 col1">zscore</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row20" class="row_heading level0 row20" data-quarto-table-cell-role="th">20</td>
<td id="T_973b0_row20_col0" class="data row20 col0">Fold Generator</td>
<td id="T_973b0_row20_col1" class="data row20 col1">KFold</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row21" class="row_heading level0 row21" data-quarto-table-cell-role="th">21</td>
<td id="T_973b0_row21_col0" class="data row21 col0">Fold Number</td>
<td id="T_973b0_row21_col1" class="data row21 col1">10</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row22" class="row_heading level0 row22" data-quarto-table-cell-role="th">22</td>
<td id="T_973b0_row22_col0" class="data row22 col0">CPU Jobs</td>
<td id="T_973b0_row22_col1" class="data row22 col1">-1</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row23" class="row_heading level0 row23" data-quarto-table-cell-role="th">23</td>
<td id="T_973b0_row23_col0" class="data row23 col0">Use GPU</td>
<td id="T_973b0_row23_col1" class="data row23 col1">False</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row24" class="row_heading level0 row24" data-quarto-table-cell-role="th">24</td>
<td id="T_973b0_row24_col0" class="data row24 col0">Log Experiment</td>
<td id="T_973b0_row24_col1" class="data row24 col1">False</td>
</tr>
<tr class="even">
<td id="T_973b0_level0_row25" class="row_heading level0 row25" data-quarto-table-cell-role="th">25</td>
<td id="T_973b0_row25_col0" class="data row25 col0">Experiment Name</td>
<td id="T_973b0_row25_col1" class="data row25 col1">ca_housing</td>
</tr>
<tr class="odd">
<td id="T_973b0_level0_row26" class="row_heading level0 row26" data-quarto-table-cell-role="th">26</td>
<td id="T_973b0_row26_col0" class="data row26 col0">USI</td>
<td id="T_973b0_row26_col1" class="data row26 col1">6018</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading profile... Please Wait!</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1"></a>X_train_transformed <span class="op">=</span> get_config(<span class="st">"X_train_transformed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015128587,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a451a7f3-e910-4d58-f2c4-1bbf3efe053b">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1"></a>X_train_transformed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

  <div id="df-ae9b158d-cedb-40ec-bde7-243df561cc52">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR BAY</th>
<th data-quarto-table-cell-role="th">ocean_proximity_NEAR OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_&lt;1H OCEAN</th>
<th data-quarto-table-cell-role="th">ocean_proximity_INLAND</th>
<th data-quarto-table-cell-role="th">ocean_proximity_ISLAND</th>
<th data-quarto-table-cell-role="th">income_cat_2.0</th>
<th data-quarto-table-cell-role="th">income_cat_1.0</th>
<th data-quarto-table-cell-role="th">income_cat_3.0</th>
<th data-quarto-table-cell-role="th">income_cat_4.0</th>
<th data-quarto-table-cell-role="th">income_cat_5.0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1.364134</td>
<td>1.046776</td>
<td>1.859278</td>
<td>0.197765</td>
<td>0.481069</td>
<td>-0.119739</td>
<td>0.622318</td>
<td>-1.069305</td>
<td>2.901312</td>
<td>-0.374453</td>
<td>-0.909639</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>1.421609</td>
<td>-0.176182</td>
<td>-0.749410</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.702926</td>
<td>-0.861667</td>
<td>0.235242</td>
<td>-0.144908</td>
<td>0.641720</td>
<td>2.210955</td>
<td>0.728542</td>
<td>-0.811247</td>
<td>-0.344672</td>
<td>2.670564</td>
<td>-0.909639</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>1.421609</td>
<td>-0.176182</td>
<td>-0.749410</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.889063</td>
<td>0.379292</td>
<td>-0.576776</td>
<td>0.403949</td>
<td>0.519485</td>
<td>1.617214</td>
<td>0.614730</td>
<td>-0.619632</td>
<td>-0.344672</td>
<td>-0.374453</td>
<td>1.099337</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>1.421609</td>
<td>-0.176182</td>
<td>-0.749410</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>0.778736</td>
<td>-0.894571</td>
<td>-0.576776</td>
<td>4.699704</td>
<td>4.252885</td>
<td>4.036448</td>
<td>4.317402</td>
<td>0.354490</td>
<td>-0.344672</td>
<td>-0.374453</td>
<td>1.099337</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>-0.703428</td>
<td>-0.176182</td>
<td>1.334383</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>0.025697</td>
<td>-0.574930</td>
<td>-0.414373</td>
<td>0.763321</td>
<td>0.376296</td>
<td>0.597698</td>
<td>0.550237</td>
<td>0.781639</td>
<td>-0.344672</td>
<td>2.670564</td>
<td>-0.909639</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>-0.703428</td>
<td>-0.176182</td>
<td>-0.749410</td>
<td>2.176301</td>
<td>-0.342352</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14854</td>
<td>0.192478</td>
<td>-0.664242</td>
<td>0.072838</td>
<td>-0.925360</td>
<td>-0.898438</td>
<td>-0.733011</td>
<td>-0.861027</td>
<td>0.026329</td>
<td>-0.344672</td>
<td>2.670564</td>
<td>-0.909639</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>-0.703428</td>
<td>-0.176182</td>
<td>1.334383</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14855</td>
<td>1.344774</td>
<td>-1.308224</td>
<td>-0.901583</td>
<td>0.901261</td>
<td>0.868728</td>
<td>0.729207</td>
<td>0.975134</td>
<td>-0.624362</td>
<td>-0.344672</td>
<td>-0.374453</td>
<td>1.099337</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>1.421609</td>
<td>-0.176182</td>
<td>-0.749410</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14856</td>
<td>1.238642</td>
<td>-1.275320</td>
<td>-1.145189</td>
<td>-0.385215</td>
<td>-0.884468</td>
<td>-0.584575</td>
<td>-0.815502</td>
<td>2.130376</td>
<td>-0.344672</td>
<td>-0.374453</td>
<td>1.099337</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>-0.703428</td>
<td>-0.176182</td>
<td>-0.749410</td>
<td>-0.459495</td>
<td>2.920971</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14858</td>
<td>0.611955</td>
<td>-0.730051</td>
<td>1.534471</td>
<td>-1.074917</td>
<td>-0.814620</td>
<td>-1.132744</td>
<td>-0.849646</td>
<td>-0.115229</td>
<td>-0.344672</td>
<td>-0.374453</td>
<td>1.099337</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>-0.703428</td>
<td>-0.176182</td>
<td>1.334383</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14859</td>
<td>0.718087</td>
<td>-0.734750</td>
<td>0.803655</td>
<td>0.014086</td>
<td>-0.154552</td>
<td>-0.075468</td>
<td>-0.128839</td>
<td>-0.016915</td>
<td>-0.344672</td>
<td>-0.374453</td>
<td>1.099337</td>
<td>-0.682598</td>
<td>-0.014579</td>
<td>-0.703428</td>
<td>-0.176182</td>
<td>1.334383</td>
<td>-0.459495</td>
<td>-0.342352</td>
</tr>
</tbody>
</table>


<p>14117 rows × 18 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ae9b158d-cedb-40ec-bde7-243df561cc52')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ae9b158d-cedb-40ec-bde7-243df561cc52 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ae9b158d-cedb-40ec-bde7-243df561cc52');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p><a href="https://www.kaggle.com/code/uyeanil/titanic-custom-transformer-pipeline-pycaret">https://www.kaggle.com/code/uyeanil/titanic-custom-transformer-pipeline-pycaret</a> as AutoML</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1"></a><span class="co">"""</span></span>
<span id="cb183-2"><a href="#cb183-2"></a><span class="co">from sklearn.pipeline import Pipeline, make_pipeline</span></span>
<span id="cb183-3"><a href="#cb183-3"></a><span class="co">from sklearn.base import BaseEstimator, TransformerMixin</span></span>
<span id="cb183-4"><a href="#cb183-4"></a><span class="co">from sklearn.cluster import KMeans</span></span>
<span id="cb183-5"><a href="#cb183-5"></a><span class="co">from sklearn.preprocessing import FunctionTransformer</span></span>
<span id="cb183-6"><a href="#cb183-6"></a><span class="co">from sklearn.preprocessing import StandardScaler</span></span>
<span id="cb183-7"><a href="#cb183-7"></a><span class="co">from sklearn.compose import ColumnTransformer</span></span>
<span id="cb183-8"><a href="#cb183-8"></a><span class="co">from sklearn.metrics.pairwise import rbf_kernel</span></span>
<span id="cb183-9"><a href="#cb183-9"></a><span class="co">from sklearn.impute import SimpleImputer</span></span>
<span id="cb183-10"><a href="#cb183-10"></a></span>
<span id="cb183-11"><a href="#cb183-11"></a><span class="co">class ClusterSimilarity(BaseEstimator, TransformerMixin):</span></span>
<span id="cb183-12"><a href="#cb183-12"></a><span class="co">    def __init__(self, n_clusters=10, gamma=1.0, random_state=None):</span></span>
<span id="cb183-13"><a href="#cb183-13"></a><span class="co">        self.n_clusters = n_clusters</span></span>
<span id="cb183-14"><a href="#cb183-14"></a><span class="co">        self.gamma = gamma</span></span>
<span id="cb183-15"><a href="#cb183-15"></a><span class="co">        self.random_state = random_state</span></span>
<span id="cb183-16"><a href="#cb183-16"></a></span>
<span id="cb183-17"><a href="#cb183-17"></a><span class="co">    def fit(self, X, y=None, sample_weight=None):</span></span>
<span id="cb183-18"><a href="#cb183-18"></a><span class="co">        self.kmeans_ = KMeans(self.n_clusters, random_state=self.random_state)</span></span>
<span id="cb183-19"><a href="#cb183-19"></a><span class="co">        self.kmeans_.fit(X, sample_weight=sample_weight)</span></span>
<span id="cb183-20"><a href="#cb183-20"></a><span class="co">        return self  # always return self!</span></span>
<span id="cb183-21"><a href="#cb183-21"></a></span>
<span id="cb183-22"><a href="#cb183-22"></a><span class="co">    def transform(self, X):</span></span>
<span id="cb183-23"><a href="#cb183-23"></a><span class="co">        return rbf_kernel(X, self.kmeans_.cluster_centers_, gamma=self.gamma)</span></span>
<span id="cb183-24"><a href="#cb183-24"></a><span class="co">    </span></span>
<span id="cb183-25"><a href="#cb183-25"></a><span class="co">    def get_feature_names_out(self, names=None):</span></span>
<span id="cb183-26"><a href="#cb183-26"></a><span class="co">        return [f"Cluster {i} similarity" for i in range(self.n_clusters)]</span></span>
<span id="cb183-27"><a href="#cb183-27"></a><span class="co">        </span></span>
<span id="cb183-28"><a href="#cb183-28"></a><span class="co">def column_ratio(X):</span></span>
<span id="cb183-29"><a href="#cb183-29"></a><span class="co">    return X[:, [0]] / X[:, [1]]</span></span>
<span id="cb183-30"><a href="#cb183-30"></a></span>
<span id="cb183-31"><a href="#cb183-31"></a><span class="co">def ratio_name(function_transformer, feature_names_in):</span></span>
<span id="cb183-32"><a href="#cb183-32"></a><span class="co">    return ["ratio"]  # feature names out</span></span>
<span id="cb183-33"><a href="#cb183-33"></a></span>
<span id="cb183-34"><a href="#cb183-34"></a><span class="co">def ratio_pipeline():</span></span>
<span id="cb183-35"><a href="#cb183-35"></a><span class="co">    return make_pipeline(</span></span>
<span id="cb183-36"><a href="#cb183-36"></a><span class="co">        SimpleImputer(strategy="median"),</span></span>
<span id="cb183-37"><a href="#cb183-37"></a><span class="co">        FunctionTransformer(column_ratio, feature_names_out=ratio_name),</span></span>
<span id="cb183-38"><a href="#cb183-38"></a><span class="co">        StandardScaler())</span></span>
<span id="cb183-39"><a href="#cb183-39"></a></span>
<span id="cb183-40"><a href="#cb183-40"></a><span class="co">log_pipeline = make_pipeline(</span></span>
<span id="cb183-41"><a href="#cb183-41"></a><span class="co">    SimpleImputer(strategy="median"),</span></span>
<span id="cb183-42"><a href="#cb183-42"></a><span class="co">    FunctionTransformer(np.log, feature_names_out="one-to-one"),</span></span>
<span id="cb183-43"><a href="#cb183-43"></a><span class="co">    StandardScaler())</span></span>
<span id="cb183-44"><a href="#cb183-44"></a></span>
<span id="cb183-45"><a href="#cb183-45"></a><span class="co">cluster_simil = ClusterSimilarity(n_clusters=10, gamma=1., random_state=42)</span></span>
<span id="cb183-46"><a href="#cb183-46"></a><span class="co">cat_pipeline = Pipeline([</span></span>
<span id="cb183-47"><a href="#cb183-47"></a><span class="co">    ("impute", SimpleImputer(strategy="most_frequent")),</span></span>
<span id="cb183-48"><a href="#cb183-48"></a><span class="co">    ("encoder", OneHotEncoder(handle_unknown="ignore"))</span></span>
<span id="cb183-49"><a href="#cb183-49"></a><span class="co">    ])</span></span>
<span id="cb183-50"><a href="#cb183-50"></a><span class="co">default_num_pipeline = make_pipeline(StandardScaler())</span></span>
<span id="cb183-51"><a href="#cb183-51"></a></span>
<span id="cb183-52"><a href="#cb183-52"></a><span class="co">preprocessing = ColumnTransformer([</span></span>
<span id="cb183-53"><a href="#cb183-53"></a><span class="co">        ("bedrooms", ratio_pipeline(), ["total_bedrooms", "total_rooms"]),</span></span>
<span id="cb183-54"><a href="#cb183-54"></a><span class="co">        ("rooms_per_house", ratio_pipeline(), ["total_rooms", "households"]),</span></span>
<span id="cb183-55"><a href="#cb183-55"></a><span class="co">        ("people_per_house", ratio_pipeline(), ["population", "households"]),</span></span>
<span id="cb183-56"><a href="#cb183-56"></a><span class="co">        ("log", log_pipeline, ["total_bedrooms", "total_rooms", "population",</span></span>
<span id="cb183-57"><a href="#cb183-57"></a><span class="co">                               "households", "median_income"]),</span></span>
<span id="cb183-58"><a href="#cb183-58"></a><span class="co">        ("geo", cluster_simil, ["latitude", "longitude"]),</span></span>
<span id="cb183-59"><a href="#cb183-59"></a><span class="co">        ("cat", cat_pipeline, make_column_selector(dtype_include=object)),</span></span>
<span id="cb183-60"><a href="#cb183-60"></a><span class="co">    ],</span></span>
<span id="cb183-61"><a href="#cb183-61"></a><span class="co">    remainder=default_num_pipeline)  # one column remaining: housing_median_age</span></span>
<span id="cb183-62"><a href="#cb183-62"></a><span class="co">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="select-and-train-a-model-1" class="level3" data-number="2.8.4">
<h3 data-number="2.8.4" class="anchored" data-anchor-id="select-and-train-a-model-1"><span class="header-section-number">2.8.4</span> Select and train a model</h3>
<p>Comparing all models to evaluate performance is the recommended starting point for modeling once the setup is completed (unless you exactly know what kind of model you need, which is often not the case). This function trains all models in the model library and scores them using k-fold cross validation for metric evaluation. The output prints a score grid that shows average MAE, MSE, RMSE,R2, RMSLE and MAPE accross the folds (10 by default) along with training time.</p>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/train">https://pycaret.gitbook.io/docs/get-started/functions/train</a></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:140539,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015288528,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="428225c7-e050-4328-ad9b-a88d7dc37810">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1"></a>best_model <span class="op">=</span> compare_models(sort <span class="op">=</span> <span class="st">'RMSE'</span>, fold<span class="op">=</span><span class="dv">5</span>, verbose<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">


<table id="T_b9a93_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">MAPE</th>
<th class="col_heading level0 col7" data-quarto-table-cell-role="th">TT (Sec)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b9a93_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">catboost</td>
<td id="T_b9a93_row0_col0" class="data row0 col0">CatBoost Regressor</td>
<td id="T_b9a93_row0_col1" class="data row0 col1">30861.9104</td>
<td id="T_b9a93_row0_col2" class="data row0 col2">2181034968.8429</td>
<td id="T_b9a93_row0_col3" class="data row0 col3">46691.5909</td>
<td id="T_b9a93_row0_col4" class="data row0 col4">0.8358</td>
<td id="T_b9a93_row0_col5" class="data row0 col5">0.2308</td>
<td id="T_b9a93_row0_col6" class="data row0 col6">0.1717</td>
<td id="T_b9a93_row0_col7" class="data row0 col7">6.1980</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">lightgbm</td>
<td id="T_b9a93_row1_col0" class="data row1 col0">Light Gradient Boosting Machine</td>
<td id="T_b9a93_row1_col1" class="data row1 col1">32355.3704</td>
<td id="T_b9a93_row1_col2" class="data row1 col2">2354387054.3994</td>
<td id="T_b9a93_row1_col3" class="data row1 col3">48510.4899</td>
<td id="T_b9a93_row1_col4" class="data row1 col4">0.8227</td>
<td id="T_b9a93_row1_col5" class="data row1 col5">0.2380</td>
<td id="T_b9a93_row1_col6" class="data row1 col6">0.1806</td>
<td id="T_b9a93_row1_col7" class="data row1 col7">0.4200</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">rf</td>
<td id="T_b9a93_row2_col0" class="data row2 col0">Random Forest Regressor</td>
<td id="T_b9a93_row2_col1" class="data row2 col1">33150.0424</td>
<td id="T_b9a93_row2_col2" class="data row2 col2">2572097820.1463</td>
<td id="T_b9a93_row2_col3" class="data row2 col3">50704.3716</td>
<td id="T_b9a93_row2_col4" class="data row2 col4">0.8063</td>
<td id="T_b9a93_row2_col5" class="data row2 col5">0.2444</td>
<td id="T_b9a93_row2_col6" class="data row2 col6">0.1852</td>
<td id="T_b9a93_row2_col7" class="data row2 col7">6.1680</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">et</td>
<td id="T_b9a93_row3_col0" class="data row3 col0">Extra Trees Regressor</td>
<td id="T_b9a93_row3_col1" class="data row3 col1">37005.2973</td>
<td id="T_b9a93_row3_col2" class="data row3 col2">3043882815.8823</td>
<td id="T_b9a93_row3_col3" class="data row3 col3">55163.1011</td>
<td id="T_b9a93_row3_col4" class="data row3 col4">0.7707</td>
<td id="T_b9a93_row3_col5" class="data row3 col5">0.2641</td>
<td id="T_b9a93_row3_col6" class="data row3 col6">0.2075</td>
<td id="T_b9a93_row3_col7" class="data row3 col7">4.0100</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">gbr</td>
<td id="T_b9a93_row4_col0" class="data row4 col0">Gradient Boosting Regressor</td>
<td id="T_b9a93_row4_col1" class="data row4 col1">38408.0096</td>
<td id="T_b9a93_row4_col2" class="data row4 col2">3067882575.8698</td>
<td id="T_b9a93_row4_col3" class="data row4 col3">55381.6992</td>
<td id="T_b9a93_row4_col4" class="data row4 col4">0.7690</td>
<td id="T_b9a93_row4_col5" class="data row4 col5">0.2719</td>
<td id="T_b9a93_row4_col6" class="data row4 col6">0.2180</td>
<td id="T_b9a93_row4_col7" class="data row4 col7">2.3660</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">knn</td>
<td id="T_b9a93_row5_col0" class="data row5 col0">K Neighbors Regressor</td>
<td id="T_b9a93_row5_col1" class="data row5 col1">43466.1945</td>
<td id="T_b9a93_row5_col2" class="data row5 col2">4131793971.2000</td>
<td id="T_b9a93_row5_col3" class="data row5 col3">64271.9602</td>
<td id="T_b9a93_row5_col4" class="data row5 col4">0.6888</td>
<td id="T_b9a93_row5_col5" class="data row5 col5">0.3034</td>
<td id="T_b9a93_row5_col6" class="data row5 col6">0.2376</td>
<td id="T_b9a93_row5_col7" class="data row5 col7">0.2460</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">br</td>
<td id="T_b9a93_row6_col0" class="data row6 col0">Bayesian Ridge</td>
<td id="T_b9a93_row6_col1" class="data row6 col1">49242.1016</td>
<td id="T_b9a93_row6_col2" class="data row6 col2">4720977912.2509</td>
<td id="T_b9a93_row6_col3" class="data row6 col3">68696.1739</td>
<td id="T_b9a93_row6_col4" class="data row6 col4">0.6445</td>
<td id="T_b9a93_row6_col5" class="data row6 col5">0.3801</td>
<td id="T_b9a93_row6_col6" class="data row6 col6">0.2878</td>
<td id="T_b9a93_row6_col7" class="data row6 col7">0.2680</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">ridge</td>
<td id="T_b9a93_row7_col0" class="data row7 col0">Ridge Regression</td>
<td id="T_b9a93_row7_col1" class="data row7 col1">49252.5068</td>
<td id="T_b9a93_row7_col2" class="data row7 col2">4722997394.5170</td>
<td id="T_b9a93_row7_col3" class="data row7 col3">68710.6807</td>
<td id="T_b9a93_row7_col4" class="data row7 col4">0.6443</td>
<td id="T_b9a93_row7_col5" class="data row7 col5">0.3779</td>
<td id="T_b9a93_row7_col6" class="data row7 col6">0.2880</td>
<td id="T_b9a93_row7_col7" class="data row7 col7">0.1380</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">lasso</td>
<td id="T_b9a93_row8_col0" class="data row8 col0">Lasso Regression</td>
<td id="T_b9a93_row8_col1" class="data row8 col1">49254.5804</td>
<td id="T_b9a93_row8_col2" class="data row8 col2">4723361290.9467</td>
<td id="T_b9a93_row8_col3" class="data row8 col3">68713.2920</td>
<td id="T_b9a93_row8_col4" class="data row8 col4">0.6443</td>
<td id="T_b9a93_row8_col5" class="data row8 col5">0.3780</td>
<td id="T_b9a93_row8_col6" class="data row8 col6">0.2880</td>
<td id="T_b9a93_row8_col7" class="data row8 col7">0.1860</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">llar</td>
<td id="T_b9a93_row9_col0" class="data row9 col0">Lasso Least Angle Regression</td>
<td id="T_b9a93_row9_col1" class="data row9 col1">49254.4740</td>
<td id="T_b9a93_row9_col2" class="data row9 col2">4723363267.9404</td>
<td id="T_b9a93_row9_col3" class="data row9 col3">68713.3056</td>
<td id="T_b9a93_row9_col4" class="data row9 col4">0.6443</td>
<td id="T_b9a93_row9_col5" class="data row9 col5">0.3780</td>
<td id="T_b9a93_row9_col6" class="data row9 col6">0.2880</td>
<td id="T_b9a93_row9_col7" class="data row9 col7">0.2560</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">lar</td>
<td id="T_b9a93_row10_col0" class="data row10 col0">Least Angle Regression</td>
<td id="T_b9a93_row10_col1" class="data row10 col1">49255.2461</td>
<td id="T_b9a93_row10_col2" class="data row10 col2">4723522771.5529</td>
<td id="T_b9a93_row10_col3" class="data row10 col3">68714.4540</td>
<td id="T_b9a93_row10_col4" class="data row10 col4">0.6443</td>
<td id="T_b9a93_row10_col5" class="data row10 col5">0.3780</td>
<td id="T_b9a93_row10_col6" class="data row10 col6">0.2880</td>
<td id="T_b9a93_row10_col7" class="data row10 col7">0.2480</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">lr</td>
<td id="T_b9a93_row11_col0" class="data row11 col0">Linear Regression</td>
<td id="T_b9a93_row11_col1" class="data row11 col1">49255.2461</td>
<td id="T_b9a93_row11_col2" class="data row11 col2">4723522771.5529</td>
<td id="T_b9a93_row11_col3" class="data row11 col3">68714.4540</td>
<td id="T_b9a93_row11_col4" class="data row11 col4">0.6443</td>
<td id="T_b9a93_row11_col5" class="data row11 col5">0.3780</td>
<td id="T_b9a93_row11_col6" class="data row11 col6">0.2880</td>
<td id="T_b9a93_row11_col7" class="data row11 col7">1.3200</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row12" class="row_heading level0 row12" data-quarto-table-cell-role="th">huber</td>
<td id="T_b9a93_row12_col0" class="data row12 col0">Huber Regressor</td>
<td id="T_b9a93_row12_col1" class="data row12 col1">47867.1926</td>
<td id="T_b9a93_row12_col2" class="data row12 col2">4780685846.9827</td>
<td id="T_b9a93_row12_col3" class="data row12 col3">69135.6429</td>
<td id="T_b9a93_row12_col4" class="data row12 col4">0.6400</td>
<td id="T_b9a93_row12_col5" class="data row12 col5">0.3670</td>
<td id="T_b9a93_row12_col6" class="data row12 col6">0.2630</td>
<td id="T_b9a93_row12_col7" class="data row12 col7">0.3700</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row13" class="row_heading level0 row13" data-quarto-table-cell-role="th">par</td>
<td id="T_b9a93_row13_col0" class="data row13 col0">Passive Aggressive Regressor</td>
<td id="T_b9a93_row13_col1" class="data row13 col1">47814.5390</td>
<td id="T_b9a93_row13_col2" class="data row13 col2">4846281518.3859</td>
<td id="T_b9a93_row13_col3" class="data row13 col3">69609.0491</td>
<td id="T_b9a93_row13_col4" class="data row13 col4">0.6351</td>
<td id="T_b9a93_row13_col5" class="data row13 col5">0.3529</td>
<td id="T_b9a93_row13_col6" class="data row13 col6">0.2576</td>
<td id="T_b9a93_row13_col7" class="data row13 col7">0.9300</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row14" class="row_heading level0 row14" data-quarto-table-cell-role="th">dt</td>
<td id="T_b9a93_row14_col0" class="data row14 col0">Decision Tree Regressor</td>
<td id="T_b9a93_row14_col1" class="data row14 col1">44960.7247</td>
<td id="T_b9a93_row14_col2" class="data row14 col2">5036168100.5834</td>
<td id="T_b9a93_row14_col3" class="data row14 col3">70933.1545</td>
<td id="T_b9a93_row14_col4" class="data row14 col4">0.6209</td>
<td id="T_b9a93_row14_col5" class="data row14 col5">0.3270</td>
<td id="T_b9a93_row14_col6" class="data row14 col6">0.2450</td>
<td id="T_b9a93_row14_col7" class="data row14 col7">0.2160</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row15" class="row_heading level0 row15" data-quarto-table-cell-role="th">en</td>
<td id="T_b9a93_row15_col0" class="data row15 col0">Elastic Net</td>
<td id="T_b9a93_row15_col1" class="data row15 col1">53387.4699</td>
<td id="T_b9a93_row15_col2" class="data row15 col2">5226586829.8307</td>
<td id="T_b9a93_row15_col3" class="data row15 col3">72292.3985</td>
<td id="T_b9a93_row15_col4" class="data row15 col4">0.6065</td>
<td id="T_b9a93_row15_col5" class="data row15 col5">0.3573</td>
<td id="T_b9a93_row15_col6" class="data row15 col6">0.3180</td>
<td id="T_b9a93_row15_col7" class="data row15 col7">0.1400</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row16" class="row_heading level0 row16" data-quarto-table-cell-role="th">omp</td>
<td id="T_b9a93_row16_col0" class="data row16 col0">Orthogonal Matching Pursuit</td>
<td id="T_b9a93_row16_col1" class="data row16 col1">62099.6132</td>
<td id="T_b9a93_row16_col2" class="data row16 col2">6940291836.2596</td>
<td id="T_b9a93_row16_col3" class="data row16 col3">83299.1586</td>
<td id="T_b9a93_row16_col4" class="data row16 col4">0.4773</td>
<td id="T_b9a93_row16_col5" class="data row16 col5">0.4256</td>
<td id="T_b9a93_row16_col6" class="data row16 col6">0.3821</td>
<td id="T_b9a93_row16_col7" class="data row16 col7">0.2980</td>
</tr>
<tr class="even">
<td id="T_b9a93_level0_row17" class="row_heading level0 row17" data-quarto-table-cell-role="th">ada</td>
<td id="T_b9a93_row17_col0" class="data row17 col0">AdaBoost Regressor</td>
<td id="T_b9a93_row17_col1" class="data row17 col1">78936.3612</td>
<td id="T_b9a93_row17_col2" class="data row17 col2">8428966889.7267</td>
<td id="T_b9a93_row17_col3" class="data row17 col3">91785.6668</td>
<td id="T_b9a93_row17_col4" class="data row17 col4">0.3653</td>
<td id="T_b9a93_row17_col5" class="data row17 col5">0.4911</td>
<td id="T_b9a93_row17_col6" class="data row17 col6">0.5492</td>
<td id="T_b9a93_row17_col7" class="data row17 col7">1.2680</td>
</tr>
<tr class="odd">
<td id="T_b9a93_level0_row18" class="row_heading level0 row18" data-quarto-table-cell-role="th">dummy</td>
<td id="T_b9a93_row18_col0" class="data row18 col0">Dummy Regressor</td>
<td id="T_b9a93_row18_col1" class="data row18 col1">90681.3531</td>
<td id="T_b9a93_row18_col2" class="data row18 col2">13288744960.0000</td>
<td id="T_b9a93_row18_col3" class="data row18 col3">115272.3750</td>
<td id="T_b9a93_row18_col4" class="data row18 col4">-0.0002</td>
<td id="T_b9a93_row18_col5" class="data row18 col5">0.5881</td>
<td id="T_b9a93_row18_col6" class="data row18 col6">0.6153</td>
<td id="T_b9a93_row18_col7" class="data row18 col7">0.2420</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"58a7aeaa3c5a4fb7adaa7015a384f9b9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<p>The score grid printed above highlights the highest performing metric for comparison purposes only. By passing sort parameter, <code>compare_models(sort = 'RMSE')</code> will sort the grid by RMSE (lower to higher since lower is better). We also change the fold parameter from the default value of 10 to a different value by using <code>compare_models(fold = 5)</code> which will compare all models on 5 fold cross validation. Reducing the number of folds will improve the training time. By default, <code>compare_models</code> return the best performing model based on default sort order but can be used to return a list of top N models by using <code>n_select</code> parameter. Notice that you can also use exclude parameter to block certain models.</p>
<p>There are 25 regressors available in the model library of PyCaret. To see list of all regressors either check the docstring or use <code>models()</code> function to see the library.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:580,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015289105,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b3aa7ef4-d7af-41b4-90b3-4a27400d9d11">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1"></a>models()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

  <div id="df-f8cee315-3a35-467b-888b-3c08518254b2">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Reference</th>
<th data-quarto-table-cell-role="th">Turbo</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">lr</td>
<td>Linear Regression</td>
<td>sklearn.linear_model._base.LinearRegression</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">lasso</td>
<td>Lasso Regression</td>
<td>sklearn.linear_model._coordinate_descent.Lasso</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ridge</td>
<td>Ridge Regression</td>
<td>sklearn.linear_model._ridge.Ridge</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">en</td>
<td>Elastic Net</td>
<td>sklearn.linear_model._coordinate_descent.ElasticNet</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">lar</td>
<td>Least Angle Regression</td>
<td>sklearn.linear_model._least_angle.Lars</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">llar</td>
<td>Lasso Least Angle Regression</td>
<td>sklearn.linear_model._least_angle.LassoLars</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">omp</td>
<td>Orthogonal Matching Pursuit</td>
<td>sklearn.linear_model._omp.OrthogonalMatchingPursuit</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">br</td>
<td>Bayesian Ridge</td>
<td>sklearn.linear_model._bayes.BayesianRidge</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ard</td>
<td>Automatic Relevance Determination</td>
<td>sklearn.linear_model._bayes.ARDRegression</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">par</td>
<td>Passive Aggressive Regressor</td>
<td>sklearn.linear_model._passive_aggressive.PassiveAggressiveRegressor</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ransac</td>
<td>Random Sample Consensus</td>
<td>sklearn.linear_model._ransac.RANSACRegressor</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">tr</td>
<td>TheilSen Regressor</td>
<td>sklearn.linear_model._theil_sen.TheilSenRegressor</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">huber</td>
<td>Huber Regressor</td>
<td>sklearn.linear_model._huber.HuberRegressor</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">kr</td>
<td>Kernel Ridge</td>
<td>sklearn.kernel_ridge.KernelRidge</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">svm</td>
<td>Support Vector Regression</td>
<td>sklearn.svm._classes.SVR</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">knn</td>
<td>K Neighbors Regressor</td>
<td>sklearn.neighbors._regression.KNeighborsRegressor</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dt</td>
<td>Decision Tree Regressor</td>
<td>sklearn.tree._classes.DecisionTreeRegressor</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">rf</td>
<td>Random Forest Regressor</td>
<td>sklearn.ensemble._forest.RandomForestRegressor</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">et</td>
<td>Extra Trees Regressor</td>
<td>sklearn.ensemble._forest.ExtraTreesRegressor</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ada</td>
<td>AdaBoost Regressor</td>
<td>sklearn.ensemble._weight_boosting.AdaBoostRegressor</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">gbr</td>
<td>Gradient Boosting Regressor</td>
<td>sklearn.ensemble._gb.GradientBoostingRegressor</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mlp</td>
<td>MLP Regressor</td>
<td>sklearn.neural_network._multilayer_perceptron.MLPRegressor</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">xgboost</td>
<td>Extreme Gradient Boosting</td>
<td>xgboost.sklearn.XGBRegressor</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">lightgbm</td>
<td>Light Gradient Boosting Machine</td>
<td>lightgbm.sklearn.LGBMRegressor</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">catboost</td>
<td>CatBoost Regressor</td>
<td>catboost.core.CatBoostRegressor</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">dummy</td>
<td>Dummy Regressor</td>
<td>sklearn.dummy.DummyRegressor</td>
<td>True</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f8cee315-3a35-467b-888b-3c08518254b2')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f8cee315-3a35-467b-888b-3c08518254b2 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f8cee315-3a35-467b-888b-3c08518254b2');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p><code>create_model()</code> is the most granular function in PyCaret and is often the foundation behind most of the PyCaret functionalities. As the name suggests this function trains and evaluates a model using cross validation that can be set with fold parameter. The output prints a score grid that shows MAE, MSE, RMSE, R2, RMSLE and MAPE by fold.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:14304,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015303405,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b9b3da1b-b72c-4c5a-b0c2-84d21e4a8a8a">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1"></a>lightgbm <span class="op">=</span> create_model(<span class="st">'lightgbm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">


<table id="T_aa299_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">MAPE</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">Fold</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_aa299_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_aa299_row0_col0" class="data row0 col0">32167.4099</td>
<td id="T_aa299_row0_col1" class="data row0 col1">2367963276.0495</td>
<td id="T_aa299_row0_col2" class="data row0 col2">48661.7229</td>
<td id="T_aa299_row0_col3" class="data row0 col3">0.8085</td>
<td id="T_aa299_row0_col4" class="data row0 col4">0.2347</td>
<td id="T_aa299_row0_col5" class="data row0 col5">0.1779</td>
</tr>
<tr class="even">
<td id="T_aa299_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_aa299_row1_col0" class="data row1 col0">30984.6322</td>
<td id="T_aa299_row1_col1" class="data row1 col1">2126158343.9367</td>
<td id="T_aa299_row1_col2" class="data row1 col2">46110.2846</td>
<td id="T_aa299_row1_col3" class="data row1 col3">0.8432</td>
<td id="T_aa299_row1_col4" class="data row1 col4">0.2215</td>
<td id="T_aa299_row1_col5" class="data row1 col5">0.1683</td>
</tr>
<tr class="odd">
<td id="T_aa299_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_aa299_row2_col0" class="data row2 col0">32185.5007</td>
<td id="T_aa299_row2_col1" class="data row2 col1">2194345568.5475</td>
<td id="T_aa299_row2_col2" class="data row2 col2">46843.8424</td>
<td id="T_aa299_row2_col3" class="data row2 col3">0.8403</td>
<td id="T_aa299_row2_col4" class="data row2 col4">0.2336</td>
<td id="T_aa299_row2_col5" class="data row2 col5">0.1781</td>
</tr>
<tr class="even">
<td id="T_aa299_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_aa299_row3_col0" class="data row3 col0">32027.3585</td>
<td id="T_aa299_row3_col1" class="data row3 col1">2474181783.1165</td>
<td id="T_aa299_row3_col2" class="data row3 col2">49741.1478</td>
<td id="T_aa299_row3_col3" class="data row3 col3">0.8163</td>
<td id="T_aa299_row3_col4" class="data row3 col4">0.2314</td>
<td id="T_aa299_row3_col5" class="data row3 col5">0.1733</td>
</tr>
<tr class="odd">
<td id="T_aa299_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_aa299_row4_col0" class="data row4 col0">32129.8307</td>
<td id="T_aa299_row4_col1" class="data row4 col1">2404652199.2175</td>
<td id="T_aa299_row4_col2" class="data row4 col2">49037.2532</td>
<td id="T_aa299_row4_col3" class="data row4 col3">0.8279</td>
<td id="T_aa299_row4_col4" class="data row4 col4">0.2486</td>
<td id="T_aa299_row4_col5" class="data row4 col5">0.1844</td>
</tr>
<tr class="even">
<td id="T_aa299_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_aa299_row5_col0" class="data row5 col0">31591.5676</td>
<td id="T_aa299_row5_col1" class="data row5 col1">2244223522.5267</td>
<td id="T_aa299_row5_col2" class="data row5 col2">47373.2364</td>
<td id="T_aa299_row5_col3" class="data row5 col3">0.8248</td>
<td id="T_aa299_row5_col4" class="data row5 col4">0.2421</td>
<td id="T_aa299_row5_col5" class="data row5 col5">0.1823</td>
</tr>
<tr class="odd">
<td id="T_aa299_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_aa299_row6_col0" class="data row6 col0">32913.7391</td>
<td id="T_aa299_row6_col1" class="data row6 col1">2408284988.0534</td>
<td id="T_aa299_row6_col2" class="data row6 col2">49074.2803</td>
<td id="T_aa299_row6_col3" class="data row6 col3">0.8144</td>
<td id="T_aa299_row6_col4" class="data row6 col4">0.2315</td>
<td id="T_aa299_row6_col5" class="data row6 col5">0.1744</td>
</tr>
<tr class="even">
<td id="T_aa299_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_aa299_row7_col0" class="data row7 col0">33253.8539</td>
<td id="T_aa299_row7_col1" class="data row7 col1">2476742658.1617</td>
<td id="T_aa299_row7_col2" class="data row7 col2">49766.8831</td>
<td id="T_aa299_row7_col3" class="data row7 col3">0.8121</td>
<td id="T_aa299_row7_col4" class="data row7 col4">0.2603</td>
<td id="T_aa299_row7_col5" class="data row7 col5">0.2009</td>
</tr>
<tr class="odd">
<td id="T_aa299_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_aa299_row8_col0" class="data row8 col0">30294.3307</td>
<td id="T_aa299_row8_col1" class="data row8 col1">2075253002.2693</td>
<td id="T_aa299_row8_col2" class="data row8 col2">45554.9449</td>
<td id="T_aa299_row8_col3" class="data row8 col3">0.8428</td>
<td id="T_aa299_row8_col4" class="data row8 col4">0.2271</td>
<td id="T_aa299_row8_col5" class="data row8 col5">0.1742</td>
</tr>
<tr class="even">
<td id="T_aa299_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_aa299_row9_col0" class="data row9 col0">32522.3678</td>
<td id="T_aa299_row9_col1" class="data row9 col1">2296816948.4132</td>
<td id="T_aa299_row9_col2" class="data row9 col2">47925.1181</td>
<td id="T_aa299_row9_col3" class="data row9 col3">0.8304</td>
<td id="T_aa299_row9_col4" class="data row9 col4">0.2328</td>
<td id="T_aa299_row9_col5" class="data row9 col5">0.1789</td>
</tr>
<tr class="odd">
<td id="T_aa299_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">Mean</td>
<td id="T_aa299_row10_col0" class="data row10 col0">32007.0591</td>
<td id="T_aa299_row10_col1" class="data row10 col1">2306862229.0292</td>
<td id="T_aa299_row10_col2" class="data row10 col2">48008.8714</td>
<td id="T_aa299_row10_col3" class="data row10 col3">0.8261</td>
<td id="T_aa299_row10_col4" class="data row10 col4">0.2364</td>
<td id="T_aa299_row10_col5" class="data row10 col5">0.1793</td>
</tr>
<tr class="even">
<td id="T_aa299_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">Std</td>
<td id="T_aa299_row11_col0" class="data row11 col0">828.6481</td>
<td id="T_aa299_row11_col1" class="data row11 col1">135432354.9804</td>
<td id="T_aa299_row11_col2" class="data row11 col2">1417.9208</td>
<td id="T_aa299_row11_col3" class="data row11 col3">0.0124</td>
<td id="T_aa299_row11_col4" class="data row11 col4">0.0107</td>
<td id="T_aa299_row11_col5" class="data row11 col5">0.0084</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b62202d7ad6c4ec6a40be1a335c4bd47","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015303405,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a6ca4904-e61e-4fcb-8146-27e060a7717d">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1"></a>lightgbm.get_params()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>{'boosting_type': 'gbdt',
 'class_weight': None,
 'colsample_bytree': 1.0,
 'importance_type': 'split',
 'learning_rate': 0.1,
 'max_depth': -1,
 'min_child_samples': 20,
 'min_child_weight': 0.001,
 'min_split_gain': 0.0,
 'n_estimators': 100,
 'n_jobs': -1,
 'num_leaves': 31,
 'objective': None,
 'random_state': 42,
 'reg_alpha': 0.0,
 'reg_lambda': 0.0,
 'silent': 'warn',
 'subsample': 1.0,
 'subsample_for_bin': 200000,
 'subsample_freq': 0}</code></pre>
</div>
</div>
</section>
<section id="fine-tune-your-model-1" class="level3" data-number="2.8.5">
<h3 data-number="2.8.5" class="anchored" data-anchor-id="fine-tune-your-model-1"><span class="header-section-number">2.8.5</span> Fine-Tune your model</h3>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/optimize">https://pycaret.gitbook.io/docs/get-started/functions/optimize</a></p>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/others#automl">https://pycaret.gitbook.io/docs/get-started/functions/others#automl</a></p>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/optimize#ensemble_model">https://pycaret.gitbook.io/docs/get-started/functions/optimize#ensemble_model</a></p>
<p>When a model is created using the create_model function it uses the default hyperparameters to train the model. In order to tune hyperparameters, the tune_model function is used. This function automatically tunes the hyperparameters of a model using Random Grid Search on a pre-defined search space. The output prints a score grid that shows MAE, MSE, RMSE, R2, RMSLE and MAPE by fold. To use the custom search grid, you can pass <code>custom_grid</code> parameter in the tune_model function.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:148019,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015451420,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ccc357d4-2fe2-4b1c-da9c-c0f93f73d693">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1"></a><span class="co">#lgbm_params = {'num_leaves': np.arange(10,200,10),</span></span>
<span id="cb189-2"><a href="#cb189-2"></a><span class="co">#                        'max_depth': [int(x) for x in np.linspace(10, 110, num = 11)],</span></span>
<span id="cb189-3"><a href="#cb189-3"></a><span class="co">#                        'learning_rate': np.arange(0.1,1,0.1)</span></span>
<span id="cb189-4"><a href="#cb189-4"></a><span class="co">#                        }</span></span>
<span id="cb189-5"><a href="#cb189-5"></a>tuned_lightgbm <span class="op">=</span> tune_model(lightgbm, n_iter <span class="op">=</span> <span class="dv">20</span>, optimize <span class="op">=</span> <span class="st">'RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">


<table id="T_b8d98_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">MAPE</th>
</tr>
<tr class="odd">
<th class="index_name level0" data-quarto-table-cell-role="th">Fold</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col5" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_b8d98_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_b8d98_row0_col0" class="data row0 col0">32351.2276</td>
<td id="T_b8d98_row0_col1" class="data row0 col1">2387101345.3071</td>
<td id="T_b8d98_row0_col2" class="data row0 col2">48857.9712</td>
<td id="T_b8d98_row0_col3" class="data row0 col3">0.8069</td>
<td id="T_b8d98_row0_col4" class="data row0 col4">0.2367</td>
<td id="T_b8d98_row0_col5" class="data row0 col5">0.1792</td>
</tr>
<tr class="even">
<td id="T_b8d98_level0_row1" class="row_heading level0 row1" data-quarto-table-cell-role="th">1</td>
<td id="T_b8d98_row1_col0" class="data row1 col0">31455.2358</td>
<td id="T_b8d98_row1_col1" class="data row1 col1">2118511518.6187</td>
<td id="T_b8d98_row1_col2" class="data row1 col2">46027.2910</td>
<td id="T_b8d98_row1_col3" class="data row1 col3">0.8438</td>
<td id="T_b8d98_row1_col4" class="data row1 col4">0.2208</td>
<td id="T_b8d98_row1_col5" class="data row1 col5">0.1698</td>
</tr>
<tr class="odd">
<td id="T_b8d98_level0_row2" class="row_heading level0 row2" data-quarto-table-cell-role="th">2</td>
<td id="T_b8d98_row2_col0" class="data row2 col0">32328.5698</td>
<td id="T_b8d98_row2_col1" class="data row2 col1">2238357372.3281</td>
<td id="T_b8d98_row2_col2" class="data row2 col2">47311.2817</td>
<td id="T_b8d98_row2_col3" class="data row2 col3">0.8371</td>
<td id="T_b8d98_row2_col4" class="data row2 col4">0.2347</td>
<td id="T_b8d98_row2_col5" class="data row2 col5">0.1778</td>
</tr>
<tr class="even">
<td id="T_b8d98_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">3</td>
<td id="T_b8d98_row3_col0" class="data row3 col0">31700.3079</td>
<td id="T_b8d98_row3_col1" class="data row3 col1">2440822708.2834</td>
<td id="T_b8d98_row3_col2" class="data row3 col2">49404.6831</td>
<td id="T_b8d98_row3_col3" class="data row3 col3">0.8188</td>
<td id="T_b8d98_row3_col4" class="data row3 col4">0.2295</td>
<td id="T_b8d98_row3_col5" class="data row3 col5">0.1688</td>
</tr>
<tr class="odd">
<td id="T_b8d98_level0_row4" class="row_heading level0 row4" data-quarto-table-cell-role="th">4</td>
<td id="T_b8d98_row4_col0" class="data row4 col0">32539.5859</td>
<td id="T_b8d98_row4_col1" class="data row4 col1">2446707135.0858</td>
<td id="T_b8d98_row4_col2" class="data row4 col2">49464.2005</td>
<td id="T_b8d98_row4_col3" class="data row4 col3">0.8249</td>
<td id="T_b8d98_row4_col4" class="data row4 col4">0.2557</td>
<td id="T_b8d98_row4_col5" class="data row4 col5">0.1874</td>
</tr>
<tr class="even">
<td id="T_b8d98_level0_row5" class="row_heading level0 row5" data-quarto-table-cell-role="th">5</td>
<td id="T_b8d98_row5_col0" class="data row5 col0">31239.9483</td>
<td id="T_b8d98_row5_col1" class="data row5 col1">2198566379.3510</td>
<td id="T_b8d98_row5_col2" class="data row5 col2">46888.8727</td>
<td id="T_b8d98_row5_col3" class="data row5 col3">0.8284</td>
<td id="T_b8d98_row5_col4" class="data row5 col4">0.2394</td>
<td id="T_b8d98_row5_col5" class="data row5 col5">0.1791</td>
</tr>
<tr class="odd">
<td id="T_b8d98_level0_row6" class="row_heading level0 row6" data-quarto-table-cell-role="th">6</td>
<td id="T_b8d98_row6_col0" class="data row6 col0">32818.6665</td>
<td id="T_b8d98_row6_col1" class="data row6 col1">2397818205.7179</td>
<td id="T_b8d98_row6_col2" class="data row6 col2">48967.5219</td>
<td id="T_b8d98_row6_col3" class="data row6 col3">0.8152</td>
<td id="T_b8d98_row6_col4" class="data row6 col4">0.2312</td>
<td id="T_b8d98_row6_col5" class="data row6 col5">0.1741</td>
</tr>
<tr class="even">
<td id="T_b8d98_level0_row7" class="row_heading level0 row7" data-quarto-table-cell-role="th">7</td>
<td id="T_b8d98_row7_col0" class="data row7 col0">33076.8939</td>
<td id="T_b8d98_row7_col1" class="data row7 col1">2438819409.6154</td>
<td id="T_b8d98_row7_col2" class="data row7 col2">49384.4045</td>
<td id="T_b8d98_row7_col3" class="data row7 col3">0.8149</td>
<td id="T_b8d98_row7_col4" class="data row7 col4">0.2605</td>
<td id="T_b8d98_row7_col5" class="data row7 col5">0.1986</td>
</tr>
<tr class="odd">
<td id="T_b8d98_level0_row8" class="row_heading level0 row8" data-quarto-table-cell-role="th">8</td>
<td id="T_b8d98_row8_col0" class="data row8 col0">30685.3025</td>
<td id="T_b8d98_row8_col1" class="data row8 col1">2109069565.3140</td>
<td id="T_b8d98_row8_col2" class="data row8 col2">45924.6074</td>
<td id="T_b8d98_row8_col3" class="data row8 col3">0.8402</td>
<td id="T_b8d98_row8_col4" class="data row8 col4">0.2293</td>
<td id="T_b8d98_row8_col5" class="data row8 col5">0.1752</td>
</tr>
<tr class="even">
<td id="T_b8d98_level0_row9" class="row_heading level0 row9" data-quarto-table-cell-role="th">9</td>
<td id="T_b8d98_row9_col0" class="data row9 col0">32208.8041</td>
<td id="T_b8d98_row9_col1" class="data row9 col1">2309496367.8215</td>
<td id="T_b8d98_row9_col2" class="data row9 col2">48057.2197</td>
<td id="T_b8d98_row9_col3" class="data row9 col3">0.8295</td>
<td id="T_b8d98_row9_col4" class="data row9 col4">0.2362</td>
<td id="T_b8d98_row9_col5" class="data row9 col5">0.1793</td>
</tr>
<tr class="odd">
<td id="T_b8d98_level0_row10" class="row_heading level0 row10" data-quarto-table-cell-role="th">Mean</td>
<td id="T_b8d98_row10_col0" class="data row10 col0">32040.4542</td>
<td id="T_b8d98_row10_col1" class="data row10 col1">2308527000.7443</td>
<td id="T_b8d98_row10_col2" class="data row10 col2">48028.8054</td>
<td id="T_b8d98_row10_col3" class="data row10 col3">0.8260</td>
<td id="T_b8d98_row10_col4" class="data row10 col4">0.2374</td>
<td id="T_b8d98_row10_col5" class="data row10 col5">0.1789</td>
</tr>
<tr class="even">
<td id="T_b8d98_level0_row11" class="row_heading level0 row11" data-quarto-table-cell-role="th">Std</td>
<td id="T_b8d98_row11_col0" class="data row11 col0">712.2017</td>
<td id="T_b8d98_row11_col1" class="data row11 col1">126737551.3240</td>
<td id="T_b8d98_row11_col2" class="data row11 col2">1326.9723</td>
<td id="T_b8d98_row11_col3" class="data row11 col3">0.0115</td>
<td id="T_b8d98_row11_col4" class="data row11 col4">0.0115</td>
<td id="T_b8d98_row11_col5" class="data row11 col5">0.0083</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"562f65809c15436aa59a148f76c85563","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 10 folds for each of 20 candidates, totalling 200 fits</code></pre>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-stdout">
<pre><code>Original model was better than the tuned model, hence it will be returned. NOTE: The display metrics are for the tuned model (not the original one).</code></pre>
</div>
</div>
</section>
<section id="analyze-the-model" class="level3" data-number="2.8.6">
<h3 data-number="2.8.6" class="anchored" data-anchor-id="analyze-the-model"><span class="header-section-number">2.8.6</span> Analyze the model</h3>
<p>Before model finalization, the <code>plot_model()</code> function can be used to analyze the performance across different aspects such as Residuals Plot, Prediction Error, Feature Importance etc. This function takes a trained model object and returns a plot based on the test / hold-out set.</p>
<p>The <code>evaluate_model()</code> displays a user interface for analyzing the performance of a trained model. It calls the <code>plot_model()</code> function internally.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:620,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015452029,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="667c4cc0-1c09-4d45-b4b5-861f39f0da3e">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1"></a>evaluate_model(tuned_lightgbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b067d7ee2af74aef952d9f2cc39fff07","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/analyze">https://pycaret.gitbook.io/docs/get-started/functions/analyze</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1"></a><span class="co">#plot_model(tuned_lightgbm)</span></span>
<span id="cb193-2"><a href="#cb193-2"></a><span class="co">#plot_model(tuned_lightgbm, plot = 'error')</span></span>
<span id="cb193-3"><a href="#cb193-3"></a><span class="co">#plot_model(tuned_lightgbm, plot = 'feature')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>interpret_model()</code> analyzes the predictions generated from a trained model. Most plots in this function are implemented based on the SHAP (Shapley Additive exPlanations)</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:7662,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015459690,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e90fb322-adcd-40bc-a3be-28ba5664405d">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1"></a>interpret_model(tuned_lightgbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="01_end_to_end_machine_learning_project_files/figure-html/cell-128-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="predict-on-test-set" class="level3" data-number="2.8.7">
<h3 data-number="2.8.7" class="anchored" data-anchor-id="predict-on-test-set"><span class="header-section-number">2.8.7</span> Predict on test set</h3>
<p>Before finalizing the model, it is advisable to perform one final check by predicting the test/hold-out set and reviewing the evaluation metrics.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:792,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015460479,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="69b4b8fd-d540-4e0f-b602-a632c1a9fadb">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1"></a>predict_model(tuned_lightgbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<table id="T_28dc3_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_28dc3_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_28dc3_row0_col0" class="data row0 col0">Light Gradient Boosting Machine</td>
<td id="T_28dc3_row0_col1" class="data row0 col1">32502.7734</td>
<td id="T_28dc3_row0_col2" class="data row0 col2">2287056237.8276</td>
<td id="T_28dc3_row0_col3" class="data row0 col3">47823.1768</td>
<td id="T_28dc3_row0_col4" class="data row0 col4">0.8326</td>
<td id="T_28dc3_row0_col5" class="data row0 col5">0.2390</td>
<td id="T_28dc3_row0_col6" class="data row0 col6">0.1826</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">

  <div id="df-aed70ce0-a2a6-493e-93de-496b81c673e4">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
<th data-quarto-table-cell-role="th">income_cat</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
<th data-quarto-table-cell-role="th">prediction_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14860</td>
<td>-117.650002</td>
<td>34.020000</td>
<td>9.0</td>
<td>2107.0</td>
<td>411.0</td>
<td>1138.0</td>
<td>389.0</td>
<td>4.4042</td>
<td>INLAND</td>
<td>3</td>
<td>159100.0</td>
<td>166584.740965</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14861</td>
<td>-117.680000</td>
<td>34.150002</td>
<td>4.0</td>
<td>4082.0</td>
<td>578.0</td>
<td>1996.0</td>
<td>580.0</td>
<td>6.7813</td>
<td>INLAND</td>
<td>5</td>
<td>286300.0</td>
<td>263679.509928</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14862</td>
<td>-118.290001</td>
<td>34.080002</td>
<td>23.0</td>
<td>1864.0</td>
<td>937.0</td>
<td>2795.0</td>
<td>858.0</td>
<td>1.8495</td>
<td>&lt;1H OCEAN</td>
<td>2</td>
<td>212500.0</td>
<td>212056.088491</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14863</td>
<td>-117.970001</td>
<td>33.990002</td>
<td>23.0</td>
<td>3335.0</td>
<td>570.0</td>
<td>1560.0</td>
<td>555.0</td>
<td>5.7268</td>
<td>&lt;1H OCEAN</td>
<td>4</td>
<td>300300.0</td>
<td>271747.627121</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14864</td>
<td>-117.320000</td>
<td>34.099998</td>
<td>42.0</td>
<td>801.0</td>
<td>176.0</td>
<td>711.0</td>
<td>183.0</td>
<td>1.8681</td>
<td>INLAND</td>
<td>2</td>
<td>59700.0</td>
<td>65521.582721</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18571</td>
<td>-121.000000</td>
<td>37.259998</td>
<td>45.0</td>
<td>1750.0</td>
<td>371.0</td>
<td>847.0</td>
<td>354.0</td>
<td>1.7062</td>
<td>INLAND</td>
<td>2</td>
<td>77400.0</td>
<td>89862.446840</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18572</td>
<td>-122.169998</td>
<td>37.720001</td>
<td>43.0</td>
<td>3783.0</td>
<td>814.0</td>
<td>2139.0</td>
<td>789.0</td>
<td>4.0202</td>
<td>NEAR BAY</td>
<td>3</td>
<td>166300.0</td>
<td>196701.827793</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18573</td>
<td>-117.120003</td>
<td>32.580002</td>
<td>34.0</td>
<td>2003.0</td>
<td>466.0</td>
<td>1226.0</td>
<td>443.0</td>
<td>3.0613</td>
<td>NEAR OCEAN</td>
<td>3</td>
<td>136700.0</td>
<td>135883.426084</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18574</td>
<td>-122.040001</td>
<td>38.250000</td>
<td>52.0</td>
<td>582.0</td>
<td>131.0</td>
<td>241.0</td>
<td>106.0</td>
<td>2.4000</td>
<td>INLAND</td>
<td>2</td>
<td>125000.0</td>
<td>130034.478754</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18575</td>
<td>-120.849998</td>
<td>37.490002</td>
<td>42.0</td>
<td>264.0</td>
<td>72.0</td>
<td>310.0</td>
<td>70.0</td>
<td>1.4063</td>
<td>INLAND</td>
<td>1</td>
<td>61500.0</td>
<td>95609.262658</td>
</tr>
</tbody>
</table>


<p>3716 rows × 12 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aed70ce0-a2a6-493e-93de-496b81c673e4')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-aed70ce0-a2a6-493e-93de-496b81c673e4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-aed70ce0-a2a6-493e-93de-496b81c673e4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
</section>
<section id="finalize-model" class="level3" data-number="2.8.8">
<h3 data-number="2.8.8" class="anchored" data-anchor-id="finalize-model"><span class="header-section-number">2.8.8</span> Finalize model</h3>
<p>Model finalization is the last step in the experiment. A normal machine learning workflow in PyCaret starts with <code>setup()</code>, followed by comparing all models using <code>compare_models()</code> and shortlisting a few candidate models (based on the metric of interest) to perform several modeling techniques such as hyperparameter tuning, ensembling, stacking etc. This workflow will eventually lead you to the best model for use in making predictions on new and unseen data. The <code>finalize_model()</code> function fits the model onto the complete dataset including the test/hold-out sample (20% in this case). The purpose of this function is to train the model on the complete dataset before it is deployed in production.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1"></a>final_lightgbm <span class="op">=</span> finalize_model(tuned_lightgbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:503,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015466417,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f840d97b-1d89-4aeb-e6e2-8969c4daec87">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1"></a>predict_model(final_lightgbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<table id="T_57ae2_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_57ae2_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_57ae2_row0_col0" class="data row0 col0">Light Gradient Boosting Machine</td>
<td id="T_57ae2_row0_col1" class="data row0 col1">29413.3892</td>
<td id="T_57ae2_row0_col2" class="data row0 col2">1872817647.7416</td>
<td id="T_57ae2_row0_col3" class="data row0 col3">43276.0632</td>
<td id="T_57ae2_row0_col4" class="data row0 col4">0.8629</td>
<td id="T_57ae2_row0_col5" class="data row0 col5">0.2199</td>
<td id="T_57ae2_row0_col6" class="data row0 col6">0.1665</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">

  <div id="df-cb931a1a-5b79-4361-9596-7519155023a8">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
<th data-quarto-table-cell-role="th">income_cat</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
<th data-quarto-table-cell-role="th">prediction_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14860</td>
<td>-117.650002</td>
<td>34.020000</td>
<td>9.0</td>
<td>2107.0</td>
<td>411.0</td>
<td>1138.0</td>
<td>389.0</td>
<td>4.4042</td>
<td>INLAND</td>
<td>3</td>
<td>159100.0</td>
<td>162164.238793</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14861</td>
<td>-117.680000</td>
<td>34.150002</td>
<td>4.0</td>
<td>4082.0</td>
<td>578.0</td>
<td>1996.0</td>
<td>580.0</td>
<td>6.7813</td>
<td>INLAND</td>
<td>5</td>
<td>286300.0</td>
<td>273877.534930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14862</td>
<td>-118.290001</td>
<td>34.080002</td>
<td>23.0</td>
<td>1864.0</td>
<td>937.0</td>
<td>2795.0</td>
<td>858.0</td>
<td>1.8495</td>
<td>&lt;1H OCEAN</td>
<td>2</td>
<td>212500.0</td>
<td>209148.262865</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14863</td>
<td>-117.970001</td>
<td>33.990002</td>
<td>23.0</td>
<td>3335.0</td>
<td>570.0</td>
<td>1560.0</td>
<td>555.0</td>
<td>5.7268</td>
<td>&lt;1H OCEAN</td>
<td>4</td>
<td>300300.0</td>
<td>277503.747233</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14864</td>
<td>-117.320000</td>
<td>34.099998</td>
<td>42.0</td>
<td>801.0</td>
<td>176.0</td>
<td>711.0</td>
<td>183.0</td>
<td>1.8681</td>
<td>INLAND</td>
<td>2</td>
<td>59700.0</td>
<td>63081.895276</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18571</td>
<td>-121.000000</td>
<td>37.259998</td>
<td>45.0</td>
<td>1750.0</td>
<td>371.0</td>
<td>847.0</td>
<td>354.0</td>
<td>1.7062</td>
<td>INLAND</td>
<td>2</td>
<td>77400.0</td>
<td>93080.033327</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18572</td>
<td>-122.169998</td>
<td>37.720001</td>
<td>43.0</td>
<td>3783.0</td>
<td>814.0</td>
<td>2139.0</td>
<td>789.0</td>
<td>4.0202</td>
<td>NEAR BAY</td>
<td>3</td>
<td>166300.0</td>
<td>193502.069024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18573</td>
<td>-117.120003</td>
<td>32.580002</td>
<td>34.0</td>
<td>2003.0</td>
<td>466.0</td>
<td>1226.0</td>
<td>443.0</td>
<td>3.0613</td>
<td>NEAR OCEAN</td>
<td>3</td>
<td>136700.0</td>
<td>130554.077380</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18574</td>
<td>-122.040001</td>
<td>38.250000</td>
<td>52.0</td>
<td>582.0</td>
<td>131.0</td>
<td>241.0</td>
<td>106.0</td>
<td>2.4000</td>
<td>INLAND</td>
<td>2</td>
<td>125000.0</td>
<td>111131.581617</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18575</td>
<td>-120.849998</td>
<td>37.490002</td>
<td>42.0</td>
<td>264.0</td>
<td>72.0</td>
<td>310.0</td>
<td>70.0</td>
<td>1.4063</td>
<td>INLAND</td>
<td>1</td>
<td>61500.0</td>
<td>90052.157496</td>
</tr>
</tbody>
</table>


<p>3716 rows × 12 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cb931a1a-5b79-4361-9596-7519155023a8')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cb931a1a-5b79-4361-9596-7519155023a8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cb931a1a-5b79-4361-9596-7519155023a8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<p>The <code>predict_model()</code> function is also used to predict on the unseen dataset. <code>data_unseen</code> is the variable created at the beginning of the tutorial and contains 10% of the original dataset which was never exposed to PyCaret</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:758,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676015467173,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b8d05a6b-c61c-4f98-c1b9-65f700f25a8b">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1"></a>data_unseen[<span class="st">"income_cat"</span>] <span class="op">=</span> pd.cut(data_unseen[<span class="st">"median_income"</span>],</span>
<span id="cb198-2"><a href="#cb198-2"></a>                               bins<span class="op">=</span>[<span class="fl">0.</span>, <span class="fl">1.5</span>, <span class="fl">3.0</span>, <span class="fl">4.5</span>, <span class="fl">6.</span>, np.inf],</span>
<span id="cb198-3"><a href="#cb198-3"></a>                               labels<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb198-4"><a href="#cb198-4"></a>unseen_predictions <span class="op">=</span> predict_model(final_lightgbm, data<span class="op">=</span>data_unseen)</span>
<span id="cb198-5"><a href="#cb198-5"></a>unseen_predictions.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<table id="T_78753_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_78753_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_78753_row0_col0" class="data row0 col0">Light Gradient Boosting Machine</td>
<td id="T_78753_row0_col1" class="data row0 col1">32474.6118</td>
<td id="T_78753_row0_col2" class="data row0 col2">2364513076.8764</td>
<td id="T_78753_row0_col3" class="data row0 col3">48626.2591</td>
<td id="T_78753_row0_col4" class="data row0 col4">0.8164</td>
<td id="T_78753_row0_col5" class="data row0 col5">0.2404</td>
<td id="T_78753_row0_col6" class="data row0 col6">0.1824</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display" data-execution_count="23">

  <div id="df-29622926-70cc-4c25-bbf8-b11cda56b154">
    <div class="colab-df-container">
      <div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">housing_median_age</th>
<th data-quarto-table-cell-role="th">total_rooms</th>
<th data-quarto-table-cell-role="th">total_bedrooms</th>
<th data-quarto-table-cell-role="th">population</th>
<th data-quarto-table-cell-role="th">households</th>
<th data-quarto-table-cell-role="th">median_income</th>
<th data-quarto-table-cell-role="th">ocean_proximity</th>
<th data-quarto-table-cell-role="th">income_cat</th>
<th data-quarto-table-cell-role="th">median_house_value</th>
<th data-quarto-table-cell-role="th">prediction_label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-122.379997</td>
<td>40.669998</td>
<td>10.0</td>
<td>2281.0</td>
<td>444.0</td>
<td>1274.0</td>
<td>438.0</td>
<td>2.2120</td>
<td>INLAND</td>
<td>2</td>
<td>65600.0</td>
<td>68770.661309</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-118.370003</td>
<td>33.830002</td>
<td>35.0</td>
<td>1207.0</td>
<td>207.0</td>
<td>601.0</td>
<td>213.0</td>
<td>4.7308</td>
<td>&lt;1H OCEAN</td>
<td>4</td>
<td>353400.0</td>
<td>316812.741266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-117.239998</td>
<td>32.720001</td>
<td>39.0</td>
<td>3089.0</td>
<td>431.0</td>
<td>1175.0</td>
<td>432.0</td>
<td>7.5925</td>
<td>NEAR OCEAN</td>
<td>5</td>
<td>466700.0</td>
<td>442420.543218</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-118.440002</td>
<td>34.049999</td>
<td>18.0</td>
<td>4780.0</td>
<td>1192.0</td>
<td>1886.0</td>
<td>1036.0</td>
<td>4.4674</td>
<td>&lt;1H OCEAN</td>
<td>3</td>
<td>500001.0</td>
<td>431798.750579</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-118.440002</td>
<td>34.180000</td>
<td>33.0</td>
<td>2127.0</td>
<td>414.0</td>
<td>1056.0</td>
<td>391.0</td>
<td>4.3750</td>
<td>&lt;1H OCEAN</td>
<td>3</td>
<td>286100.0</td>
<td>262450.257792</td>
</tr>
</tbody>
</table>


</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-29622926-70cc-4c25-bbf8-b11cda56b154')" title="Convert this dataframe to an interactive table." style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"></path>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-29622926-70cc-4c25-bbf8-b11cda56b154 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-29622926-70cc-4c25-bbf8-b11cda56b154');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:372,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676016447784,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f5df26d4-e9d9-4db3-fc6d-4bec1690409b">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1"></a><span class="im">from</span> pycaret.utils.generic <span class="im">import</span> check_metric</span>
<span id="cb199-2"><a href="#cb199-2"></a>check_metric(unseen_predictions.median_house_value, unseen_predictions.prediction_label, <span class="st">'RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>48626.2591</code></pre>
</div>
</div>
</section>
<section id="save-and-load-the-model" class="level3" data-number="2.8.9">
<h3 data-number="2.8.9" class="anchored" data-anchor-id="save-and-load-the-model"><span class="header-section-number">2.8.9</span> Save and load the model</h3>
<p>We have now finished the experiment by finalizing the <code>tuned_lightgbm</code> model which is now stored in <code>final_lightgbm</code> variable. We have also used the model stored in <code>final_lightgbm</code> to predict <code>data_unseen</code>. This brings us to the end of our experiment, but one question is still to be asked: What happens when you have more new data to predict? Do you have to go through the entire experiment again? The answer is no, PyCaret’s inbuilt function <code>save_model()</code> allows you to save the model along with entire transformation pipeline for later use.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:736,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676016453086,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="dfebac35-89eb-4754-8005-ce68f5802d8c">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1"></a>save_model(final_lightgbm,<span class="st">'Final LightGBM Model 02Feb2022'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Transformation Pipeline and Model Successfully Saved</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(Pipeline(memory=FastMemory(location=/tmp/joblib),
          steps=[('numerical_imputer',
                  TransformerWrapper(include=['longitude', 'latitude',
                                              'housing_median_age',
                                              'total_rooms', 'total_bedrooms',
                                              'population', 'households',
                                              'median_income'],
                                     transformer=SimpleImputer(strategy='median'))),
                 ('categorical_imputer',
                  TransformerWrapper(include=['ocean_proximity', 'income_cat...
                  TransformerWrapper(include=['ocean_proximity', 'income_cat'],
                                     transformer=OneHotEncoder(cols=['ocean_proximity',
                                                                     'income_cat'],
                                                               handle_missing='return_nan',
                                                               use_cat_names=True))),
                 ('remove_outliers',
                  TransformerWrapper(transformer=RemoveOutliers())),
                 ('normalize', TransformerWrapper(transformer=StandardScaler())),
                 ('actual_estimator', LGBMRegressor(random_state=42))]),
 'Final LightGBM Model 02Feb2022.pkl')</code></pre>
</div>
</div>
<p>To load a saved model at a future date in the same or an alternative environment, we would use PyCaret’s <code>load_model()</code> function and then easily apply the saved model on new unseen data for prediction.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676016455382,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="329f1d26-3579-4495-f5e9-844c17db0100">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1"></a>saved_final_lightgbm <span class="op">=</span> load_model(<span class="st">'Final LightGBM Model 02Feb2022'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Transformation Pipeline and Model Successfully Loaded</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1013,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676016458098,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="da4bfd59-0400-4c14-abf4-695544a5a375">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1"></a>new_prediction <span class="op">=</span> predict_model(saved_final_lightgbm, data<span class="op">=</span>data_unseen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


<table id="T_154ea_" class="dataframe table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank level0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="col_heading level0 col0" data-quarto-table-cell-role="th">Model</th>
<th class="col_heading level0 col1" data-quarto-table-cell-role="th">MAE</th>
<th class="col_heading level0 col2" data-quarto-table-cell-role="th">MSE</th>
<th class="col_heading level0 col3" data-quarto-table-cell-role="th">RMSE</th>
<th class="col_heading level0 col4" data-quarto-table-cell-role="th">R2</th>
<th class="col_heading level0 col5" data-quarto-table-cell-role="th">RMSLE</th>
<th class="col_heading level0 col6" data-quarto-table-cell-role="th">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_154ea_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">0</td>
<td id="T_154ea_row0_col0" class="data row0 col0">Light Gradient Boosting Machine</td>
<td id="T_154ea_row0_col1" class="data row0 col1">32474.6118</td>
<td id="T_154ea_row0_col2" class="data row0 col2">2364513076.8764</td>
<td id="T_154ea_row0_col3" class="data row0 col3">48626.2591</td>
<td id="T_154ea_row0_col4" class="data row0 col4">0.8164</td>
<td id="T_154ea_row0_col5" class="data row0 col5">0.2404</td>
<td id="T_154ea_row0_col6" class="data row0 col6">0.1824</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:290,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676016463562,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9dc6218b-0a17-47c2-f99a-b483d5c37d52">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1"></a><span class="im">from</span> pycaret.utils.generic <span class="im">import</span> check_metric</span>
<span id="cb207-2"><a href="#cb207-2"></a>check_metric(new_prediction.median_house_value, new_prediction.prediction_label, <span class="st">'RMSE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>48626.2591</code></pre>
</div>
</div>
</section>
<section id="deplpy" class="level3" data-number="2.8.10">
<h3 data-number="2.8.10" class="anchored" data-anchor-id="deplpy"><span class="header-section-number">2.8.10</span> Deplpy</h3>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/deploy">https://pycaret.gitbook.io/docs/get-started/functions/deploy</a></p>
<p><a href="https://pycaret.gitbook.io/docs/get-started/functions/others#get_config">https://pycaret.gitbook.io/docs/get-started/functions/others#get_config</a></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1282,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1676016468919,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="fdf51e35-fa10-4df5-9f93-10b1e4ee876e">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1"></a>create_app(final_lightgbm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Colab notebook detected. To show errors in colab notebook, set debug=True in launch()
Note: opening Chrome Inspector may crash demo inside Colab notebooks.

To create a public link, set `share=True` in `launch()`.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
(async (port, path, width, height, cache, element) => {
                        if (!google.colab.kernel.accessAllowed && !cache) {
                            return;
                        }
                        element.appendChild(document.createTextNode(''));
                        const url = await google.colab.kernel.proxyPort(port, {cache});

                        const external_link = document.createElement('div');
                        external_link.innerHTML = `
                            <div style="font-family: monospace; margin-bottom: 0.5rem">
                                Running on <a href=${new URL(path, url).toString()} target="_blank">
                                    https://localhost:${port}${path}
                                </a>
                            </div>
                        `;
                        element.appendChild(external_link);

                        const iframe = document.createElement('iframe');
                        iframe.src = new URL(path, url).toString();
                        iframe.height = height;
                        iframe.allow = "autoplay; camera; microphone; clipboard-read; clipboard-write;"
                        iframe.width = width;
                        iframe.style.border = 0;
                        element.appendChild(iframe);
                    })(7860, "/", "100%", 500, false, window.element)
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code></code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1"></a><span class="co"># deploy a model</span></span>
<span id="cb212-2"><a href="#cb212-2"></a><span class="co"># deploy_model(final_lightgbm, model_name = 'final_lightgbm', platform = 'gcp', authentication = {'project': 'gcp-project-name', 'bucket' : 'gcp-bucket-name'})</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="reference" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="reference"><span class="header-section-number">2.9</span> Reference</h2>
<ol type="1">
<li><a href="https://github.com/ageron/handson-ml3/blob/main/02_end_to_end_machine_learning_project.ipynb">https://github.com/ageron/handson-ml3/blob/main/02_end_to_end_machine_learning_project.ipynb</a></li>
<li><a href="https://pycaret.org/">https://pycaret.org/</a></li>
<li><a href="https://pycaret.readthedocs.io/en/latest/">https://pycaret.readthedocs.io/en/latest/</a></li>
</ol>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"00e1c38563af40fd8a8bf8e96a0ee495":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"021af6130da54259b99c68a78e82b1e3":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a3f4f709bd5f4b149528b57eadc1a9f6","IPY_MODEL_b9e15d80f7454bcea63638f2dbb86522","IPY_MODEL_d115d029c1ff4b60952793aaecee6ef9"],"layout":"IPY_MODEL_b100b1c655e14f4e8b0a9776fa59d641"}},"03796dfd69c64bcf8bfd2afef80d738a":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"048f9ab8749d407ab35535f9137d642b":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"051bc0777f354044b5662a45c42b8451":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ca50041604049169bb7052b72232893":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0d465b565e6143febfb9e6c7412d9a52":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0d4fabebbcd94f988aafee660a288e15":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0de90c403fec46968d055eb8e24919a7":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ef41e50611f4c088db52e7dbabc5ed1":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"14eb6247b81e42efa9bb3b1a1f27e372":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18f5fa7b54764d4d9cba72dab7cbf0a7":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"27da98fd5c9a4a999288beb130f941c5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"29ee784ea8854dd5b0f7c7e92a24d356":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_58d6cee376cb44039cef04a488fd926f","placeholder":"​","style":"IPY_MODEL_18f5fa7b54764d4d9cba72dab7cbf0a7","value":" 1/1 [00:13&lt;00:00, 13.55s/it]"}},"2bf5b43748934f03ad5972d06c828549":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"31eccb4352b749cda60356d378ad6e00":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"37ac5bd8921542e3b0cb05c59d0a1ee6":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"40555baf9d274c5d85fb1a596054a317":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"42dc8c4f1e134aa3913504f1feb7aae5":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"49a7ec529c5e4029a4c49fd9289b93ae":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ToggleButtonsStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ToggleButtonsStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","button_width":"","description_width":"","font_weight":""}},"4bf0fb430c074354859026b1a843dba5":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"51e725a9eaa044acb6f67901265f0115":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"562f65809c15436aa59a148f76c85563":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e707b97882914019ac28b5759fd9067f","IPY_MODEL_f7937d635c424375af4bff24d1873219","IPY_MODEL_ed7f36132b2d4746876e98c16a15d2d7"],"layout":"IPY_MODEL_03796dfd69c64bcf8bfd2afef80d738a"}},"58052888702e4f07a0d864395a3798c0":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"588166b0badd4b379b9cf98dc31c5305":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"58a7aeaa3c5a4fb7adaa7015a384f9b9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a5901a8ad63a4bcba8e5d786b07aac63","IPY_MODEL_5efc17d6b6af42e89323aa524aca0da7","IPY_MODEL_d1dcd5b171644e279f3b57c4baf26465"],"layout":"IPY_MODEL_42dc8c4f1e134aa3913504f1feb7aae5"}},"58d6cee376cb44039cef04a488fd926f":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5da7ee2242ea4b5a8799624ce604f508":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5e970f1aac7f48c58dc1b0bb49df27c0":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5eba24e3e92043109155bc74dd1a7be6":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5efc17d6b6af42e89323aa524aca0da7":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_b4a4717dd371416db6e1c0952413d742","max":85,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0ef41e50611f4c088db52e7dbabc5ed1","value":85}},"66b78a988bdc4da5ba1697c6cbba04b8":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_d1c86856efe347b58c9c34fb395545ed","max":4,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8686859a96a74e52bfaa2ff5098a9334","value":4}},"6c772fe15a2a48b79076237ad91cb84e":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6d647af309434310a6b730330f6d8598":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6f4d02335b9b412880b588f6840ad858":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7eb496af18694adc96616f389e02e99c":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ff90e4141a9f44f298bc6f290062b1dc","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0ca50041604049169bb7052b72232893","value":1}},"84fb6f793bce49ad974de2e949106301":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8686859a96a74e52bfaa2ff5098a9334":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"881ff1508b804705a9db18bf8ae24cf8":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_964f2f77ab9a4383bacedc9eed214dda","IPY_MODEL_ac41f509529c4a468928f8ceb3445abb","IPY_MODEL_e10d3cb0c3644b2f857b9af1b163b253"],"layout":"IPY_MODEL_5eba24e3e92043109155bc74dd1a7be6"}},"882a300c6f2d4ff7a99b6944bf01fc65":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8eb671cd4950404a997975b8248be406":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"92111d1a2fdf4e778bb1b554ec519c62":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_92fc7000f3b3490db1fe32fbcfee44b8","placeholder":"​","style":"IPY_MODEL_eb1b076cfafa46288e43cf462da29747","value":"Processing: 100%"}},"92fc7000f3b3490db1fe32fbcfee44b8":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"964f2f77ab9a4383bacedc9eed214dda":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0d4fabebbcd94f988aafee660a288e15","placeholder":"​","style":"IPY_MODEL_6d647af309434310a6b730330f6d8598","value":"Summarize dataset: 100%"}},"9ba7fe2be2a74f6d844581cabf649564":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_14eb6247b81e42efa9bb3b1a1f27e372","placeholder":"​","style":"IPY_MODEL_4bf0fb430c074354859026b1a843dba5","value":"Generate report structure: 100%"}},"a342c05f395340339463462a3ded2c3c":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a3f4f709bd5f4b149528b57eadc1a9f6":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c8999c637f9f4412adf537bc1305391b","placeholder":"​","style":"IPY_MODEL_588166b0badd4b379b9cf98dc31c5305","value":"Render HTML: 100%"}},"a5901a8ad63a4bcba8e5d786b07aac63":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f1b1b4051b8f40b3a314f9e39d09ae93","placeholder":"​","style":"IPY_MODEL_84fb6f793bce49ad974de2e949106301","value":"Processing: 100%"}},"abbbe0c0a0a947e9b79b5f1d89826c0f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8eb671cd4950404a997975b8248be406","placeholder":"​","style":"IPY_MODEL_d0d3108ea5e44fcd866c9c9b0233ed42","value":" 4/4 [00:14&lt;00:00,  3.61s/it]"}},"ac41f509529c4a468928f8ceb3445abb":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_58052888702e4f07a0d864395a3798c0","max":5,"min":0,"orientation":"horizontal","style":"IPY_MODEL_27da98fd5c9a4a999288beb130f941c5","value":5}},"aed3abe7e2b042218de7c0754bd74a07":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b067d7ee2af74aef952d9f2cc39fff07":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"VBoxModel","state":{"_dom_classes":["widget-interact"],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_c55bb8c54959483a8cb50e4d1f9a8ade","IPY_MODEL_f79719496fa84711b6c390cf11013b3b"],"layout":"IPY_MODEL_40555baf9d274c5d85fb1a596054a317"}},"b100b1c655e14f4e8b0a9776fa59d641":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b4a4717dd371416db6e1c0952413d742":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b62202d7ad6c4ec6a40be1a335c4bd47":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_92111d1a2fdf4e778bb1b554ec519c62","IPY_MODEL_66b78a988bdc4da5ba1697c6cbba04b8","IPY_MODEL_abbbe0c0a0a947e9b79b5f1d89826c0f"],"layout":"IPY_MODEL_51e725a9eaa044acb6f67901265f0115"}},"b9e15d80f7454bcea63638f2dbb86522":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d61d63a6e75d453e847a8aa53c31a252","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5da7ee2242ea4b5a8799624ce604f508","value":1}},"bc1ec6dde836471c80054b120316f9e2":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9ba7fe2be2a74f6d844581cabf649564","IPY_MODEL_7eb496af18694adc96616f389e02e99c","IPY_MODEL_29ee784ea8854dd5b0f7c7e92a24d356"],"layout":"IPY_MODEL_f06d726bfaee444889bfc4977c46e243"}},"c55bb8c54959483a8cb50e4d1f9a8ade":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"ToggleButtonsModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ToggleButtonsModel","_options_labels":["Pipeline Plot","Hyperparameters","Residuals","Prediction Error","Cooks Distance","Feature Selection","Learning Curve","Manifold Learning","Validation Curve","Feature Importance","Feature Importance (All)","Decision Tree","Interactive Residuals"],"_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ToggleButtonsView","button_style":"","description":"Plot Type:","description_tooltip":null,"disabled":false,"icons":[""],"index":0,"layout":"IPY_MODEL_6c772fe15a2a48b79076237ad91cb84e","style":"IPY_MODEL_49a7ec529c5e4029a4c49fd9289b93ae","tooltips":[]}},"c8999c637f9f4412adf537bc1305391b":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d0d3108ea5e44fcd866c9c9b0233ed42":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d115d029c1ff4b60952793aaecee6ef9":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5e970f1aac7f48c58dc1b0bb49df27c0","placeholder":"​","style":"IPY_MODEL_31eccb4352b749cda60356d378ad6e00","value":" 1/1 [00:05&lt;00:00,  5.63s/it]"}},"d1c86856efe347b58c9c34fb395545ed":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d1dcd5b171644e279f3b57c4baf26465":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0de90c403fec46968d055eb8e24919a7","placeholder":"​","style":"IPY_MODEL_882a300c6f2d4ff7a99b6944bf01fc65","value":" 85/85 [02:20&lt;00:00,  2.21s/it]"}},"d61d63a6e75d453e847a8aa53c31a252":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e10d3cb0c3644b2f857b9af1b163b253":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00e1c38563af40fd8a8bf8e96a0ee495","placeholder":"​","style":"IPY_MODEL_aed3abe7e2b042218de7c0754bd74a07","value":" 100/100 [00:28&lt;00:00,  4.60it/s, Completed]"}},"e707b97882914019ac28b5759fd9067f":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f4d02335b9b412880b588f6840ad858","placeholder":"​","style":"IPY_MODEL_2bf5b43748934f03ad5972d06c828549","value":"Processing: 100%"}},"eb1b076cfafa46288e43cf462da29747":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"DescriptionStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ed7f36132b2d4746876e98c16a15d2d7":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a342c05f395340339463462a3ded2c3c","placeholder":"​","style":"IPY_MODEL_37ac5bd8921542e3b0cb05c59d0a1ee6","value":" 7/7 [02:25&lt;00:00, 15.70s/it]"}},"f06d726bfaee444889bfc4977c46e243":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f1b1b4051b8f40b3a314f9e39d09ae93":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7937d635c424375af4bff24d1873219":{"model_module":"@jupyter-widgets/controls","model_module_version":"1.5.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_051bc0777f354044b5662a45c42b8451","max":7,"min":0,"orientation":"horizontal","style":"IPY_MODEL_048f9ab8749d407ab35535f9137d642b","value":7}},"f79719496fa84711b6c390cf11013b3b":{"model_module":"@jupyter-widgets/output","model_module_version":"1.0.0","model_name":"OutputModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/output","_model_module_version":"1.0.0","_model_name":"OutputModel","_view_count":null,"_view_module":"@jupyter-widgets/output","_view_module_version":"1.0.0","_view_name":"OutputView","layout":"IPY_MODEL_0d465b565e6143febfb9e6c7412d9a52","msg_id":"","outputs":[{"data":{"image/svg+xml":"<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n  \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"1928.16pt\" height=\"102.795381pt\" viewBox=\"0 0 1928.16 102.795381\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">\n <metadata>\n  <rdf:RDF xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:cc=\"http://creativecommons.org/ns#\" xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n   <cc:Work>\n    <dc:type rdf:resource=\"http://purl.org/dc/dcmitype/StillImage\"/>\n    <dc:date>2023-02-10T07:50:50.811286</dc:date>\n    <dc:format>image/svg+xml</dc:format>\n    <dc:creator>\n     <cc:Agent>\n      <dc:title>Matplotlib v3.6.3, https://matplotlib.org/</dc:title>\n     </cc:Agent>\n    </dc:creator>\n   </cc:Work>\n  </rdf:RDF>\n </metadata>\n <defs>\n  <style type=\"text/css\">*{stroke-linejoin: round; stroke-linecap: butt}</style>\n </defs>\n <g id=\"figure_1\">\n  <g id=\"patch_1\">\n   <path d=\"M 0 102.795381 \nL 1928.16 102.795381 \nL 1928.16 0 \nL 0 0 \nz\n\" style=\"fill: #f0f0f0\"/>\n  </g>\n  <g id=\"axes_1\">\n   <g id=\"patch_2\">\n    <path d=\"M 495.986278 91.577409 \nL 496.241274 91.575386 \nL 496.496205 91.569318 \nL 496.751009 91.559205 \nL 497.00562 91.545051 \nL 497.259974 91.52686 \nL 497.514008 91.504634 \nL 497.767657 91.478382 \nL 498.020857 91.448108 \nL 498.273546 91.413821 \nL 498.525658 91.375528 \nL 498.777132 91.333241 \nL 499.027902 91.286969 \nL 499.277907 91.236724 \nL 499.527084 91.182519 \nL 499.775369 91.124368 \nL 500.0227 91.062284 \nL 500.269015 90.996284 \nL 500.514252 90.926385 \nL 500.758348 90.852603 \nL 501.001244 90.774958 \nL 501.242877 90.693469 \nL 501.483187 90.608156 \nL 501.722113 90.519041 \nL 501.959595 90.426147 \nL 502.195573 90.329496 \nL 502.429988 90.229114 \nL 502.662781 90.125025 \nL 502.893893 90.017255 \nL 503.123266 89.905833 \nL 503.350843 89.790785 \nL 503.576565 89.672141 \nL 503.800377 89.549931 \nL 504.022221 89.424185 \nL 504.242043 89.294935 \nL 504.459786 89.162213 \nL 504.675396 89.026054 \nL 504.888818 88.886491 \nL 505.1 88.743559 \nL 505.308887 88.597295 \nL 505.515427 88.447735 \nL 505.719568 88.294916 \nL 505.921259 88.138879 \nL 506.120449 87.97966 \nL 506.317088 87.817302 \nL 506.511126 87.651844 \nL 506.702514 87.483328 \nL 506.891204 87.311797 \nL 507.07715 87.137294 \nL 507.260303 86.959862 \nL 507.440618 86.779547 \nL 507.61805 86.596394 \nL 507.792553 86.410449 \nL 507.964084 86.221758 \nL 508.1326 86.03037 \nL 508.298058 85.836332 \nL 508.460416 85.639693 \nL 508.619634 85.440503 \nL 508.775672 85.238812 \nL 508.928491 85.034671 \nL 509.078051 84.828131 \nL 509.224315 84.619244 \nL 509.367247 84.408063 \nL 509.50681 84.19464 \nL 509.642969 83.97903 \nL 509.77569 83.761287 \nL 509.90494 83.541465 \nL 510.030686 83.319621 \nL 510.152897 83.095809 \nL 510.271541 82.870087 \nL 510.386589 82.64251 \nL 510.498011 82.413137 \nL 510.605781 82.182025 \nL 510.70987 81.949232 \nL 510.810252 81.714817 \nL 510.906903 81.478839 \nL 510.999797 81.241357 \nL 511.088912 81.002431 \nL 511.174224 80.762121 \nL 511.255714 80.520488 \nL 511.333359 80.277593 \nL 511.407141 80.033496 \nL 511.47704 79.788259 \nL 511.54304 79.541944 \nL 511.605124 79.294613 \nL 511.663275 79.046328 \nL 511.71748 78.797151 \nL 511.767725 78.547146 \nL 511.813997 78.296376 \nL 511.856284 78.044902 \nL 511.894576 77.79279 \nL 511.928864 77.540101 \nL 511.959138 77.286901 \nL 511.98539 77.033252 \nL 512.007615 76.779218 \nL 512.025807 76.524864 \nL 512.039961 76.270253 \nL 512.050074 76.01545 \nL 512.056142 75.760518 \nL 512.058165 75.505522 \nL 512.058165 27.289859 \nL 512.056142 27.034863 \nL 512.050074 26.779932 \nL 512.039961 26.525128 \nL 512.025807 26.270517 \nL 512.007615 26.016163 \nL 511.98539 25.762129 \nL 511.959138 25.50848 \nL 511.928864 25.25528 \nL 511.894576 25.002591 \nL 511.856284 24.750479 \nL 511.813997 24.499005 \nL 511.767725 24.248235 \nL 511.71748 23.99823 \nL 511.663275 23.749053 \nL 511.605124 23.500768 \nL 511.54304 23.253437 \nL 511.47704 23.007122 \nL 511.407141 22.761885 \nL 511.333359 22.517788 \nL 511.255714 22.274893 \nL 511.174224 22.03326 \nL 511.088912 21.79295 \nL 510.999797 21.554024 \nL 510.906903 21.316542 \nL 510.810252 21.080564 \nL 510.70987 20.846149 \nL 510.605781 20.613356 \nL 510.498011 20.382244 \nL 510.386589 20.152871 \nL 510.271541 19.925294 \nL 510.152897 19.699572 \nL 510.030686 19.47576 \nL 509.90494 19.253916 \nL 509.77569 19.034094 \nL 509.642969 18.816351 \nL 509.50681 18.600741 \nL 509.367247 18.387318 \nL 509.224315 18.176137 \nL 509.078051 17.96725 \nL 508.928491 17.76071 \nL 508.775672 17.556569 \nL 508.619634 17.354878 \nL 508.460416 17.155688 \nL 508.298058 16.959049 \nL 508.1326 16.765011 \nL 507.964084 16.573623 \nL 507.792553 16.384932 \nL 507.61805 16.198987 \nL 507.440618 16.015834 \nL 507.260303 15.835519 \nL 507.07715 15.658087 \nL 506.891204 15.483584 \nL 506.702514 15.312053 \nL 506.511126 15.143537 \nL 506.317088 14.978079 \nL 506.120449 14.815721 \nL 505.921259 14.656502 \nL 505.719568 14.500465 \nL 505.515427 14.347646 \nL 505.308887 14.198086 \nL 505.1 14.051822 \nL 504.888818 13.90889 \nL 504.675396 13.769327 \nL 504.459786 13.633168 \nL 504.242043 13.500446 \nL 504.022221 13.371197 \nL 503.800377 13.24545 \nL 503.576565 13.12324 \nL 503.350843 13.004596 \nL 503.123266 12.889548 \nL 502.893893 12.778126 \nL 502.662781 12.670356 \nL 502.429988 12.566267 \nL 502.195573 12.465885 \nL 501.959595 12.369234 \nL 501.722113 12.27634 \nL 501.483187 12.187225 \nL 501.242877 12.101913 \nL 501.001244 12.020423 \nL 500.758348 11.942778 \nL 500.514252 11.868996 \nL 500.269015 11.799097 \nL 500.0227 11.733097 \nL 499.775369 11.671013 \nL 499.527084 11.612862 \nL 499.277907 11.558657 \nL 499.027902 11.508412 \nL 498.777132 11.46214 \nL 498.525658 11.419853 \nL 498.273546 11.381561 \nL 498.020857 11.347273 \nL 497.767657 11.316999 \nL 497.514008 11.290747 \nL 497.259974 11.268522 \nL 497.00562 11.25033 \nL 496.751009 11.236176 \nL 496.496205 11.226063 \nL 496.241274 11.219995 \nL 495.986278 11.217972 \nL 319.195515 11.217972 \nL 318.940519 11.219995 \nL 318.685588 11.226063 \nL 318.430784 11.236176 \nL 318.176173 11.25033 \nL 317.921819 11.268522 \nL 317.667785 11.290747 \nL 317.414136 11.316999 \nL 317.160936 11.347273 \nL 316.908247 11.381561 \nL 316.656135 11.419853 \nL 316.404661 11.46214 \nL 316.153891 11.508412 \nL 315.903886 11.558657 \nL 315.654709 11.612862 \nL 315.406424 11.671013 \nL 315.159093 11.733097 \nL 314.912778 11.799097 \nL 314.667541 11.868996 \nL 314.423445 11.942778 \nL 314.180549 12.020423 \nL 313.938916 12.101913 \nL 313.698606 12.187225 \nL 313.45968 12.27634 \nL 313.222198 12.369234 \nL 312.98622 12.465885 \nL 312.751805 12.566267 \nL 312.519012 12.670356 \nL 312.2879 12.778126 \nL 312.058527 12.889548 \nL 311.83095 13.004596 \nL 311.605228 13.12324 \nL 311.381416 13.24545 \nL 311.159572 13.371197 \nL 310.93975 13.500446 \nL 310.722007 13.633168 \nL 310.506397 13.769327 \nL 310.292974 13.90889 \nL 310.081793 14.051822 \nL 309.872906 14.198086 \nL 309.666366 14.347646 \nL 309.462225 14.500465 \nL 309.260534 14.656502 \nL 309.061344 14.815721 \nL 308.864705 14.978079 \nL 308.670667 15.143537 \nL 308.479279 15.312053 \nL 308.290589 15.483584 \nL 308.104643 15.658087 \nL 307.92149 15.835519 \nL 307.741175 16.015834 \nL 307.563743 16.198987 \nL 307.38924 16.384932 \nL 307.217709 16.573623 \nL 307.049193 16.765011 \nL 306.883735 16.959049 \nL 306.721377 17.155688 \nL 306.562159 17.354878 \nL 306.406121 17.556569 \nL 306.253302 17.76071 \nL 306.103742 17.96725 \nL 305.957478 18.176137 \nL 305.814546 18.387318 \nL 305.674983 18.600741 \nL 305.538824 18.816351 \nL 305.406103 19.034094 \nL 305.276853 19.253916 \nL 305.151107 19.47576 \nL 305.028896 19.699572 \nL 304.910252 19.925294 \nL 304.795204 20.152871 \nL 304.683782 20.382244 \nL 304.576012 20.613356 \nL 304.471923 20.846149 \nL 304.371541 21.080564 \nL 304.27489 21.316542 \nL 304.181996 21.554024 \nL 304.092881 21.79295 \nL 304.007569 22.03326 \nL 303.926079 22.274893 \nL 303.848434 22.517788 \nL 303.774652 22.761885 \nL 303.704753 23.007122 \nL 303.638753 23.253437 \nL 303.576669 23.500768 \nL 303.518518 23.749053 \nL 303.464313 23.99823 \nL 303.414068 24.248235 \nL 303.367796 24.499005 \nL 303.325509 24.750479 \nL 303.287217 25.002591 \nL 303.252929 25.25528 \nL 303.222655 25.50848 \nL 303.196403 25.762129 \nL 303.174178 26.016163 \nL 303.155986 26.270517 \nL 303.141832 26.525128 \nL 303.131719 26.779932 \nL 303.125651 27.034863 \nL 303.123628 27.289859 \nL 303.123628 75.505522 \nL 303.125651 75.760518 \nL 303.131719 76.01545 \nL 303.141832 76.270253 \nL 303.155986 76.524864 \nL 303.174178 76.779218 \nL 303.196403 77.033252 \nL 303.222655 77.286901 \nL 303.252929 77.540101 \nL 303.287217 77.79279 \nL 303.325509 78.044902 \nL 303.367796 78.296376 \nL 303.414068 78.547146 \nL 303.464313 78.797151 \nL 303.518518 79.046328 \nL 303.576669 79.294613 \nL 303.638753 79.541944 \nL 303.704753 79.788259 \nL 303.774652 80.033496 \nL 303.848434 80.277593 \nL 303.926079 80.520488 \nL 304.007569 80.762121 \nL 304.092881 81.002431 \nL 304.181996 81.241357 \nL 304.27489 81.478839 \nL 304.371541 81.714817 \nL 304.471923 81.949232 \nL 304.576012 82.182025 \nL 304.683782 82.413137 \nL 304.795204 82.64251 \nL 304.910252 82.870087 \nL 305.028896 83.095809 \nL 305.151107 83.319621 \nL 305.276853 83.541465 \nL 305.406103 83.761287 \nL 305.538824 83.97903 \nL 305.674983 84.19464 \nL 305.814546 84.408063 \nL 305.957478 84.619244 \nL 306.103742 84.828131 \nL 306.253302 85.034671 \nL 306.406121 85.238812 \nL 306.562159 85.440503 \nL 306.721377 85.639693 \nL 306.883735 85.836332 \nL 307.049193 86.03037 \nL 307.217709 86.221758 \nL 307.38924 86.410449 \nL 307.563743 86.596394 \nL 307.741175 86.779547 \nL 307.92149 86.959862 \nL 308.104643 87.137294 \nL 308.290589 87.311797 \nL 308.479279 87.483328 \nL 308.670667 87.651844 \nL 308.864705 87.817302 \nL 309.061344 87.97966 \nL 309.260534 88.138879 \nL 309.462225 88.294916 \nL 309.666366 88.447735 \nL 309.872906 88.597295 \nL 310.081793 88.743559 \nL 310.292974 88.886491 \nL 310.506397 89.026054 \nL 310.722007 89.162213 \nL 310.93975 89.294935 \nL 311.159572 89.424185 \nL 311.381416 89.549931 \nL 311.605228 89.672141 \nL 311.83095 89.790785 \nL 312.058527 89.905833 \nL 312.2879 90.017255 \nL 312.519012 90.125025 \nL 312.751805 90.229114 \nL 312.98622 90.329496 \nL 313.222198 90.426147 \nL 313.45968 90.519041 \nL 313.698606 90.608156 \nL 313.938916 90.693469 \nL 314.180549 90.774958 \nL 314.423445 90.852603 \nL 314.667541 90.926385 \nL 314.912778 90.996284 \nL 315.159093 91.062284 \nL 315.406424 91.124368 \nL 315.654709 91.182519 \nL 315.903886 91.236724 \nL 316.153891 91.286969 \nL 316.404661 91.333241 \nL 316.656135 91.375528 \nL 316.908247 91.413821 \nL 317.160936 91.448108 \nL 317.414136 91.478382 \nL 317.667785 91.504634 \nL 317.921819 91.52686 \nL 318.176173 91.545051 \nL 318.430784 91.559205 \nL 318.685588 91.569318 \nL 318.940519 91.575386 \nL 319.195515 91.577409 \nL 495.986278 91.577409 \nz\n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_3\">\n    <path d=\"M 753.136477 91.577409 \nL 753.391473 91.575386 \nL 753.646405 91.569318 \nL 753.901208 91.559205 \nL 754.155819 91.545051 \nL 754.410173 91.52686 \nL 754.664207 91.504634 \nL 754.917856 91.478382 \nL 755.171057 91.448108 \nL 755.423745 91.413821 \nL 755.675858 91.375528 \nL 755.927331 91.333241 \nL 756.178102 91.286969 \nL 756.428107 91.236724 \nL 756.677283 91.182519 \nL 756.925568 91.124368 \nL 757.172899 91.062284 \nL 757.419214 90.996284 \nL 757.664451 90.926385 \nL 757.908548 90.852603 \nL 758.151443 90.774958 \nL 758.393077 90.693469 \nL 758.633386 90.608156 \nL 758.872312 90.519041 \nL 759.109794 90.426147 \nL 759.345772 90.329496 \nL 759.580187 90.229114 \nL 759.81298 90.125025 \nL 760.044092 90.017255 \nL 760.273466 89.905833 \nL 760.501042 89.790785 \nL 760.726765 89.672141 \nL 760.950576 89.549931 \nL 761.172421 89.424185 \nL 761.392242 89.294935 \nL 761.609985 89.162213 \nL 761.825595 89.026054 \nL 762.039018 88.886491 \nL 762.250199 88.743559 \nL 762.459086 88.597295 \nL 762.665627 88.447735 \nL 762.869768 88.294916 \nL 763.071459 88.138879 \nL 763.270649 87.97966 \nL 763.467287 87.817302 \nL 763.661325 87.651844 \nL 763.852713 87.483328 \nL 764.041404 87.311797 \nL 764.227349 87.137294 \nL 764.410502 86.959862 \nL 764.590818 86.779547 \nL 764.768249 86.596394 \nL 764.942752 86.410449 \nL 765.114283 86.221758 \nL 765.282799 86.03037 \nL 765.448257 85.836332 \nL 765.610616 85.639693 \nL 765.769834 85.440503 \nL 765.925872 85.238812 \nL 766.07869 85.034671 \nL 766.22825 84.828131 \nL 766.374514 84.619244 \nL 766.517446 84.408063 \nL 766.657009 84.19464 \nL 766.793168 83.97903 \nL 766.92589 83.761287 \nL 767.05514 83.541465 \nL 767.180886 83.319621 \nL 767.303096 83.095809 \nL 767.42174 82.870087 \nL 767.536788 82.64251 \nL 767.648211 82.413137 \nL 767.75598 82.182025 \nL 767.860069 81.949232 \nL 767.960451 81.714817 \nL 768.057102 81.478839 \nL 768.149996 81.241357 \nL 768.239111 81.002431 \nL 768.324424 80.762121 \nL 768.405913 80.520488 \nL 768.483558 80.277593 \nL 768.55734 80.033496 \nL 768.62724 79.788259 \nL 768.69324 79.541944 \nL 768.755323 79.294613 \nL 768.813475 79.046328 \nL 768.86768 78.797151 \nL 768.917925 78.547146 \nL 768.964196 78.296376 \nL 769.006484 78.044902 \nL 769.044776 77.79279 \nL 769.079063 77.540101 \nL 769.109337 77.286901 \nL 769.13559 77.033252 \nL 769.157815 76.779218 \nL 769.176007 76.524864 \nL 769.19016 76.270253 \nL 769.200273 76.01545 \nL 769.206341 75.760518 \nL 769.208364 75.505522 \nL 769.208364 27.289859 \nL 769.206341 27.034863 \nL 769.200273 26.779932 \nL 769.19016 26.525128 \nL 769.176007 26.270517 \nL 769.157815 26.016163 \nL 769.13559 25.762129 \nL 769.109337 25.50848 \nL 769.079063 25.25528 \nL 769.044776 25.002591 \nL 769.006484 24.750479 \nL 768.964196 24.499005 \nL 768.917925 24.248235 \nL 768.86768 23.99823 \nL 768.813475 23.749053 \nL 768.755323 23.500768 \nL 768.69324 23.253437 \nL 768.62724 23.007122 \nL 768.55734 22.761885 \nL 768.483558 22.517788 \nL 768.405913 22.274893 \nL 768.324424 22.03326 \nL 768.239111 21.79295 \nL 768.149996 21.554024 \nL 768.057102 21.316542 \nL 767.960451 21.080564 \nL 767.860069 20.846149 \nL 767.75598 20.613356 \nL 767.648211 20.382244 \nL 767.536788 20.152871 \nL 767.42174 19.925294 \nL 767.303096 19.699572 \nL 767.180886 19.47576 \nL 767.05514 19.253916 \nL 766.92589 19.034094 \nL 766.793168 18.816351 \nL 766.657009 18.600741 \nL 766.517446 18.387318 \nL 766.374514 18.176137 \nL 766.22825 17.96725 \nL 766.07869 17.76071 \nL 765.925872 17.556569 \nL 765.769834 17.354878 \nL 765.610616 17.155688 \nL 765.448257 16.959049 \nL 765.282799 16.765011 \nL 765.114283 16.573623 \nL 764.942752 16.384932 \nL 764.768249 16.198987 \nL 764.590818 16.015834 \nL 764.410502 15.835519 \nL 764.227349 15.658087 \nL 764.041404 15.483584 \nL 763.852713 15.312053 \nL 763.661325 15.143537 \nL 763.467287 14.978079 \nL 763.270649 14.815721 \nL 763.071459 14.656502 \nL 762.869768 14.500465 \nL 762.665627 14.347646 \nL 762.459086 14.198086 \nL 762.250199 14.051822 \nL 762.039018 13.90889 \nL 761.825595 13.769327 \nL 761.609985 13.633168 \nL 761.392242 13.500446 \nL 761.172421 13.371197 \nL 760.950576 13.24545 \nL 760.726765 13.12324 \nL 760.501042 13.004596 \nL 760.273466 12.889548 \nL 760.044092 12.778126 \nL 759.81298 12.670356 \nL 759.580187 12.566267 \nL 759.345772 12.465885 \nL 759.109794 12.369234 \nL 758.872312 12.27634 \nL 758.633386 12.187225 \nL 758.393077 12.101913 \nL 758.151443 12.020423 \nL 757.908548 11.942778 \nL 757.664451 11.868996 \nL 757.419214 11.799097 \nL 757.172899 11.733097 \nL 756.925568 11.671013 \nL 756.677283 11.612862 \nL 756.428107 11.558657 \nL 756.178102 11.508412 \nL 755.927331 11.46214 \nL 755.675858 11.419853 \nL 755.423745 11.381561 \nL 755.171057 11.347273 \nL 754.917856 11.316999 \nL 754.664207 11.290747 \nL 754.410173 11.268522 \nL 754.155819 11.25033 \nL 753.901208 11.236176 \nL 753.646405 11.226063 \nL 753.391473 11.219995 \nL 753.136477 11.217972 \nL 576.345715 11.217972 \nL 576.090719 11.219995 \nL 575.835787 11.226063 \nL 575.580984 11.236176 \nL 575.326373 11.25033 \nL 575.072018 11.268522 \nL 574.817985 11.290747 \nL 574.564336 11.316999 \nL 574.311135 11.347273 \nL 574.058447 11.381561 \nL 573.806334 11.419853 \nL 573.554861 11.46214 \nL 573.30409 11.508412 \nL 573.054085 11.558657 \nL 572.804909 11.612862 \nL 572.556624 11.671013 \nL 572.309293 11.733097 \nL 572.062978 11.799097 \nL 571.817741 11.868996 \nL 571.573644 11.942778 \nL 571.330748 12.020423 \nL 571.089115 12.101913 \nL 570.848806 12.187225 \nL 570.60988 12.27634 \nL 570.372398 12.369234 \nL 570.13642 12.465885 \nL 569.902004 12.566267 \nL 569.669212 12.670356 \nL 569.438099 12.778126 \nL 569.208726 12.889548 \nL 568.98115 13.004596 \nL 568.755427 13.12324 \nL 568.531616 13.24545 \nL 568.309771 13.371197 \nL 568.08995 13.500446 \nL 567.872207 13.633168 \nL 567.656597 13.769327 \nL 567.443174 13.90889 \nL 567.231993 14.051822 \nL 567.023106 14.198086 \nL 566.816565 14.347646 \nL 566.612424 14.500465 \nL 566.410733 14.656502 \nL 566.211543 14.815721 \nL 566.014905 14.978079 \nL 565.820867 15.143537 \nL 565.629479 15.312053 \nL 565.440788 15.483584 \nL 565.254843 15.658087 \nL 565.071689 15.835519 \nL 564.891374 16.015834 \nL 564.713943 16.198987 \nL 564.53944 16.384932 \nL 564.367909 16.573623 \nL 564.199393 16.765011 \nL 564.033935 16.959049 \nL 563.871576 17.155688 \nL 563.712358 17.354878 \nL 563.55632 17.556569 \nL 563.403502 17.76071 \nL 563.253942 17.96725 \nL 563.107678 18.176137 \nL 562.964746 18.387318 \nL 562.825183 18.600741 \nL 562.689023 18.816351 \nL 562.556302 19.034094 \nL 562.427052 19.253916 \nL 562.301306 19.47576 \nL 562.179096 19.699572 \nL 562.060452 19.925294 \nL 561.945404 20.152871 \nL 561.833981 20.382244 \nL 561.726212 20.613356 \nL 561.622123 20.846149 \nL 561.52174 21.080564 \nL 561.42509 21.316542 \nL 561.332196 21.554024 \nL 561.243081 21.79295 \nL 561.157768 22.03326 \nL 561.076279 22.274893 \nL 560.998634 22.517788 \nL 560.924852 22.761885 \nL 560.854952 23.007122 \nL 560.788952 23.253437 \nL 560.726869 23.500768 \nL 560.668717 23.749053 \nL 560.614512 23.99823 \nL 560.564267 24.248235 \nL 560.517996 24.499005 \nL 560.475708 24.750479 \nL 560.437416 25.002591 \nL 560.403129 25.25528 \nL 560.372855 25.50848 \nL 560.346602 25.762129 \nL 560.324377 26.016163 \nL 560.306185 26.270517 \nL 560.292031 26.525128 \nL 560.281919 26.779932 \nL 560.27585 27.034863 \nL 560.273827 27.289859 \nL 560.273827 75.505522 \nL 560.27585 75.760518 \nL 560.281919 76.01545 \nL 560.292031 76.270253 \nL 560.306185 76.524864 \nL 560.324377 76.779218 \nL 560.346602 77.033252 \nL 560.372855 77.286901 \nL 560.403129 77.540101 \nL 560.437416 77.79279 \nL 560.475708 78.044902 \nL 560.517996 78.296376 \nL 560.564267 78.547146 \nL 560.614512 78.797151 \nL 560.668717 79.046328 \nL 560.726869 79.294613 \nL 560.788952 79.541944 \nL 560.854952 79.788259 \nL 560.924852 80.033496 \nL 560.998634 80.277593 \nL 561.076279 80.520488 \nL 561.157768 80.762121 \nL 561.243081 81.002431 \nL 561.332196 81.241357 \nL 561.42509 81.478839 \nL 561.52174 81.714817 \nL 561.622123 81.949232 \nL 561.726212 82.182025 \nL 561.833981 82.413137 \nL 561.945404 82.64251 \nL 562.060452 82.870087 \nL 562.179096 83.095809 \nL 562.301306 83.319621 \nL 562.427052 83.541465 \nL 562.556302 83.761287 \nL 562.689023 83.97903 \nL 562.825183 84.19464 \nL 562.964746 84.408063 \nL 563.107678 84.619244 \nL 563.253942 84.828131 \nL 563.403502 85.034671 \nL 563.55632 85.238812 \nL 563.712358 85.440503 \nL 563.871576 85.639693 \nL 564.033935 85.836332 \nL 564.199393 86.03037 \nL 564.367909 86.221758 \nL 564.53944 86.410449 \nL 564.713943 86.596394 \nL 564.891374 86.779547 \nL 565.071689 86.959862 \nL 565.254843 87.137294 \nL 565.440788 87.311797 \nL 565.629479 87.483328 \nL 565.820867 87.651844 \nL 566.014905 87.817302 \nL 566.211543 87.97966 \nL 566.410733 88.138879 \nL 566.612424 88.294916 \nL 566.816565 88.447735 \nL 567.023106 88.597295 \nL 567.231993 88.743559 \nL 567.443174 88.886491 \nL 567.656597 89.026054 \nL 567.872207 89.162213 \nL 568.08995 89.294935 \nL 568.309771 89.424185 \nL 568.531616 89.549931 \nL 568.755427 89.672141 \nL 568.98115 89.790785 \nL 569.208726 89.905833 \nL 569.438099 90.017255 \nL 569.669212 90.125025 \nL 569.902004 90.229114 \nL 570.13642 90.329496 \nL 570.372398 90.426147 \nL 570.60988 90.519041 \nL 570.848806 90.608156 \nL 571.089115 90.693469 \nL 571.330748 90.774958 \nL 571.573644 90.852603 \nL 571.817741 90.926385 \nL 572.062978 90.996284 \nL 572.309293 91.062284 \nL 572.556624 91.124368 \nL 572.804909 91.182519 \nL 573.054085 91.236724 \nL 573.30409 91.286969 \nL 573.554861 91.333241 \nL 573.806334 91.375528 \nL 574.058447 91.413821 \nL 574.311135 91.448108 \nL 574.564336 91.478382 \nL 574.817985 91.504634 \nL 575.072018 91.52686 \nL 575.326373 91.545051 \nL 575.580984 91.559205 \nL 575.835787 91.569318 \nL 576.090719 91.575386 \nL 576.345715 91.577409 \nL 753.136477 91.577409 \nz\n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_4\">\n    <path d=\"M 1010.286676 91.577409 \nL 1010.541672 91.575386 \nL 1010.796604 91.569318 \nL 1011.051408 91.559205 \nL 1011.306019 91.545051 \nL 1011.560373 91.52686 \nL 1011.814406 91.504634 \nL 1012.068056 91.478382 \nL 1012.321256 91.448108 \nL 1012.573945 91.413821 \nL 1012.826057 91.375528 \nL 1013.07753 91.333241 \nL 1013.328301 91.286969 \nL 1013.578306 91.236724 \nL 1013.827483 91.182519 \nL 1014.075768 91.124368 \nL 1014.323099 91.062284 \nL 1014.569414 90.996284 \nL 1014.81465 90.926385 \nL 1015.058747 90.852603 \nL 1015.301643 90.774958 \nL 1015.543276 90.693469 \nL 1015.783586 90.608156 \nL 1016.022512 90.519041 \nL 1016.259994 90.426147 \nL 1016.495972 90.329496 \nL 1016.730387 90.229114 \nL 1016.96318 90.125025 \nL 1017.194292 90.017255 \nL 1017.423665 89.905833 \nL 1017.651242 89.790785 \nL 1017.876964 89.672141 \nL 1018.100776 89.549931 \nL 1018.32262 89.424185 \nL 1018.542442 89.294935 \nL 1018.760185 89.162213 \nL 1018.975795 89.026054 \nL 1019.189217 88.886491 \nL 1019.400399 88.743559 \nL 1019.609286 88.597295 \nL 1019.815826 88.447735 \nL 1020.019967 88.294916 \nL 1020.221658 88.138879 \nL 1020.420848 87.97966 \nL 1020.617487 87.817302 \nL 1020.811524 87.651844 \nL 1021.002913 87.483328 \nL 1021.191603 87.311797 \nL 1021.377549 87.137294 \nL 1021.560702 86.959862 \nL 1021.741017 86.779547 \nL 1021.918448 86.596394 \nL 1022.092952 86.410449 \nL 1022.264483 86.221758 \nL 1022.432999 86.03037 \nL 1022.598457 85.836332 \nL 1022.760815 85.639693 \nL 1022.920033 85.440503 \nL 1023.076071 85.238812 \nL 1023.228889 85.034671 \nL 1023.378449 84.828131 \nL 1023.524714 84.619244 \nL 1023.667645 84.408063 \nL 1023.807209 84.19464 \nL 1023.943368 83.97903 \nL 1024.076089 83.761287 \nL 1024.205339 83.541465 \nL 1024.331085 83.319621 \nL 1024.453296 83.095809 \nL 1024.57194 82.870087 \nL 1024.686988 82.64251 \nL 1024.79841 82.413137 \nL 1024.90618 82.182025 \nL 1025.010268 81.949232 \nL 1025.110651 81.714817 \nL 1025.207301 81.478839 \nL 1025.300196 81.241357 \nL 1025.389311 81.002431 \nL 1025.474623 80.762121 \nL 1025.556113 80.520488 \nL 1025.633758 80.277593 \nL 1025.70754 80.033496 \nL 1025.777439 79.788259 \nL 1025.843439 79.541944 \nL 1025.905523 79.294613 \nL 1025.963674 79.046328 \nL 1026.017879 78.797151 \nL 1026.068124 78.547146 \nL 1026.114396 78.296376 \nL 1026.156683 78.044902 \nL 1026.194975 77.79279 \nL 1026.229263 77.540101 \nL 1026.259536 77.286901 \nL 1026.285789 77.033252 \nL 1026.308014 76.779218 \nL 1026.326206 76.524864 \nL 1026.34036 76.270253 \nL 1026.350472 76.01545 \nL 1026.356541 75.760518 \nL 1026.358564 75.505522 \nL 1026.358564 27.289859 \nL 1026.356541 27.034863 \nL 1026.350472 26.779932 \nL 1026.34036 26.525128 \nL 1026.326206 26.270517 \nL 1026.308014 26.016163 \nL 1026.285789 25.762129 \nL 1026.259536 25.50848 \nL 1026.229263 25.25528 \nL 1026.194975 25.002591 \nL 1026.156683 24.750479 \nL 1026.114396 24.499005 \nL 1026.068124 24.248235 \nL 1026.017879 23.99823 \nL 1025.963674 23.749053 \nL 1025.905523 23.500768 \nL 1025.843439 23.253437 \nL 1025.777439 23.007122 \nL 1025.70754 22.761885 \nL 1025.633758 22.517788 \nL 1025.556113 22.274893 \nL 1025.474623 22.03326 \nL 1025.389311 21.79295 \nL 1025.300196 21.554024 \nL 1025.207301 21.316542 \nL 1025.110651 21.080564 \nL 1025.010268 20.846149 \nL 1024.90618 20.613356 \nL 1024.79841 20.382244 \nL 1024.686988 20.152871 \nL 1024.57194 19.925294 \nL 1024.453296 19.699572 \nL 1024.331085 19.47576 \nL 1024.205339 19.253916 \nL 1024.076089 19.034094 \nL 1023.943368 18.816351 \nL 1023.807209 18.600741 \nL 1023.667645 18.387318 \nL 1023.524714 18.176137 \nL 1023.378449 17.96725 \nL 1023.228889 17.76071 \nL 1023.076071 17.556569 \nL 1022.920033 17.354878 \nL 1022.760815 17.155688 \nL 1022.598457 16.959049 \nL 1022.432999 16.765011 \nL 1022.264483 16.573623 \nL 1022.092952 16.384932 \nL 1021.918448 16.198987 \nL 1021.741017 16.015834 \nL 1021.560702 15.835519 \nL 1021.377549 15.658087 \nL 1021.191603 15.483584 \nL 1021.002913 15.312053 \nL 1020.811524 15.143537 \nL 1020.617487 14.978079 \nL 1020.420848 14.815721 \nL 1020.221658 14.656502 \nL 1020.019967 14.500465 \nL 1019.815826 14.347646 \nL 1019.609286 14.198086 \nL 1019.400399 14.051822 \nL 1019.189217 13.90889 \nL 1018.975795 13.769327 \nL 1018.760185 13.633168 \nL 1018.542442 13.500446 \nL 1018.32262 13.371197 \nL 1018.100776 13.24545 \nL 1017.876964 13.12324 \nL 1017.651242 13.004596 \nL 1017.423665 12.889548 \nL 1017.194292 12.778126 \nL 1016.96318 12.670356 \nL 1016.730387 12.566267 \nL 1016.495972 12.465885 \nL 1016.259994 12.369234 \nL 1016.022512 12.27634 \nL 1015.783586 12.187225 \nL 1015.543276 12.101913 \nL 1015.301643 12.020423 \nL 1015.058747 11.942778 \nL 1014.81465 11.868996 \nL 1014.569414 11.799097 \nL 1014.323099 11.733097 \nL 1014.075768 11.671013 \nL 1013.827483 11.612862 \nL 1013.578306 11.558657 \nL 1013.328301 11.508412 \nL 1013.07753 11.46214 \nL 1012.826057 11.419853 \nL 1012.573945 11.381561 \nL 1012.321256 11.347273 \nL 1012.068056 11.316999 \nL 1011.814406 11.290747 \nL 1011.560373 11.268522 \nL 1011.306019 11.25033 \nL 1011.051408 11.236176 \nL 1010.796604 11.226063 \nL 1010.541672 11.219995 \nL 1010.286676 11.217972 \nL 833.495914 11.217972 \nL 833.240918 11.219995 \nL 832.985987 11.226063 \nL 832.731183 11.236176 \nL 832.476572 11.25033 \nL 832.222218 11.268522 \nL 831.968184 11.290747 \nL 831.714535 11.316999 \nL 831.461335 11.347273 \nL 831.208646 11.381561 \nL 830.956534 11.419853 \nL 830.70506 11.46214 \nL 830.45429 11.508412 \nL 830.204285 11.558657 \nL 829.955108 11.612862 \nL 829.706823 11.671013 \nL 829.459492 11.733097 \nL 829.213177 11.799097 \nL 828.96794 11.868996 \nL 828.723843 11.942778 \nL 828.480948 12.020423 \nL 828.239315 12.101913 \nL 827.999005 12.187225 \nL 827.760079 12.27634 \nL 827.522597 12.369234 \nL 827.286619 12.465885 \nL 827.052204 12.566267 \nL 826.819411 12.670356 \nL 826.588299 12.778126 \nL 826.358926 12.889548 \nL 826.131349 13.004596 \nL 825.905627 13.12324 \nL 825.681815 13.24545 \nL 825.459971 13.371197 \nL 825.240149 13.500446 \nL 825.022406 13.633168 \nL 824.806796 13.769327 \nL 824.593373 13.90889 \nL 824.382192 14.051822 \nL 824.173305 14.198086 \nL 823.966765 14.347646 \nL 823.762624 14.500465 \nL 823.560933 14.656502 \nL 823.361743 14.815721 \nL 823.165104 14.978079 \nL 822.971066 15.143537 \nL 822.779678 15.312053 \nL 822.590987 15.483584 \nL 822.405042 15.658087 \nL 822.221889 15.835519 \nL 822.041574 16.015834 \nL 821.864142 16.198987 \nL 821.689639 16.384932 \nL 821.518108 16.573623 \nL 821.349592 16.765011 \nL 821.184134 16.959049 \nL 821.021776 17.155688 \nL 820.862557 17.354878 \nL 820.70652 17.556569 \nL 820.553701 17.76071 \nL 820.404141 17.96725 \nL 820.257877 18.176137 \nL 820.114945 18.387318 \nL 819.975382 18.600741 \nL 819.839223 18.816351 \nL 819.706501 19.034094 \nL 819.577252 19.253916 \nL 819.451505 19.47576 \nL 819.329295 19.699572 \nL 819.210651 19.925294 \nL 819.095603 20.152871 \nL 818.984181 20.382244 \nL 818.876411 20.613356 \nL 818.772322 20.846149 \nL 818.67194 21.080564 \nL 818.575289 21.316542 \nL 818.482395 21.554024 \nL 818.39328 21.79295 \nL 818.307968 22.03326 \nL 818.226478 22.274893 \nL 818.148833 22.517788 \nL 818.075051 22.761885 \nL 818.005152 23.007122 \nL 817.939152 23.253437 \nL 817.877068 23.500768 \nL 817.818917 23.749053 \nL 817.764712 23.99823 \nL 817.714467 24.248235 \nL 817.668195 24.499005 \nL 817.625908 24.750479 \nL 817.587616 25.002591 \nL 817.553328 25.25528 \nL 817.523054 25.50848 \nL 817.496802 25.762129 \nL 817.474577 26.016163 \nL 817.456385 26.270517 \nL 817.442231 26.525128 \nL 817.432118 26.779932 \nL 817.42605 27.034863 \nL 817.424027 27.289859 \nL 817.424027 75.505522 \nL 817.42605 75.760518 \nL 817.432118 76.01545 \nL 817.442231 76.270253 \nL 817.456385 76.524864 \nL 817.474577 76.779218 \nL 817.496802 77.033252 \nL 817.523054 77.286901 \nL 817.553328 77.540101 \nL 817.587616 77.79279 \nL 817.625908 78.044902 \nL 817.668195 78.296376 \nL 817.714467 78.547146 \nL 817.764712 78.797151 \nL 817.818917 79.046328 \nL 817.877068 79.294613 \nL 817.939152 79.541944 \nL 818.005152 79.788259 \nL 818.075051 80.033496 \nL 818.148833 80.277593 \nL 818.226478 80.520488 \nL 818.307968 80.762121 \nL 818.39328 81.002431 \nL 818.482395 81.241357 \nL 818.575289 81.478839 \nL 818.67194 81.714817 \nL 818.772322 81.949232 \nL 818.876411 82.182025 \nL 818.984181 82.413137 \nL 819.095603 82.64251 \nL 819.210651 82.870087 \nL 819.329295 83.095809 \nL 819.451505 83.319621 \nL 819.577252 83.541465 \nL 819.706501 83.761287 \nL 819.839223 83.97903 \nL 819.975382 84.19464 \nL 820.114945 84.408063 \nL 820.257877 84.619244 \nL 820.404141 84.828131 \nL 820.553701 85.034671 \nL 820.70652 85.238812 \nL 820.862557 85.440503 \nL 821.021776 85.639693 \nL 821.184134 85.836332 \nL 821.349592 86.03037 \nL 821.518108 86.221758 \nL 821.689639 86.410449 \nL 821.864142 86.596394 \nL 822.041574 86.779547 \nL 822.221889 86.959862 \nL 822.405042 87.137294 \nL 822.590987 87.311797 \nL 822.779678 87.483328 \nL 822.971066 87.651844 \nL 823.165104 87.817302 \nL 823.361743 87.97966 \nL 823.560933 88.138879 \nL 823.762624 88.294916 \nL 823.966765 88.447735 \nL 824.173305 88.597295 \nL 824.382192 88.743559 \nL 824.593373 88.886491 \nL 824.806796 89.026054 \nL 825.022406 89.162213 \nL 825.240149 89.294935 \nL 825.459971 89.424185 \nL 825.681815 89.549931 \nL 825.905627 89.672141 \nL 826.131349 89.790785 \nL 826.358926 89.905833 \nL 826.588299 90.017255 \nL 826.819411 90.125025 \nL 827.052204 90.229114 \nL 827.286619 90.329496 \nL 827.522597 90.426147 \nL 827.760079 90.519041 \nL 827.999005 90.608156 \nL 828.239315 90.693469 \nL 828.480948 90.774958 \nL 828.723843 90.852603 \nL 828.96794 90.926385 \nL 829.213177 90.996284 \nL 829.459492 91.062284 \nL 829.706823 91.124368 \nL 829.955108 91.182519 \nL 830.204285 91.236724 \nL 830.45429 91.286969 \nL 830.70506 91.333241 \nL 830.956534 91.375528 \nL 831.208646 91.413821 \nL 831.461335 91.448108 \nL 831.714535 91.478382 \nL 831.968184 91.504634 \nL 832.222218 91.52686 \nL 832.476572 91.545051 \nL 832.731183 91.559205 \nL 832.985987 91.569318 \nL 833.240918 91.575386 \nL 833.495914 91.577409 \nL 1010.286676 91.577409 \nz\n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_5\">\n    <path d=\"M 1283.508763 91.577409 \nL 1283.763759 91.575386 \nL 1284.018691 91.569318 \nL 1284.273495 91.559205 \nL 1284.528105 91.545051 \nL 1284.78246 91.52686 \nL 1285.036493 91.504634 \nL 1285.290142 91.478382 \nL 1285.543343 91.448108 \nL 1285.796031 91.413821 \nL 1286.048144 91.375528 \nL 1286.299617 91.333241 \nL 1286.550388 91.286969 \nL 1286.800393 91.236724 \nL 1287.049569 91.182519 \nL 1287.297854 91.124368 \nL 1287.545186 91.062284 \nL 1287.791501 90.996284 \nL 1288.036737 90.926385 \nL 1288.280834 90.852603 \nL 1288.52373 90.774958 \nL 1288.765363 90.693469 \nL 1289.005673 90.608156 \nL 1289.244599 90.519041 \nL 1289.482081 90.426147 \nL 1289.718059 90.329496 \nL 1289.952474 90.229114 \nL 1290.185267 90.125025 \nL 1290.416379 90.017255 \nL 1290.645752 89.905833 \nL 1290.873328 89.790785 \nL 1291.099051 89.672141 \nL 1291.322863 89.549931 \nL 1291.544707 89.424185 \nL 1291.764529 89.294935 \nL 1291.982272 89.162213 \nL 1292.197882 89.026054 \nL 1292.411304 88.886491 \nL 1292.622486 88.743559 \nL 1292.831373 88.597295 \nL 1293.037913 88.447735 \nL 1293.242054 88.294916 \nL 1293.443745 88.138879 \nL 1293.642935 87.97966 \nL 1293.839574 87.817302 \nL 1294.033611 87.651844 \nL 1294.225 87.483328 \nL 1294.41369 87.311797 \nL 1294.599636 87.137294 \nL 1294.782789 86.959862 \nL 1294.963104 86.779547 \nL 1295.140535 86.596394 \nL 1295.315039 86.410449 \nL 1295.48657 86.221758 \nL 1295.655085 86.03037 \nL 1295.820543 85.836332 \nL 1295.982902 85.639693 \nL 1296.14212 85.440503 \nL 1296.298158 85.238812 \nL 1296.450976 85.034671 \nL 1296.600536 84.828131 \nL 1296.746801 84.619244 \nL 1296.889732 84.408063 \nL 1297.029295 84.19464 \nL 1297.165455 83.97903 \nL 1297.298176 83.761287 \nL 1297.427426 83.541465 \nL 1297.553172 83.319621 \nL 1297.675383 83.095809 \nL 1297.794027 82.870087 \nL 1297.909074 82.64251 \nL 1298.020497 82.413137 \nL 1298.128266 82.182025 \nL 1298.232355 81.949232 \nL 1298.332738 81.714817 \nL 1298.429388 81.478839 \nL 1298.522283 81.241357 \nL 1298.611397 81.002431 \nL 1298.69671 80.762121 \nL 1298.778199 80.520488 \nL 1298.855845 80.277593 \nL 1298.929626 80.033496 \nL 1298.999526 79.788259 \nL 1299.065526 79.541944 \nL 1299.12761 79.294613 \nL 1299.185761 79.046328 \nL 1299.239966 78.797151 \nL 1299.290211 78.547146 \nL 1299.336483 78.296376 \nL 1299.37877 78.044902 \nL 1299.417062 77.79279 \nL 1299.45135 77.540101 \nL 1299.481623 77.286901 \nL 1299.507876 77.033252 \nL 1299.530101 76.779218 \nL 1299.548293 76.524864 \nL 1299.562447 76.270253 \nL 1299.572559 76.01545 \nL 1299.578628 75.760518 \nL 1299.580651 75.505522 \nL 1299.580651 27.289859 \nL 1299.578628 27.034863 \nL 1299.572559 26.779932 \nL 1299.562447 26.525128 \nL 1299.548293 26.270517 \nL 1299.530101 26.016163 \nL 1299.507876 25.762129 \nL 1299.481623 25.50848 \nL 1299.45135 25.25528 \nL 1299.417062 25.002591 \nL 1299.37877 24.750479 \nL 1299.336483 24.499005 \nL 1299.290211 24.248235 \nL 1299.239966 23.99823 \nL 1299.185761 23.749053 \nL 1299.12761 23.500768 \nL 1299.065526 23.253437 \nL 1298.999526 23.007122 \nL 1298.929626 22.761885 \nL 1298.855845 22.517788 \nL 1298.778199 22.274893 \nL 1298.69671 22.03326 \nL 1298.611397 21.79295 \nL 1298.522283 21.554024 \nL 1298.429388 21.316542 \nL 1298.332738 21.080564 \nL 1298.232355 20.846149 \nL 1298.128266 20.613356 \nL 1298.020497 20.382244 \nL 1297.909074 20.152871 \nL 1297.794027 19.925294 \nL 1297.675383 19.699572 \nL 1297.553172 19.47576 \nL 1297.427426 19.253916 \nL 1297.298176 19.034094 \nL 1297.165455 18.816351 \nL 1297.029295 18.600741 \nL 1296.889732 18.387318 \nL 1296.746801 18.176137 \nL 1296.600536 17.96725 \nL 1296.450976 17.76071 \nL 1296.298158 17.556569 \nL 1296.14212 17.354878 \nL 1295.982902 17.155688 \nL 1295.820543 16.959049 \nL 1295.655085 16.765011 \nL 1295.48657 16.573623 \nL 1295.315039 16.384932 \nL 1295.140535 16.198987 \nL 1294.963104 16.015834 \nL 1294.782789 15.835519 \nL 1294.599636 15.658087 \nL 1294.41369 15.483584 \nL 1294.225 15.312053 \nL 1294.033611 15.143537 \nL 1293.839574 14.978079 \nL 1293.642935 14.815721 \nL 1293.443745 14.656502 \nL 1293.242054 14.500465 \nL 1293.037913 14.347646 \nL 1292.831373 14.198086 \nL 1292.622486 14.051822 \nL 1292.411304 13.90889 \nL 1292.197882 13.769327 \nL 1291.982272 13.633168 \nL 1291.764529 13.500446 \nL 1291.544707 13.371197 \nL 1291.322863 13.24545 \nL 1291.099051 13.12324 \nL 1290.873328 13.004596 \nL 1290.645752 12.889548 \nL 1290.416379 12.778126 \nL 1290.185267 12.670356 \nL 1289.952474 12.566267 \nL 1289.718059 12.465885 \nL 1289.482081 12.369234 \nL 1289.244599 12.27634 \nL 1289.005673 12.187225 \nL 1288.765363 12.101913 \nL 1288.52373 12.020423 \nL 1288.280834 11.942778 \nL 1288.036737 11.868996 \nL 1287.791501 11.799097 \nL 1287.545186 11.733097 \nL 1287.297854 11.671013 \nL 1287.049569 11.612862 \nL 1286.800393 11.558657 \nL 1286.550388 11.508412 \nL 1286.299617 11.46214 \nL 1286.048144 11.419853 \nL 1285.796031 11.381561 \nL 1285.543343 11.347273 \nL 1285.290142 11.316999 \nL 1285.036493 11.290747 \nL 1284.78246 11.268522 \nL 1284.528105 11.25033 \nL 1284.273495 11.236176 \nL 1284.018691 11.226063 \nL 1283.763759 11.219995 \nL 1283.508763 11.217972 \nL 1090.646114 11.217972 \nL 1090.391118 11.219995 \nL 1090.136186 11.226063 \nL 1089.881383 11.236176 \nL 1089.626772 11.25033 \nL 1089.372417 11.268522 \nL 1089.118384 11.290747 \nL 1088.864735 11.316999 \nL 1088.611534 11.347273 \nL 1088.358846 11.381561 \nL 1088.106733 11.419853 \nL 1087.85526 11.46214 \nL 1087.604489 11.508412 \nL 1087.354484 11.558657 \nL 1087.105308 11.612862 \nL 1086.857023 11.671013 \nL 1086.609692 11.733097 \nL 1086.363377 11.799097 \nL 1086.11814 11.868996 \nL 1085.874043 11.942778 \nL 1085.631147 12.020423 \nL 1085.389514 12.101913 \nL 1085.149205 12.187225 \nL 1084.910279 12.27634 \nL 1084.672797 12.369234 \nL 1084.436818 12.465885 \nL 1084.202403 12.566267 \nL 1083.96961 12.670356 \nL 1083.738498 12.778126 \nL 1083.509125 12.889548 \nL 1083.281549 13.004596 \nL 1083.055826 13.12324 \nL 1082.832015 13.24545 \nL 1082.61017 13.371197 \nL 1082.390349 13.500446 \nL 1082.172605 13.633168 \nL 1081.956995 13.769327 \nL 1081.743573 13.90889 \nL 1081.532391 14.051822 \nL 1081.323504 14.198086 \nL 1081.116964 14.347646 \nL 1080.912823 14.500465 \nL 1080.711132 14.656502 \nL 1080.511942 14.815721 \nL 1080.315304 14.978079 \nL 1080.121266 15.143537 \nL 1079.929877 15.312053 \nL 1079.741187 15.483584 \nL 1079.555242 15.658087 \nL 1079.372088 15.835519 \nL 1079.191773 16.015834 \nL 1079.014342 16.198987 \nL 1078.839839 16.384932 \nL 1078.668307 16.573623 \nL 1078.499792 16.765011 \nL 1078.334334 16.959049 \nL 1078.171975 17.155688 \nL 1078.012757 17.354878 \nL 1077.856719 17.556569 \nL 1077.703901 17.76071 \nL 1077.554341 17.96725 \nL 1077.408076 18.176137 \nL 1077.265145 18.387318 \nL 1077.125582 18.600741 \nL 1076.989422 18.816351 \nL 1076.856701 19.034094 \nL 1076.727451 19.253916 \nL 1076.601705 19.47576 \nL 1076.479495 19.699572 \nL 1076.36085 19.925294 \nL 1076.245803 20.152871 \nL 1076.13438 20.382244 \nL 1076.026611 20.613356 \nL 1075.922522 20.846149 \nL 1075.822139 21.080564 \nL 1075.725489 21.316542 \nL 1075.632595 21.554024 \nL 1075.54348 21.79295 \nL 1075.458167 22.03326 \nL 1075.376678 22.274893 \nL 1075.299032 22.517788 \nL 1075.225251 22.761885 \nL 1075.155351 23.007122 \nL 1075.089351 23.253437 \nL 1075.027268 23.500768 \nL 1074.969116 23.749053 \nL 1074.914911 23.99823 \nL 1074.864666 24.248235 \nL 1074.818394 24.499005 \nL 1074.776107 24.750479 \nL 1074.737815 25.002591 \nL 1074.703528 25.25528 \nL 1074.673254 25.50848 \nL 1074.647001 25.762129 \nL 1074.624776 26.016163 \nL 1074.606584 26.270517 \nL 1074.59243 26.525128 \nL 1074.582318 26.779932 \nL 1074.576249 27.034863 \nL 1074.574226 27.289859 \nL 1074.574226 75.505522 \nL 1074.576249 75.760518 \nL 1074.582318 76.01545 \nL 1074.59243 76.270253 \nL 1074.606584 76.524864 \nL 1074.624776 76.779218 \nL 1074.647001 77.033252 \nL 1074.673254 77.286901 \nL 1074.703528 77.540101 \nL 1074.737815 77.79279 \nL 1074.776107 78.044902 \nL 1074.818394 78.296376 \nL 1074.864666 78.547146 \nL 1074.914911 78.797151 \nL 1074.969116 79.046328 \nL 1075.027268 79.294613 \nL 1075.089351 79.541944 \nL 1075.155351 79.788259 \nL 1075.225251 80.033496 \nL 1075.299032 80.277593 \nL 1075.376678 80.520488 \nL 1075.458167 80.762121 \nL 1075.54348 81.002431 \nL 1075.632595 81.241357 \nL 1075.725489 81.478839 \nL 1075.822139 81.714817 \nL 1075.922522 81.949232 \nL 1076.026611 82.182025 \nL 1076.13438 82.413137 \nL 1076.245803 82.64251 \nL 1076.36085 82.870087 \nL 1076.479495 83.095809 \nL 1076.601705 83.319621 \nL 1076.727451 83.541465 \nL 1076.856701 83.761287 \nL 1076.989422 83.97903 \nL 1077.125582 84.19464 \nL 1077.265145 84.408063 \nL 1077.408076 84.619244 \nL 1077.554341 84.828131 \nL 1077.703901 85.034671 \nL 1077.856719 85.238812 \nL 1078.012757 85.440503 \nL 1078.171975 85.639693 \nL 1078.334334 85.836332 \nL 1078.499792 86.03037 \nL 1078.668307 86.221758 \nL 1078.839839 86.410449 \nL 1079.014342 86.596394 \nL 1079.191773 86.779547 \nL 1079.372088 86.959862 \nL 1079.555242 87.137294 \nL 1079.741187 87.311797 \nL 1079.929877 87.483328 \nL 1080.121266 87.651844 \nL 1080.315304 87.817302 \nL 1080.511942 87.97966 \nL 1080.711132 88.138879 \nL 1080.912823 88.294916 \nL 1081.116964 88.447735 \nL 1081.323504 88.597295 \nL 1081.532391 88.743559 \nL 1081.743573 88.886491 \nL 1081.956995 89.026054 \nL 1082.172605 89.162213 \nL 1082.390349 89.294935 \nL 1082.61017 89.424185 \nL 1082.832015 89.549931 \nL 1083.055826 89.672141 \nL 1083.281549 89.790785 \nL 1083.509125 89.905833 \nL 1083.738498 90.017255 \nL 1083.96961 90.125025 \nL 1084.202403 90.229114 \nL 1084.436818 90.329496 \nL 1084.672797 90.426147 \nL 1084.910279 90.519041 \nL 1085.149205 90.608156 \nL 1085.389514 90.693469 \nL 1085.631147 90.774958 \nL 1085.874043 90.852603 \nL 1086.11814 90.926385 \nL 1086.363377 90.996284 \nL 1086.609692 91.062284 \nL 1086.857023 91.124368 \nL 1087.105308 91.182519 \nL 1087.354484 91.236724 \nL 1087.604489 91.286969 \nL 1087.85526 91.333241 \nL 1088.106733 91.375528 \nL 1088.358846 91.413821 \nL 1088.611534 91.448108 \nL 1088.864735 91.478382 \nL 1089.118384 91.504634 \nL 1089.372417 91.52686 \nL 1089.626772 91.545051 \nL 1089.881383 91.559205 \nL 1090.136186 91.569318 \nL 1090.391118 91.575386 \nL 1090.646114 91.577409 \nL 1283.508763 91.577409 \nz\n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_6\">\n    <path d=\"M 1556.73085 91.577409 \nL 1556.985846 91.575386 \nL 1557.240778 91.569318 \nL 1557.495582 91.559205 \nL 1557.750192 91.545051 \nL 1558.004547 91.52686 \nL 1558.25858 91.504634 \nL 1558.512229 91.478382 \nL 1558.76543 91.448108 \nL 1559.018118 91.413821 \nL 1559.270231 91.375528 \nL 1559.521704 91.333241 \nL 1559.772475 91.286969 \nL 1560.02248 91.236724 \nL 1560.271656 91.182519 \nL 1560.519941 91.124368 \nL 1560.767272 91.062284 \nL 1561.013587 90.996284 \nL 1561.258824 90.926385 \nL 1561.502921 90.852603 \nL 1561.745817 90.774958 \nL 1561.98745 90.693469 \nL 1562.22776 90.608156 \nL 1562.466685 90.519041 \nL 1562.704167 90.426147 \nL 1562.940146 90.329496 \nL 1563.174561 90.229114 \nL 1563.407354 90.125025 \nL 1563.638466 90.017255 \nL 1563.867839 89.905833 \nL 1564.095415 89.790785 \nL 1564.321138 89.672141 \nL 1564.54495 89.549931 \nL 1564.766794 89.424185 \nL 1564.986616 89.294935 \nL 1565.204359 89.162213 \nL 1565.419969 89.026054 \nL 1565.633391 88.886491 \nL 1565.844573 88.743559 \nL 1566.05346 88.597295 \nL 1566.26 88.447735 \nL 1566.464141 88.294916 \nL 1566.665832 88.138879 \nL 1566.865022 87.97966 \nL 1567.06166 87.817302 \nL 1567.255698 87.651844 \nL 1567.447087 87.483328 \nL 1567.635777 87.311797 \nL 1567.821723 87.137294 \nL 1568.004876 86.959862 \nL 1568.185191 86.779547 \nL 1568.362622 86.596394 \nL 1568.537126 86.410449 \nL 1568.708657 86.221758 \nL 1568.877172 86.03037 \nL 1569.04263 85.836332 \nL 1569.204989 85.639693 \nL 1569.364207 85.440503 \nL 1569.520245 85.238812 \nL 1569.673063 85.034671 \nL 1569.822623 84.828131 \nL 1569.968888 84.619244 \nL 1570.111819 84.408063 \nL 1570.251382 84.19464 \nL 1570.387542 83.97903 \nL 1570.520263 83.761287 \nL 1570.649513 83.541465 \nL 1570.775259 83.319621 \nL 1570.89747 83.095809 \nL 1571.016114 82.870087 \nL 1571.131161 82.64251 \nL 1571.242584 82.413137 \nL 1571.350353 82.182025 \nL 1571.454442 81.949232 \nL 1571.554825 81.714817 \nL 1571.651475 81.478839 \nL 1571.74437 81.241357 \nL 1571.833484 81.002431 \nL 1571.918797 80.762121 \nL 1572.000286 80.520488 \nL 1572.077932 80.277593 \nL 1572.151713 80.033496 \nL 1572.221613 79.788259 \nL 1572.287613 79.541944 \nL 1572.349696 79.294613 \nL 1572.407848 79.046328 \nL 1572.462053 78.797151 \nL 1572.512298 78.547146 \nL 1572.55857 78.296376 \nL 1572.600857 78.044902 \nL 1572.639149 77.79279 \nL 1572.673436 77.540101 \nL 1572.70371 77.286901 \nL 1572.729963 77.033252 \nL 1572.752188 76.779218 \nL 1572.77038 76.524864 \nL 1572.784534 76.270253 \nL 1572.794646 76.01545 \nL 1572.800715 75.760518 \nL 1572.802738 75.505522 \nL 1572.802738 27.289859 \nL 1572.800715 27.034863 \nL 1572.794646 26.779932 \nL 1572.784534 26.525128 \nL 1572.77038 26.270517 \nL 1572.752188 26.016163 \nL 1572.729963 25.762129 \nL 1572.70371 25.50848 \nL 1572.673436 25.25528 \nL 1572.639149 25.002591 \nL 1572.600857 24.750479 \nL 1572.55857 24.499005 \nL 1572.512298 24.248235 \nL 1572.462053 23.99823 \nL 1572.407848 23.749053 \nL 1572.349696 23.500768 \nL 1572.287613 23.253437 \nL 1572.221613 23.007122 \nL 1572.151713 22.761885 \nL 1572.077932 22.517788 \nL 1572.000286 22.274893 \nL 1571.918797 22.03326 \nL 1571.833484 21.79295 \nL 1571.74437 21.554024 \nL 1571.651475 21.316542 \nL 1571.554825 21.080564 \nL 1571.454442 20.846149 \nL 1571.350353 20.613356 \nL 1571.242584 20.382244 \nL 1571.131161 20.152871 \nL 1571.016114 19.925294 \nL 1570.89747 19.699572 \nL 1570.775259 19.47576 \nL 1570.649513 19.253916 \nL 1570.520263 19.034094 \nL 1570.387542 18.816351 \nL 1570.251382 18.600741 \nL 1570.111819 18.387318 \nL 1569.968888 18.176137 \nL 1569.822623 17.96725 \nL 1569.673063 17.76071 \nL 1569.520245 17.556569 \nL 1569.364207 17.354878 \nL 1569.204989 17.155688 \nL 1569.04263 16.959049 \nL 1568.877172 16.765011 \nL 1568.708657 16.573623 \nL 1568.537126 16.384932 \nL 1568.362622 16.198987 \nL 1568.185191 16.015834 \nL 1568.004876 15.835519 \nL 1567.821723 15.658087 \nL 1567.635777 15.483584 \nL 1567.447087 15.312053 \nL 1567.255698 15.143537 \nL 1567.06166 14.978079 \nL 1566.865022 14.815721 \nL 1566.665832 14.656502 \nL 1566.464141 14.500465 \nL 1566.26 14.347646 \nL 1566.05346 14.198086 \nL 1565.844573 14.051822 \nL 1565.633391 13.90889 \nL 1565.419969 13.769327 \nL 1565.204359 13.633168 \nL 1564.986616 13.500446 \nL 1564.766794 13.371197 \nL 1564.54495 13.24545 \nL 1564.321138 13.12324 \nL 1564.095415 13.004596 \nL 1563.867839 12.889548 \nL 1563.638466 12.778126 \nL 1563.407354 12.670356 \nL 1563.174561 12.566267 \nL 1562.940146 12.465885 \nL 1562.704167 12.369234 \nL 1562.466685 12.27634 \nL 1562.22776 12.187225 \nL 1561.98745 12.101913 \nL 1561.745817 12.020423 \nL 1561.502921 11.942778 \nL 1561.258824 11.868996 \nL 1561.013587 11.799097 \nL 1560.767272 11.733097 \nL 1560.519941 11.671013 \nL 1560.271656 11.612862 \nL 1560.02248 11.558657 \nL 1559.772475 11.508412 \nL 1559.521704 11.46214 \nL 1559.270231 11.419853 \nL 1559.018118 11.381561 \nL 1558.76543 11.347273 \nL 1558.512229 11.316999 \nL 1558.25858 11.290747 \nL 1558.004547 11.268522 \nL 1557.750192 11.25033 \nL 1557.495582 11.236176 \nL 1557.240778 11.226063 \nL 1556.985846 11.219995 \nL 1556.73085 11.217972 \nL 1363.868201 11.217972 \nL 1363.613205 11.219995 \nL 1363.358273 11.226063 \nL 1363.10347 11.236176 \nL 1362.848859 11.25033 \nL 1362.594504 11.268522 \nL 1362.340471 11.290747 \nL 1362.086822 11.316999 \nL 1361.833621 11.347273 \nL 1361.580933 11.381561 \nL 1361.32882 11.419853 \nL 1361.077347 11.46214 \nL 1360.826576 11.508412 \nL 1360.576571 11.558657 \nL 1360.327395 11.612862 \nL 1360.07911 11.671013 \nL 1359.831779 11.733097 \nL 1359.585464 11.799097 \nL 1359.340227 11.868996 \nL 1359.09613 11.942778 \nL 1358.853234 12.020423 \nL 1358.611601 12.101913 \nL 1358.371291 12.187225 \nL 1358.132366 12.27634 \nL 1357.894884 12.369234 \nL 1357.658905 12.465885 \nL 1357.42449 12.566267 \nL 1357.191697 12.670356 \nL 1356.960585 12.778126 \nL 1356.731212 12.889548 \nL 1356.503636 13.004596 \nL 1356.277913 13.12324 \nL 1356.054101 13.24545 \nL 1355.832257 13.371197 \nL 1355.612435 13.500446 \nL 1355.394692 13.633168 \nL 1355.179082 13.769327 \nL 1354.96566 13.90889 \nL 1354.754478 14.051822 \nL 1354.545591 14.198086 \nL 1354.339051 14.347646 \nL 1354.13491 14.500465 \nL 1353.933219 14.656502 \nL 1353.734029 14.815721 \nL 1353.537391 14.978079 \nL 1353.343353 15.143537 \nL 1353.151964 15.312053 \nL 1352.963274 15.483584 \nL 1352.777328 15.658087 \nL 1352.594175 15.835519 \nL 1352.41386 16.015834 \nL 1352.236429 16.198987 \nL 1352.061925 16.384932 \nL 1351.890394 16.573623 \nL 1351.721879 16.765011 \nL 1351.556421 16.959049 \nL 1351.394062 17.155688 \nL 1351.234844 17.354878 \nL 1351.078806 17.556569 \nL 1350.925988 17.76071 \nL 1350.776428 17.96725 \nL 1350.630163 18.176137 \nL 1350.487232 18.387318 \nL 1350.347669 18.600741 \nL 1350.211509 18.816351 \nL 1350.078788 19.034094 \nL 1349.949538 19.253916 \nL 1349.823792 19.47576 \nL 1349.701581 19.699572 \nL 1349.582937 19.925294 \nL 1349.46789 20.152871 \nL 1349.356467 20.382244 \nL 1349.248698 20.613356 \nL 1349.144609 20.846149 \nL 1349.044226 21.080564 \nL 1348.947576 21.316542 \nL 1348.854681 21.554024 \nL 1348.765567 21.79295 \nL 1348.680254 22.03326 \nL 1348.598765 22.274893 \nL 1348.521119 22.517788 \nL 1348.447338 22.761885 \nL 1348.377438 23.007122 \nL 1348.311438 23.253437 \nL 1348.249355 23.500768 \nL 1348.191203 23.749053 \nL 1348.136998 23.99823 \nL 1348.086753 24.248235 \nL 1348.040481 24.499005 \nL 1347.998194 24.750479 \nL 1347.959902 25.002591 \nL 1347.925615 25.25528 \nL 1347.895341 25.50848 \nL 1347.869088 25.762129 \nL 1347.846863 26.016163 \nL 1347.828671 26.270517 \nL 1347.814517 26.525128 \nL 1347.804405 26.779932 \nL 1347.798336 27.034863 \nL 1347.796313 27.289859 \nL 1347.796313 75.505522 \nL 1347.798336 75.760518 \nL 1347.804405 76.01545 \nL 1347.814517 76.270253 \nL 1347.828671 76.524864 \nL 1347.846863 76.779218 \nL 1347.869088 77.033252 \nL 1347.895341 77.286901 \nL 1347.925615 77.540101 \nL 1347.959902 77.79279 \nL 1347.998194 78.044902 \nL 1348.040481 78.296376 \nL 1348.086753 78.547146 \nL 1348.136998 78.797151 \nL 1348.191203 79.046328 \nL 1348.249355 79.294613 \nL 1348.311438 79.541944 \nL 1348.377438 79.788259 \nL 1348.447338 80.033496 \nL 1348.521119 80.277593 \nL 1348.598765 80.520488 \nL 1348.680254 80.762121 \nL 1348.765567 81.002431 \nL 1348.854681 81.241357 \nL 1348.947576 81.478839 \nL 1349.044226 81.714817 \nL 1349.144609 81.949232 \nL 1349.248698 82.182025 \nL 1349.356467 82.413137 \nL 1349.46789 82.64251 \nL 1349.582937 82.870087 \nL 1349.701581 83.095809 \nL 1349.823792 83.319621 \nL 1349.949538 83.541465 \nL 1350.078788 83.761287 \nL 1350.211509 83.97903 \nL 1350.347669 84.19464 \nL 1350.487232 84.408063 \nL 1350.630163 84.619244 \nL 1350.776428 84.828131 \nL 1350.925988 85.034671 \nL 1351.078806 85.238812 \nL 1351.234844 85.440503 \nL 1351.394062 85.639693 \nL 1351.556421 85.836332 \nL 1351.721879 86.03037 \nL 1351.890394 86.221758 \nL 1352.061925 86.410449 \nL 1352.236429 86.596394 \nL 1352.41386 86.779547 \nL 1352.594175 86.959862 \nL 1352.777328 87.137294 \nL 1352.963274 87.311797 \nL 1353.151964 87.483328 \nL 1353.343353 87.651844 \nL 1353.537391 87.817302 \nL 1353.734029 87.97966 \nL 1353.933219 88.138879 \nL 1354.13491 88.294916 \nL 1354.339051 88.447735 \nL 1354.545591 88.597295 \nL 1354.754478 88.743559 \nL 1354.96566 88.886491 \nL 1355.179082 89.026054 \nL 1355.394692 89.162213 \nL 1355.612435 89.294935 \nL 1355.832257 89.424185 \nL 1356.054101 89.549931 \nL 1356.277913 89.672141 \nL 1356.503636 89.790785 \nL 1356.731212 89.905833 \nL 1356.960585 90.017255 \nL 1357.191697 90.125025 \nL 1357.42449 90.229114 \nL 1357.658905 90.329496 \nL 1357.894884 90.426147 \nL 1358.132366 90.519041 \nL 1358.371291 90.608156 \nL 1358.611601 90.693469 \nL 1358.853234 90.774958 \nL 1359.09613 90.852603 \nL 1359.340227 90.926385 \nL 1359.585464 90.996284 \nL 1359.831779 91.062284 \nL 1360.07911 91.124368 \nL 1360.327395 91.182519 \nL 1360.576571 91.236724 \nL 1360.826576 91.286969 \nL 1361.077347 91.333241 \nL 1361.32882 91.375528 \nL 1361.580933 91.413821 \nL 1361.833621 91.448108 \nL 1362.086822 91.478382 \nL 1362.340471 91.504634 \nL 1362.594504 91.52686 \nL 1362.848859 91.545051 \nL 1363.10347 91.559205 \nL 1363.358273 91.569318 \nL 1363.613205 91.575386 \nL 1363.868201 91.577409 \nL 1556.73085 91.577409 \nz\n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_7\">\n    <path d=\"M 1621.0184 51.397691 \nL 1625.036372 11.217972 \nL 1833.970909 11.217972 \nL 1825.934965 91.577409 \nL 1617.000428 91.577409 \nL 1621.0184 51.397691 \nz\n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"line2d_1\">\n    <path d=\"M 94.189091 51.397691 \nL 94.189091 11.217972 \nL 254.907966 11.217972 \nL 254.907966 91.577409 \nL 94.189091 91.577409 \nL 94.189091 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"line2d_2\">\n    <path d=\"M 238.836078 11.217972 \nL 238.836078 91.577409 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"line2d_3\">\n    <path d=\"M 110.260978 11.217972 \nL 110.260978 91.577409 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"line2d_4\">\n    <path d=\"M 254.907966 51.397691 \nL 279.015797 51.397691 \nL 299.105656 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_8\">\n    <path d=\"M 299.105656 50.192299 \nL 303.123628 51.397691 \nL 299.105656 52.603082 \nz\n\" clip-path=\"url(#p89d55c044f)\"/>\n   </g>\n   <g id=\"line2d_5\">\n    <path d=\"M 512.058165 51.397691 \nL 536.165996 51.397691 \nL 556.255856 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_9\">\n    <path d=\"M 556.255856 50.192299 \nL 560.273827 51.397691 \nL 556.255856 52.603082 \nz\n\" clip-path=\"url(#p89d55c044f)\"/>\n   </g>\n   <g id=\"line2d_6\">\n    <path d=\"M 769.208364 51.397691 \nL 793.316196 51.397691 \nL 813.406055 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_10\">\n    <path d=\"M 813.406055 50.192299 \nL 817.424027 51.397691 \nL 813.406055 52.603082 \nz\n\" clip-path=\"url(#p89d55c044f)\"/>\n   </g>\n   <g id=\"line2d_7\">\n    <path d=\"M 1026.358564 51.397691 \nL 1050.466395 51.397691 \nL 1070.556254 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_11\">\n    <path d=\"M 1070.556254 50.192299 \nL 1074.574226 51.397691 \nL 1070.556254 52.603082 \nz\n\" clip-path=\"url(#p89d55c044f)\"/>\n   </g>\n   <g id=\"line2d_8\">\n    <path d=\"M 1299.580651 51.397691 \nL 1323.688482 51.397691 \nL 1343.778341 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_12\">\n    <path d=\"M 1343.778341 50.192299 \nL 1347.796313 51.397691 \nL 1343.778341 52.603082 \nz\n\" clip-path=\"url(#p89d55c044f)\"/>\n   </g>\n   <g id=\"line2d_9\">\n    <path d=\"M 1572.802738 51.397691 \nL 1596.910569 51.397691 \nL 1617.000428 51.397691 \n\" clip-path=\"url(#p89d55c044f)\" style=\"fill: none; stroke: #000000; stroke-width: 2; stroke-linecap: round\"/>\n   </g>\n   <g id=\"patch_13\">\n    <path d=\"M 1617.000428 50.192299 \nL 1621.0184 51.397691 \nL 1617.000428 52.603082 \nz\n\" clip-path=\"url(#p89d55c044f)\"/>\n   </g>\n   <g id=\"text_1\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- Raw data -->\n     <g transform=\"translate(145.34052 54.846909) scale(0.125 -0.125)\">\n      <defs>\n       <path id=\"DejaVuSans-52\" d=\"M 2841 2188 \nQ 3044 2119 3236 1894 \nQ 3428 1669 3622 1275 \nL 4263 0 \nL 3584 0 \nL 2988 1197 \nQ 2756 1666 2539 1819 \nQ 2322 1972 1947 1972 \nL 1259 1972 \nL 1259 0 \nL 628 0 \nL 628 4666 \nL 2053 4666 \nQ 2853 4666 3247 4331 \nQ 3641 3997 3641 3322 \nQ 3641 2881 3436 2590 \nQ 3231 2300 2841 2188 \nz\nM 1259 4147 \nL 1259 2491 \nL 2053 2491 \nQ 2509 2491 2742 2702 \nQ 2975 2913 2975 3322 \nQ 2975 3731 2742 3939 \nQ 2509 4147 2053 4147 \nL 1259 4147 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-61\" d=\"M 2194 1759 \nQ 1497 1759 1228 1600 \nQ 959 1441 959 1056 \nQ 959 750 1161 570 \nQ 1363 391 1709 391 \nQ 2188 391 2477 730 \nQ 2766 1069 2766 1631 \nL 2766 1759 \nL 2194 1759 \nz\nM 3341 1997 \nL 3341 0 \nL 2766 0 \nL 2766 531 \nQ 2569 213 2275 61 \nQ 1981 -91 1556 -91 \nQ 1019 -91 701 211 \nQ 384 513 384 1019 \nQ 384 1609 779 1909 \nQ 1175 2209 1959 2209 \nL 2766 2209 \nL 2766 2266 \nQ 2766 2663 2505 2880 \nQ 2244 3097 1772 3097 \nQ 1472 3097 1187 3025 \nQ 903 2953 641 2809 \nL 641 3341 \nQ 956 3463 1253 3523 \nQ 1550 3584 1831 3584 \nQ 2591 3584 2966 3190 \nQ 3341 2797 3341 1997 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-77\" d=\"M 269 3500 \nL 844 3500 \nL 1563 769 \nL 2278 3500 \nL 2956 3500 \nL 3675 769 \nL 4391 3500 \nL 4966 3500 \nL 4050 0 \nL 3372 0 \nL 2619 2869 \nL 1863 0 \nL 1184 0 \nL 269 3500 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-20\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-64\" d=\"M 2906 2969 \nL 2906 4863 \nL 3481 4863 \nL 3481 0 \nL 2906 0 \nL 2906 525 \nQ 2725 213 2448 61 \nQ 2172 -91 1784 -91 \nQ 1150 -91 751 415 \nQ 353 922 353 1747 \nQ 353 2572 751 3078 \nQ 1150 3584 1784 3584 \nQ 2172 3584 2448 3432 \nQ 2725 3281 2906 2969 \nz\nM 947 1747 \nQ 947 1113 1208 752 \nQ 1469 391 1925 391 \nQ 2381 391 2643 752 \nQ 2906 1113 2906 1747 \nQ 2906 2381 2643 2742 \nQ 2381 3103 1925 3103 \nQ 1469 3103 1208 2742 \nQ 947 2381 947 1747 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-74\" d=\"M 1172 4494 \nL 1172 3500 \nL 2356 3500 \nL 2356 3053 \nL 1172 3053 \nL 1172 1153 \nQ 1172 725 1289 603 \nQ 1406 481 1766 481 \nL 2356 481 \nL 2356 0 \nL 1766 0 \nQ 1100 0 847 248 \nQ 594 497 594 1153 \nL 594 3053 \nL 172 3053 \nL 172 3500 \nL 594 3500 \nL 594 4494 \nL 1172 4494 \nz\n\" transform=\"scale(0.015625)\"/>\n      </defs>\n      <use xlink:href=\"#DejaVuSans-52\"/>\n      <use xlink:href=\"#DejaVuSans-61\" x=\"67.232422\"/>\n      <use xlink:href=\"#DejaVuSans-77\" x=\"128.511719\"/>\n      <use xlink:href=\"#DejaVuSans-20\" x=\"210.298828\"/>\n      <use xlink:href=\"#DejaVuSans-64\" x=\"242.085938\"/>\n      <use xlink:href=\"#DejaVuSans-61\" x=\"305.5625\"/>\n      <use xlink:href=\"#DejaVuSans-74\" x=\"366.841797\"/>\n      <use xlink:href=\"#DejaVuSans-61\" x=\"406.050781\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"text_2\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- SimpleImputer -->\n     <g transform=\"translate(361.523514 54.846909) scale(0.125 -0.125)\">\n      <defs>\n       <path id=\"DejaVuSans-53\" d=\"M 3425 4513 \nL 3425 3897 \nQ 3066 4069 2747 4153 \nQ 2428 4238 2131 4238 \nQ 1616 4238 1336 4038 \nQ 1056 3838 1056 3469 \nQ 1056 3159 1242 3001 \nQ 1428 2844 1947 2747 \nL 2328 2669 \nQ 3034 2534 3370 2195 \nQ 3706 1856 3706 1288 \nQ 3706 609 3251 259 \nQ 2797 -91 1919 -91 \nQ 1588 -91 1214 -16 \nQ 841 59 441 206 \nL 441 856 \nQ 825 641 1194 531 \nQ 1563 422 1919 422 \nQ 2459 422 2753 634 \nQ 3047 847 3047 1241 \nQ 3047 1584 2836 1778 \nQ 2625 1972 2144 2069 \nL 1759 2144 \nQ 1053 2284 737 2584 \nQ 422 2884 422 3419 \nQ 422 4038 858 4394 \nQ 1294 4750 2059 4750 \nQ 2388 4750 2728 4690 \nQ 3069 4631 3425 4513 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-69\" d=\"M 603 3500 \nL 1178 3500 \nL 1178 0 \nL 603 0 \nL 603 3500 \nz\nM 603 4863 \nL 1178 4863 \nL 1178 4134 \nL 603 4134 \nL 603 4863 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-6d\" d=\"M 3328 2828 \nQ 3544 3216 3844 3400 \nQ 4144 3584 4550 3584 \nQ 5097 3584 5394 3201 \nQ 5691 2819 5691 2113 \nL 5691 0 \nL 5113 0 \nL 5113 2094 \nQ 5113 2597 4934 2840 \nQ 4756 3084 4391 3084 \nQ 3944 3084 3684 2787 \nQ 3425 2491 3425 1978 \nL 3425 0 \nL 2847 0 \nL 2847 2094 \nQ 2847 2600 2669 2842 \nQ 2491 3084 2119 3084 \nQ 1678 3084 1418 2786 \nQ 1159 2488 1159 1978 \nL 1159 0 \nL 581 0 \nL 581 3500 \nL 1159 3500 \nL 1159 2956 \nQ 1356 3278 1631 3431 \nQ 1906 3584 2284 3584 \nQ 2666 3584 2933 3390 \nQ 3200 3197 3328 2828 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-70\" d=\"M 1159 525 \nL 1159 -1331 \nL 581 -1331 \nL 581 3500 \nL 1159 3500 \nL 1159 2969 \nQ 1341 3281 1617 3432 \nQ 1894 3584 2278 3584 \nQ 2916 3584 3314 3078 \nQ 3713 2572 3713 1747 \nQ 3713 922 3314 415 \nQ 2916 -91 2278 -91 \nQ 1894 -91 1617 61 \nQ 1341 213 1159 525 \nz\nM 3116 1747 \nQ 3116 2381 2855 2742 \nQ 2594 3103 2138 3103 \nQ 1681 3103 1420 2742 \nQ 1159 2381 1159 1747 \nQ 1159 1113 1420 752 \nQ 1681 391 2138 391 \nQ 2594 391 2855 752 \nQ 3116 1113 3116 1747 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-6c\" d=\"M 603 4863 \nL 1178 4863 \nL 1178 0 \nL 603 0 \nL 603 4863 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-65\" d=\"M 3597 1894 \nL 3597 1613 \nL 953 1613 \nQ 991 1019 1311 708 \nQ 1631 397 2203 397 \nQ 2534 397 2845 478 \nQ 3156 559 3463 722 \nL 3463 178 \nQ 3153 47 2828 -22 \nQ 2503 -91 2169 -91 \nQ 1331 -91 842 396 \nQ 353 884 353 1716 \nQ 353 2575 817 3079 \nQ 1281 3584 2069 3584 \nQ 2775 3584 3186 3129 \nQ 3597 2675 3597 1894 \nz\nM 3022 2063 \nQ 3016 2534 2758 2815 \nQ 2500 3097 2075 3097 \nQ 1594 3097 1305 2825 \nQ 1016 2553 972 2059 \nL 3022 2063 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-49\" d=\"M 628 4666 \nL 1259 4666 \nL 1259 0 \nL 628 0 \nL 628 4666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-75\" d=\"M 544 1381 \nL 544 3500 \nL 1119 3500 \nL 1119 1403 \nQ 1119 906 1312 657 \nQ 1506 409 1894 409 \nQ 2359 409 2629 706 \nQ 2900 1003 2900 1516 \nL 2900 3500 \nL 3475 3500 \nL 3475 0 \nL 2900 0 \nL 2900 538 \nQ 2691 219 2414 64 \nQ 2138 -91 1772 -91 \nQ 1169 -91 856 284 \nQ 544 659 544 1381 \nz\nM 1991 3584 \nL 1991 3584 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-72\" d=\"M 2631 2963 \nQ 2534 3019 2420 3045 \nQ 2306 3072 2169 3072 \nQ 1681 3072 1420 2755 \nQ 1159 2438 1159 1844 \nL 1159 0 \nL 581 0 \nL 581 3500 \nL 1159 3500 \nL 1159 2956 \nQ 1341 3275 1631 3429 \nQ 1922 3584 2338 3584 \nQ 2397 3584 2469 3576 \nQ 2541 3569 2628 3553 \nL 2631 2963 \nz\n\" transform=\"scale(0.015625)\"/>\n      </defs>\n      <use xlink:href=\"#DejaVuSans-53\"/>\n      <use xlink:href=\"#DejaVuSans-69\" x=\"63.476562\"/>\n      <use xlink:href=\"#DejaVuSans-6d\" x=\"91.259766\"/>\n      <use xlink:href=\"#DejaVuSans-70\" x=\"188.671875\"/>\n      <use xlink:href=\"#DejaVuSans-6c\" x=\"252.148438\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"279.931641\"/>\n      <use xlink:href=\"#DejaVuSans-49\" x=\"341.455078\"/>\n      <use xlink:href=\"#DejaVuSans-6d\" x=\"370.947266\"/>\n      <use xlink:href=\"#DejaVuSans-70\" x=\"468.359375\"/>\n      <use xlink:href=\"#DejaVuSans-75\" x=\"531.835938\"/>\n      <use xlink:href=\"#DejaVuSans-74\" x=\"595.214844\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"634.423828\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"695.947266\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"text_3\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- SimpleImputer -->\n     <g transform=\"translate(618.673713 54.846909) scale(0.125 -0.125)\">\n      <use xlink:href=\"#DejaVuSans-53\"/>\n      <use xlink:href=\"#DejaVuSans-69\" x=\"63.476562\"/>\n      <use xlink:href=\"#DejaVuSans-6d\" x=\"91.259766\"/>\n      <use xlink:href=\"#DejaVuSans-70\" x=\"188.671875\"/>\n      <use xlink:href=\"#DejaVuSans-6c\" x=\"252.148438\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"279.931641\"/>\n      <use xlink:href=\"#DejaVuSans-49\" x=\"341.455078\"/>\n      <use xlink:href=\"#DejaVuSans-6d\" x=\"370.947266\"/>\n      <use xlink:href=\"#DejaVuSans-70\" x=\"468.359375\"/>\n      <use xlink:href=\"#DejaVuSans-75\" x=\"531.835938\"/>\n      <use xlink:href=\"#DejaVuSans-74\" x=\"595.214844\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"634.423828\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"695.947266\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"text_4\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- OneHotEncoder -->\n     <g transform=\"translate(872.636413 54.846909) scale(0.125 -0.125)\">\n      <defs>\n       <path id=\"DejaVuSans-4f\" d=\"M 2522 4238 \nQ 1834 4238 1429 3725 \nQ 1025 3213 1025 2328 \nQ 1025 1447 1429 934 \nQ 1834 422 2522 422 \nQ 3209 422 3611 934 \nQ 4013 1447 4013 2328 \nQ 4013 3213 3611 3725 \nQ 3209 4238 2522 4238 \nz\nM 2522 4750 \nQ 3503 4750 4090 4092 \nQ 4678 3434 4678 2328 \nQ 4678 1225 4090 567 \nQ 3503 -91 2522 -91 \nQ 1538 -91 948 565 \nQ 359 1222 359 2328 \nQ 359 3434 948 4092 \nQ 1538 4750 2522 4750 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-6e\" d=\"M 3513 2113 \nL 3513 0 \nL 2938 0 \nL 2938 2094 \nQ 2938 2591 2744 2837 \nQ 2550 3084 2163 3084 \nQ 1697 3084 1428 2787 \nQ 1159 2491 1159 1978 \nL 1159 0 \nL 581 0 \nL 581 3500 \nL 1159 3500 \nL 1159 2956 \nQ 1366 3272 1645 3428 \nQ 1925 3584 2291 3584 \nQ 2894 3584 3203 3211 \nQ 3513 2838 3513 2113 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-48\" d=\"M 628 4666 \nL 1259 4666 \nL 1259 2753 \nL 3553 2753 \nL 3553 4666 \nL 4184 4666 \nL 4184 0 \nL 3553 0 \nL 3553 2222 \nL 1259 2222 \nL 1259 0 \nL 628 0 \nL 628 4666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-6f\" d=\"M 1959 3097 \nQ 1497 3097 1228 2736 \nQ 959 2375 959 1747 \nQ 959 1119 1226 758 \nQ 1494 397 1959 397 \nQ 2419 397 2687 759 \nQ 2956 1122 2956 1747 \nQ 2956 2369 2687 2733 \nQ 2419 3097 1959 3097 \nz\nM 1959 3584 \nQ 2709 3584 3137 3096 \nQ 3566 2609 3566 1747 \nQ 3566 888 3137 398 \nQ 2709 -91 1959 -91 \nQ 1206 -91 779 398 \nQ 353 888 353 1747 \nQ 353 2609 779 3096 \nQ 1206 3584 1959 3584 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-45\" d=\"M 628 4666 \nL 3578 4666 \nL 3578 4134 \nL 1259 4134 \nL 1259 2753 \nL 3481 2753 \nL 3481 2222 \nL 1259 2222 \nL 1259 531 \nL 3634 531 \nL 3634 0 \nL 628 0 \nL 628 4666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-63\" d=\"M 3122 3366 \nL 3122 2828 \nQ 2878 2963 2633 3030 \nQ 2388 3097 2138 3097 \nQ 1578 3097 1268 2742 \nQ 959 2388 959 1747 \nQ 959 1106 1268 751 \nQ 1578 397 2138 397 \nQ 2388 397 2633 464 \nQ 2878 531 3122 666 \nL 3122 134 \nQ 2881 22 2623 -34 \nQ 2366 -91 2075 -91 \nQ 1284 -91 818 406 \nQ 353 903 353 1747 \nQ 353 2603 823 3093 \nQ 1294 3584 2113 3584 \nQ 2378 3584 2631 3529 \nQ 2884 3475 3122 3366 \nz\n\" transform=\"scale(0.015625)\"/>\n      </defs>\n      <use xlink:href=\"#DejaVuSans-4f\"/>\n      <use xlink:href=\"#DejaVuSans-6e\" x=\"78.710938\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"142.089844\"/>\n      <use xlink:href=\"#DejaVuSans-48\" x=\"203.613281\"/>\n      <use xlink:href=\"#DejaVuSans-6f\" x=\"278.808594\"/>\n      <use xlink:href=\"#DejaVuSans-74\" x=\"339.990234\"/>\n      <use xlink:href=\"#DejaVuSans-45\" x=\"379.199219\"/>\n      <use xlink:href=\"#DejaVuSans-6e\" x=\"442.382812\"/>\n      <use xlink:href=\"#DejaVuSans-63\" x=\"505.761719\"/>\n      <use xlink:href=\"#DejaVuSans-6f\" x=\"560.742188\"/>\n      <use xlink:href=\"#DejaVuSans-64\" x=\"621.923828\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"685.400391\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"746.923828\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"text_5\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- RemoveOutliers -->\n     <g transform=\"translate(1137.238571 54.846909) scale(0.125 -0.125)\">\n      <defs>\n       <path id=\"DejaVuSans-76\" d=\"M 191 3500 \nL 800 3500 \nL 1894 563 \nL 2988 3500 \nL 3597 3500 \nL 2284 0 \nL 1503 0 \nL 191 3500 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-73\" d=\"M 2834 3397 \nL 2834 2853 \nQ 2591 2978 2328 3040 \nQ 2066 3103 1784 3103 \nQ 1356 3103 1142 2972 \nQ 928 2841 928 2578 \nQ 928 2378 1081 2264 \nQ 1234 2150 1697 2047 \nL 1894 2003 \nQ 2506 1872 2764 1633 \nQ 3022 1394 3022 966 \nQ 3022 478 2636 193 \nQ 2250 -91 1575 -91 \nQ 1294 -91 989 -36 \nQ 684 19 347 128 \nL 347 722 \nQ 666 556 975 473 \nQ 1284 391 1588 391 \nQ 1994 391 2212 530 \nQ 2431 669 2431 922 \nQ 2431 1156 2273 1281 \nQ 2116 1406 1581 1522 \nL 1381 1569 \nQ 847 1681 609 1914 \nQ 372 2147 372 2553 \nQ 372 3047 722 3315 \nQ 1072 3584 1716 3584 \nQ 2034 3584 2315 3537 \nQ 2597 3491 2834 3397 \nz\n\" transform=\"scale(0.015625)\"/>\n      </defs>\n      <use xlink:href=\"#DejaVuSans-52\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"64.982422\"/>\n      <use xlink:href=\"#DejaVuSans-6d\" x=\"126.505859\"/>\n      <use xlink:href=\"#DejaVuSans-6f\" x=\"223.917969\"/>\n      <use xlink:href=\"#DejaVuSans-76\" x=\"285.099609\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"344.279297\"/>\n      <use xlink:href=\"#DejaVuSans-4f\" x=\"405.802734\"/>\n      <use xlink:href=\"#DejaVuSans-75\" x=\"484.513672\"/>\n      <use xlink:href=\"#DejaVuSans-74\" x=\"547.892578\"/>\n      <use xlink:href=\"#DejaVuSans-6c\" x=\"587.101562\"/>\n      <use xlink:href=\"#DejaVuSans-69\" x=\"614.884766\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"642.667969\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"704.191406\"/>\n      <use xlink:href=\"#DejaVuSans-73\" x=\"745.304688\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"text_6\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- StandardScaler -->\n     <g transform=\"translate(1412.479213 54.846909) scale(0.125 -0.125)\">\n      <use xlink:href=\"#DejaVuSans-53\"/>\n      <use xlink:href=\"#DejaVuSans-74\" x=\"63.476562\"/>\n      <use xlink:href=\"#DejaVuSans-61\" x=\"102.685547\"/>\n      <use xlink:href=\"#DejaVuSans-6e\" x=\"163.964844\"/>\n      <use xlink:href=\"#DejaVuSans-64\" x=\"227.34375\"/>\n      <use xlink:href=\"#DejaVuSans-61\" x=\"290.820312\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"352.099609\"/>\n      <use xlink:href=\"#DejaVuSans-64\" x=\"391.462891\"/>\n      <use xlink:href=\"#DejaVuSans-53\" x=\"454.939453\"/>\n      <use xlink:href=\"#DejaVuSans-63\" x=\"518.416016\"/>\n      <use xlink:href=\"#DejaVuSans-61\" x=\"573.396484\"/>\n      <use xlink:href=\"#DejaVuSans-6c\" x=\"634.675781\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"662.458984\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"723.982422\"/>\n     </g>\n    </g>\n   </g>\n   <g id=\"text_7\">\n    <g clip-path=\"url(#p89d55c044f)\">\n     <!-- LGBMRegressor -->\n     <g transform=\"translate(1676.425122 54.846909) scale(0.125 -0.125)\">\n      <defs>\n       <path id=\"DejaVuSans-4c\" d=\"M 628 4666 \nL 1259 4666 \nL 1259 531 \nL 3531 531 \nL 3531 0 \nL 628 0 \nL 628 4666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-47\" d=\"M 3809 666 \nL 3809 1919 \nL 2778 1919 \nL 2778 2438 \nL 4434 2438 \nL 4434 434 \nQ 4069 175 3628 42 \nQ 3188 -91 2688 -91 \nQ 1594 -91 976 548 \nQ 359 1188 359 2328 \nQ 359 3472 976 4111 \nQ 1594 4750 2688 4750 \nQ 3144 4750 3555 4637 \nQ 3966 4525 4313 4306 \nL 4313 3634 \nQ 3963 3931 3569 4081 \nQ 3175 4231 2741 4231 \nQ 1884 4231 1454 3753 \nQ 1025 3275 1025 2328 \nQ 1025 1384 1454 906 \nQ 1884 428 2741 428 \nQ 3075 428 3337 486 \nQ 3600 544 3809 666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-42\" d=\"M 1259 2228 \nL 1259 519 \nL 2272 519 \nQ 2781 519 3026 730 \nQ 3272 941 3272 1375 \nQ 3272 1813 3026 2020 \nQ 2781 2228 2272 2228 \nL 1259 2228 \nz\nM 1259 4147 \nL 1259 2741 \nL 2194 2741 \nQ 2656 2741 2882 2914 \nQ 3109 3088 3109 3444 \nQ 3109 3797 2882 3972 \nQ 2656 4147 2194 4147 \nL 1259 4147 \nz\nM 628 4666 \nL 2241 4666 \nQ 2963 4666 3353 4366 \nQ 3744 4066 3744 3513 \nQ 3744 3084 3544 2831 \nQ 3344 2578 2956 2516 \nQ 3422 2416 3680 2098 \nQ 3938 1781 3938 1306 \nQ 3938 681 3513 340 \nQ 3088 0 2303 0 \nL 628 0 \nL 628 4666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-4d\" d=\"M 628 4666 \nL 1569 4666 \nL 2759 1491 \nL 3956 4666 \nL 4897 4666 \nL 4897 0 \nL 4281 0 \nL 4281 4097 \nL 3078 897 \nL 2444 897 \nL 1241 4097 \nL 1241 0 \nL 628 0 \nL 628 4666 \nz\n\" transform=\"scale(0.015625)\"/>\n       <path id=\"DejaVuSans-67\" d=\"M 2906 1791 \nQ 2906 2416 2648 2759 \nQ 2391 3103 1925 3103 \nQ 1463 3103 1205 2759 \nQ 947 2416 947 1791 \nQ 947 1169 1205 825 \nQ 1463 481 1925 481 \nQ 2391 481 2648 825 \nQ 2906 1169 2906 1791 \nz\nM 3481 434 \nQ 3481 -459 3084 -895 \nQ 2688 -1331 1869 -1331 \nQ 1566 -1331 1297 -1286 \nQ 1028 -1241 775 -1147 \nL 775 -588 \nQ 1028 -725 1275 -790 \nQ 1522 -856 1778 -856 \nQ 2344 -856 2625 -561 \nQ 2906 -266 2906 331 \nL 2906 616 \nQ 2728 306 2450 153 \nQ 2172 0 1784 0 \nQ 1141 0 747 490 \nQ 353 981 353 1791 \nQ 353 2603 747 3093 \nQ 1141 3584 1784 3584 \nQ 2172 3584 2450 3431 \nQ 2728 3278 2906 2969 \nL 2906 3500 \nL 3481 3500 \nL 3481 434 \nz\n\" transform=\"scale(0.015625)\"/>\n      </defs>\n      <use xlink:href=\"#DejaVuSans-4c\"/>\n      <use xlink:href=\"#DejaVuSans-47\" x=\"55.712891\"/>\n      <use xlink:href=\"#DejaVuSans-42\" x=\"133.203125\"/>\n      <use xlink:href=\"#DejaVuSans-4d\" x=\"201.806641\"/>\n      <use xlink:href=\"#DejaVuSans-52\" x=\"288.085938\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"353.068359\"/>\n      <use xlink:href=\"#DejaVuSans-67\" x=\"414.591797\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"478.068359\"/>\n      <use xlink:href=\"#DejaVuSans-65\" x=\"516.931641\"/>\n      <use xlink:href=\"#DejaVuSans-73\" x=\"578.455078\"/>\n      <use xlink:href=\"#DejaVuSans-73\" x=\"630.554688\"/>\n      <use xlink:href=\"#DejaVuSans-6f\" x=\"682.654297\"/>\n      <use xlink:href=\"#DejaVuSans-72\" x=\"743.835938\"/>\n     </g>\n    </g>\n   </g>\n  </g>\n </g>\n <defs>\n  <clipPath id=\"p89d55c044f\">\n   <rect x=\"7.2\" y=\"7.2\" width=\"1913.76\" height=\"88.395381\"/>\n  </clipPath>\n </defs>\n</svg>\n","text/plain":"<Figure size 2700x600 with 1 Axes>"},"metadata":{},"output_type":"display_data"}]}},"ff90e4141a9f44f298bc6f290062b1dc":{"model_module":"@jupyter-widgets/base","model_module_version":"1.2.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}}}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02_Dataset.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Framing the problem and constructing the dataset</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>